{"title":"Python爬虫基础","uid":"a7f9556995dc0359ec899cd406ee1ae6","slug":"Python爬虫基础","date":"2024-01-28T05:33:12.000Z","updated":"2024-05-16T07:51:01.720Z","comments":true,"path":"api/articles/Python爬虫基础.json","keywords":null,"cover":[],"content":"<h2 id=\"Python爬虫基础\"><a href=\"#Python爬虫基础\" class=\"headerlink\" title=\"Python爬虫基础\"></a>Python爬虫基础</h2><h3 id=\"爬虫概念\"><a href=\"#爬虫概念\" class=\"headerlink\" title=\"爬虫概念\"></a>爬虫概念</h3><h4 id=\"定义\"><a href=\"#定义\" class=\"headerlink\" title=\"定义\"></a>定义</h4><ul>\n<li>网络爬虫是<strong>伪装</strong>成客户端与服务端进行<strong>数据交互</strong>的程序。</li>\n</ul>\n<h4 id=\"应用\"><a href=\"#应用\" class=\"headerlink\" title=\"应用\"></a>应用</h4><ul>\n<li>数据采集, 搜索引擎, 模拟操作, 软件测试, 网络安全(信息轰炸, web漏洞扫描)</li>\n</ul>\n<h4 id=\"一般流程\"><a href=\"#一般流程\" class=\"headerlink\" title=\"一般流程\"></a>一般流程</h4><ul>\n<li><img src=\"https://img-blog.csdnimg.cn/20210709001610901.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0OTA3OTI2,size_16,color_FFFFFF,t_70\" alt=\"一般爬虫开发流程\"></li>\n</ul>\n<hr>\n<h3 id=\"会话技术\"><a href=\"#会话技术\" class=\"headerlink\" title=\"会话技术:\"></a>会话技术:</h3><h4 id=\"Cookie-s\"><a href=\"#Cookie-s\" class=\"headerlink\" title=\"Cookie(s)\"></a>Cookie(s)</h4><ul>\n<li><p>介绍: 指某些网站为了辨别用户身份、进行 session 跟踪而储存在<strong>用户本地</strong>终端上的数据, 实际由服务器发送给客户端, <strong>可以理解为一个凭证</strong>, 服务器可以以此辨别用户身份</p>\n</li>\n<li><p>爬虫中使用cookie</p>\n<ul>\n<li>好处: 能够访问登录界面</li>\n<li>坏处: 容易被反爬</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"Session\"><a href=\"#Session\" class=\"headerlink\" title=\"Session\"></a>Session</h4><ul>\n<li>含义: 在爬虫中, 指<strong>一个浏览器窗口从打开到关闭的这个期间</strong></li>\n<li>目的: 在一个客户打开浏览器到关闭的这个期间, 发起的所有请求都可以被识别为<strong>同一个用户</strong></li>\n<li>实现: 客户访问网站时, 生成一个包含SessionID的cookie, 用于服务器识别</li>\n<li><strong>Session是储存在服务器上的数据</strong></li>\n</ul>\n<hr>\n<h3 id=\"爬虫基础\"><a href=\"#爬虫基础\" class=\"headerlink\" title=\"爬虫基础\"></a>爬虫基础</h3><h4 id=\"urllib库request模块\"><a href=\"#urllib库request模块\" class=\"headerlink\" title=\"urllib库request模块\"></a>urllib库request模块</h4><h5 id=\"简单示例\"><a href=\"#简单示例\" class=\"headerlink\" title=\"简单示例\"></a>简单示例</h5><ul>\n<li><p>导入urllib请求模块:</p>\n<div class=\"language-python\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">python</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">import</span><span style=\"color: #BABED8\"> urllib</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #F07178\">request</span></span></code></pre></div></li>\n<li><p>发送GET请求:</p>\n<div class=\"language-python\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">python</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #BABED8\">r </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> urllib</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #F07178\">request</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">urlopen</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">http://www.baidu.com</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">)</span></span></code></pre></div></li>\n<li><p>查看返回信息:</p>\n<div class=\"language-python\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">python</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #82AAFF\">print</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">r</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">read</span><span style=\"color: #89DDFF\">().</span><span style=\"color: #82AAFF\">decode</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">utf-8</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">))</span></span></code></pre></div><p>返回了网页源码</p>\n</li>\n</ul>\n<h5 id=\"urlopen方法\"><a href=\"#urlopen方法\" class=\"headerlink\" title=\"urlopen方法\"></a>urlopen方法</h5><ul>\n<li><p>urlopen方法有三个参数</p>\n<div class=\"language-python\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">python</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #BABED8\">urllib</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #F07178\">request</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">urlopen</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">url</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\"> </span><span style=\"color: #BABED8; font-style: italic\">data</span><span style=\"color: #89DDFF\">=None,</span><span style=\"color: #82AAFF\"> </span><span style=\"color: #89DDFF\">[</span><span style=\"color: #82AAFF\">timeout</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\"> </span><span style=\"color: #89DDFF\">]*)</span></span></code></pre></div></li>\n<li><p><strong>data</strong>: 给post请求携带参数, 比如在模拟登录时传入用户名和密码</p>\n</li>\n<li><p>timeout: 设置请求超时时间</p>\n</li>\n<li><p>urlopen 默认是 <strong>Get</strong> 请求, 当我们传入参数它就为 <strong>Post</strong> 请求了</p>\n</li>\n</ul>\n<h5 id=\"Request方法\"><a href=\"#Request方法\" class=\"headerlink\" title=\"Request方法\"></a>Request方法</h5><ul>\n<li><p>Request方法有四个参数:</p>\n<div class=\"language-python\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">python</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #BABED8\">urllib</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #F07178\">request</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">Request</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">url</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\"> </span><span style=\"color: #BABED8; font-style: italic\">data</span><span style=\"color: #89DDFF\">=None,</span><span style=\"color: #82AAFF\"> </span><span style=\"color: #BABED8; font-style: italic\">headers</span><span style=\"color: #89DDFF\">=&#123;&#125;,</span><span style=\"color: #82AAFF\"> </span><span style=\"color: #BABED8; font-style: italic\">method</span><span style=\"color: #89DDFF\">=None)</span></span></code></pre></div></li>\n<li><p>headers: 请求头信息</p>\n</li>\n<li><p>method: 设置请求方式</p>\n</li>\n</ul>\n<h4 id=\"requests库发送请求\"><a href=\"#requests库发送请求\" class=\"headerlink\" title=\"requests库发送请求\"></a>requests库发送请求</h4><ul>\n<li><p>GET请求示例:</p>\n<div class=\"language-python\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">python</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">import</span><span style=\"color: #BABED8\"> requests</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">r </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> requests</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">get</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">https://www.bilibili.com/</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #82AAFF\">print</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">r</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #82AAFF\">print</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">r</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #F07178\">ok</span><span style=\"color: #89DDFF\">)</span></span></code></pre></div><p>  输出(失败):</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">&lt;Response [412]&gt;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">False</span></span></code></pre></div></li>\n<li><p>修改请求头, 模拟浏览器访问:</p>\n<div class=\"language-python\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">python</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">import</span><span style=\"color: #BABED8\"> requests</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">headers </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">User-Agent</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36 Edg/121.0.0.0</span><span style=\"color: #89DDFF\">&quot;</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">&#125;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">r </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> requests</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">get</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">https://www.bilibili.com/</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\"> </span><span style=\"color: #BABED8; font-style: italic\">headers</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #82AAFF\">headers</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #82AAFF\">print</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">r</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #82AAFF\">print</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">r</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #F07178\">ok</span><span style=\"color: #89DDFF\">)</span></span></code></pre></div><p>输出(成功):</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">&lt;Response [200]&gt;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">True</span></span></code></pre></div></li>\n</ul>\n<h4 id=\"正则表达式匹配\"><a href=\"#正则表达式匹配\" class=\"headerlink\" title=\"正则表达式匹配\"></a>正则表达式匹配</h4><h5 id=\"导入模块-re\"><a href=\"#导入模块-re\" class=\"headerlink\" title=\"导入模块-re\"></a>导入模块-re</h5><ul>\n<li><div class=\"language-python\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">python</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">import</span><span style=\"color: #BABED8\"> re</span></span></code></pre></div></li>\n</ul>\n<h5 id=\"捕获组\"><a href=\"#捕获组\" class=\"headerlink\" title=\"捕获组\"></a>捕获组</h5><ul>\n<li>要获取的字段要用括号<code>( )</code>括起来</li>\n</ul>\n<h5 id=\"匹配-re-match函数\"><a href=\"#匹配-re-match函数\" class=\"headerlink\" title=\"匹配:re.match函数\"></a>匹配:re.match函数</h5><ul>\n<li><p>函数语法</p>\n<div class=\"language-python\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">python</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #BABED8\">re</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">match</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">pattern</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\"> string</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\"> </span><span style=\"color: #BABED8; font-style: italic\">flags</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #F78C6C\">0</span><span style=\"color: #89DDFF\">)</span></span></code></pre></div><table>\n<thead>\n<tr>\n<th align=\"left\">参数</th>\n<th align=\"left\">描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">pattern</td>\n<td align=\"left\">匹配的正则表达式</td>\n</tr>\n<tr>\n<td align=\"left\">string</td>\n<td align=\"left\">要匹配的字符串。</td>\n</tr>\n<tr>\n<td align=\"left\">flags</td>\n<td align=\"left\">标志位，用于控制正则表达式的匹配方式</td>\n</tr>\n</tbody></table>\n<table>\n<thead>\n<tr>\n<th align=\"left\">修饰符</th>\n<th align=\"left\">描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">re.I</td>\n<td align=\"left\">使匹配对大小写不敏感</td>\n</tr>\n<tr>\n<td align=\"left\">re.L</td>\n<td align=\"left\">做本地化识别（locale-aware）匹配</td>\n</tr>\n<tr>\n<td align=\"left\">re.M</td>\n<td align=\"left\">多行匹配，影响 ^ 和 $</td>\n</tr>\n<tr>\n<td align=\"left\">re.S</td>\n<td align=\"left\">使 . 匹配包括换行在内的所有字符</td>\n</tr>\n<tr>\n<td align=\"left\">re.U</td>\n<td align=\"left\">根据Unicode字符集解析字符。这个标志影响 \\w, \\W, \\b, \\B.</td>\n</tr>\n<tr>\n<td align=\"left\">re.X</td>\n<td align=\"left\">该标志通过给予你更灵活的格式以便你将正则表达式写得更易于理解。</td>\n</tr>\n</tbody></table>\n</li>\n<li><p>返回:</p>\n<ul>\n<li>匹配成功 re.match 方法返回一个匹配的对象，否则返回 None。</li>\n<li>可使用 group(num) 或 groups() 来获取匹配表达式。</li>\n</ul>\n</li>\n<li><p>示例:</p>\n<div class=\"language-python\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">python</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #BABED8\">content </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">Hello 100 World!</span><span style=\"color: #89DDFF\">&#39;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">res </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> re</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">match</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #C792EA\">r</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">^He.</span><span style=\"color: #89DDFF\">*?(</span><span style=\"color: #C3E88D\">\\d</span><span style=\"color: #89DDFF\">+)</span><span style=\"color: #C3E88D\">\\s.</span><span style=\"color: #89DDFF\">*</span><span style=\"color: #C3E88D\">!$</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\"> content</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #82AAFF\">print</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">res</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">group</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #F78C6C\">1</span><span style=\"color: #89DDFF\">))</span></span></code></pre></div><p>输出:</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">100</span></span></code></pre></div></li>\n</ul>\n<h5 id=\"查找\"><a href=\"#查找\" class=\"headerlink\" title=\"查找\"></a>查找</h5><ul>\n<li><p>查找第一个:</p>\n<div class=\"language-python\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">python</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #BABED8\">res </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> re</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">search</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #C792EA\">r</span><span style=\"color: #89DDFF\">&#39;[</span><span style=\"color: #C3E88D\">\\d</span><span style=\"color: #89DDFF\">]&#123;3&#125;&#39;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\"> content</span><span style=\"color: #89DDFF\">)</span></span></code></pre></div></li>\n<li><p>查找所有:</p>\n<div class=\"language-python\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">python</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #BABED8\">res </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> re</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">findall</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #C792EA\">r</span><span style=\"color: #89DDFF\">&#39;[</span><span style=\"color: #C3E88D\">\\d</span><span style=\"color: #89DDFF\">]&#123;3&#125;&#39;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\"> content</span><span style=\"color: #89DDFF\">)</span></span></code></pre></div></li>\n</ul>\n<h5 id=\"封装匹配方式\"><a href=\"#封装匹配方式\" class=\"headerlink\" title=\"封装匹配方式\"></a>封装匹配方式</h5><ul>\n<li><div class=\"language-python\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">python</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #BABED8\">pattern </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> re</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">compile</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">Xi.*?(\\d+)\\s.*s</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\">re</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #F07178\">S</span><span style=\"color: #89DDFF\">)</span></span></code></pre></div></li>\n</ul>\n<h4 id=\"BeautifulSoup解析获取的html文件\"><a href=\"#BeautifulSoup解析获取的html文件\" class=\"headerlink\" title=\"BeautifulSoup解析获取的html文件\"></a>BeautifulSoup解析获取的html文件</h4><ul>\n<li><p>示例:</p>\n<div class=\"language-python\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">python</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">import</span><span style=\"color: #BABED8\"> requests</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">from</span><span style=\"color: #BABED8\"> bs4 </span><span style=\"color: #89DDFF; font-style: italic\">import</span><span style=\"color: #BABED8\"> BeautifulSoup</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">headers </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">User-Agent</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36 Edg/121.0.0.0</span><span style=\"color: #89DDFF\">&quot;</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">&#125;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    response </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> requests</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">get</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #C792EA\">f</span><span style=\"color: #C3E88D\">&quot;https://movie.douban.com/top250)</span></span>\n<span class=\"line\"><span style=\"color: #C3E88D\">    content = response.text</span></span>\n<span class=\"line\"><span style=\"color: #C3E88D\">                            </span></span>\n<span class=\"line\"><span style=\"color: #C3E88D\">    soup = BeautifulSoup(content, &quot;</span><span style=\"color: #82AAFF\">html</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #F07178\">parser</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">)</span></span>\n<span class=\"line\"><span style=\"color: #82AAFF\">    </span><span style=\"color: #BABED8; font-style: italic\">title</span><span style=\"color: #82AAFF\"> </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #82AAFF\"> soup</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">find_all</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">div</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\"> </span><span style=\"color: #89DDFF\">&#123;</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">class</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #82AAFF\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">info</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">&#125;)</span></span>\n<span class=\"line\"><span style=\"color: #82AAFF\">    </span><span style=\"color: #89DDFF; font-style: italic\">for</span><span style=\"color: #82AAFF\"> info </span><span style=\"color: #89DDFF; font-style: italic\">in</span><span style=\"color: #82AAFF\"> title</span><span style=\"color: #89DDFF\">:</span></span>\n<span class=\"line\"><span style=\"color: #82AAFF\">        </span><span style=\"color: #89DDFF; font-style: italic\">for</span><span style=\"color: #82AAFF\"> hd </span><span style=\"color: #89DDFF; font-style: italic\">in</span><span style=\"color: #82AAFF\"> info</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">find_all</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">div</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\"> </span><span style=\"color: #89DDFF\">&#123;</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">class</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #82AAFF\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">hd</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">&#125;):</span></span>\n<span class=\"line\"><span style=\"color: #82AAFF\">            print</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">hd</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">find</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">span</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\"> </span><span style=\"color: #89DDFF\">&#123;</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">class</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #82AAFF\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">title</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">&#125;).</span><span style=\"color: #F07178\">string</span><span style=\"color: #89DDFF\">)</span></span></code></pre></div><p>输出:</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">肖申克的救赎</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">霸王别姬</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">阿甘正传</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">泰坦尼克号</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">这个杀手不太冷</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">千与千寻</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">美丽人生</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">星际穿越</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">盗梦空间</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">..</span></span></code></pre></div></li>\n<li><p><code>soup = BeautifulSoup(content, &quot;html.parser&quot;)</code>, 解析content中的HTML</p>\n</li>\n<li><p>XX.find()返回查找的第一个</p>\n</li>\n<li><p>XX.find_all()返回找到的全部内容的一个列表</p>\n</li>\n</ul>\n<h3 id=\"Selenium自动化工具\"><a href=\"#Selenium自动化工具\" class=\"headerlink\" title=\"Selenium自动化工具\"></a>Selenium自动化工具</h3><h4 id=\"安装与导入\"><a href=\"#安装与导入\" class=\"headerlink\" title=\"安装与导入\"></a>安装与导入</h4><ul>\n<li><div class=\"language-sh\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">sh</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #FFCB6B\">pip</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">install</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">selenium</span></span></code></pre></div></li>\n<li><div class=\"language-python\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">python</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">from</span><span style=\"color: #BABED8\"> selenium </span><span style=\"color: #89DDFF; font-style: italic\">import</span><span style=\"color: #BABED8\"> webdriver</span></span></code></pre></div></li>\n</ul>\n<h4 id=\"示例\"><a href=\"#示例\" class=\"headerlink\" title=\"示例\"></a>示例</h4><ul>\n<li><div class=\"language-python\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">python</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">from</span><span style=\"color: #BABED8\"> selenium </span><span style=\"color: #89DDFF; font-style: italic\">import</span><span style=\"color: #BABED8\"> webdriver</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">driver </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> webdriver</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">Chrome</span><span style=\"color: #89DDFF\">()</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 创建一个web驱动(Chrome驱动)实例</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">driver</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">get</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">https://www.baidu.com</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 打开网页</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #82AAFF\">input</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> driver</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">find_element</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">css selector</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\"> </span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">#kw</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 找到输入框</span></span>\n<span class=\"line\"><span style=\"color: #82AAFF\">input</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">send_keys</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">图片</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 输入内容</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">button </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> driver</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">find_element</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">css selector</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\"> </span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">#su</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 找到按钮</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">button</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">click</span><span style=\"color: #89DDFF\">()</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 点击按钮</span></span></code></pre></div></li>\n<li><p>效果与真正的用户操作几乎一样:</p>\n<p><img src=\"https://i0.imgs.ovh/2024/01/31/KtkvK.png\"></p>\n</li>\n</ul>\n<h4 id=\"常用方法\"><a href=\"#常用方法\" class=\"headerlink\" title=\"常用方法\"></a>常用方法</h4><h5 id=\"获取元素\"><a href=\"#获取元素\" class=\"headerlink\" title=\"获取元素\"></a>获取元素</h5><ul>\n<li><code>find_element()</code>:获取单个元素</li>\n<li><code>find_elements()</code>: 获取多个元素</li>\n<li>第一个参数’by’用于指定获取搜索目标, 包括<strong>id, name, xpath, link text, partial link text, tag name, class name, css selector</strong></li>\n</ul>\n<h5 id=\"输入内容\"><a href=\"#输入内容\" class=\"headerlink\" title=\"输入内容\"></a>输入内容</h5><ul>\n<li><code>send_key()</code></li>\n</ul>\n<h5 id=\"获取信息\"><a href=\"#获取信息\" class=\"headerlink\" title=\"获取信息\"></a>获取信息</h5><ul>\n<li><code>current_url</code>获取请求链接</li>\n<li><code>get_cookies()</code>获取 cookies</li>\n<li><code>page_source</code>获取源代码</li>\n<li><code>input.text</code>获取文本的值</li>\n</ul>\n<h3 id=\"数据存储\"><a href=\"#数据存储\" class=\"headerlink\" title=\"数据存储\"></a>数据存储</h3><ul>\n<li><p><strong>pymysql</strong>: mysql操作</p>\n<ul>\n<li><p>操作:</p>\n<ul>\n<li>安装: <code>pip install PyMySQL</code></li>\n<li>导入:<code>import pymysql </code></li>\n<li>创建连接:</li>\n</ul>\n<div class=\"language-python\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">python</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #BABED8\">conn </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> pymysql</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">connect</span><span style=\"color: #89DDFF\">(</span></span>\n<span class=\"line\"><span style=\"color: #82AAFF\">    </span><span style=\"color: #BABED8; font-style: italic\">host</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">localhost</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\">\t\t</span><span style=\"color: #676E95; font-style: italic\"># 主机名（或IP地址）</span></span>\n<span class=\"line\"><span style=\"color: #82AAFF\">    </span><span style=\"color: #BABED8; font-style: italic\">port</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #F78C6C\">3306</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\">\t\t\t\t</span><span style=\"color: #676E95; font-style: italic\"># 端口号，默认为3306</span></span>\n<span class=\"line\"><span style=\"color: #82AAFF\">    </span><span style=\"color: #BABED8; font-style: italic\">user</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">root</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\">\t\t\t</span><span style=\"color: #676E95; font-style: italic\"># 用户名</span></span>\n<span class=\"line\"><span style=\"color: #82AAFF\">    </span><span style=\"color: #BABED8; font-style: italic\">password</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">password</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\">\t</span><span style=\"color: #676E95; font-style: italic\"># 密码</span></span>\n<span class=\"line\"><span style=\"color: #82AAFF\">    </span><span style=\"color: #BABED8; font-style: italic\">charset</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">utf8mb4</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #82AAFF\">  \t\t</span><span style=\"color: #676E95; font-style: italic\"># 设置字符编码</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">)</span></span></code></pre></div><ul>\n<li><p>mysql服务信息: <code>conn.get_server_info()</code></p>\n</li>\n<li><p>创建游标对象: <code>cursor = conn.cursor() </code></p>\n</li>\n<li><p>选择数据库: <code>conn.select_db(&quot;table_name&quot;) </code></p>\n</li>\n<li><p>执行操作: <code>cursor.execute(&#39;SELECT * FROM table_name&#39;) </code></p>\n</li>\n<li><p>获取查询结果，返回元组: <code>result : tuple = cursor.fetchall() </code></p>\n</li>\n<li><p>关闭游标和连接: <code>cursor.close() </code>, <code>conn.close() </code></p>\n</li>\n<li><p>数据更改后(<code>insert</code>, <code>update</code>, <code>delete</code>), 需提交更改: <code>conn.commit() </code></p>\n</li>\n<li><p>自动提交更改: 在创建连接时, 加上参数<code>autocommit=True</code></p>\n</li>\n<li><p>错误处理, 回滚操作: <code>conn.rollback()</code></p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">try:</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">    # 执行一些操作</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">    ...</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">    conn.commit()</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">except Exception as e:</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">    print(f&quot;发生错误：&#123;e&#125;&quot;)</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">    conn.rollback()</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">finally:</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">    cursor.close()</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">    conn.close()</span></span></code></pre></div></li>\n</ul>\n</li>\n<li><p>实例:</p>\n<div class=\"language-python\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">python</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">import</span><span style=\"color: #BABED8\"> requests</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">from</span><span style=\"color: #BABED8\"> bs4 </span><span style=\"color: #89DDFF; font-style: italic\">import</span><span style=\"color: #BABED8\"> BeautifulSoup</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">import</span><span style=\"color: #BABED8\"> pymysql</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">conn </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> pymysql</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">connect</span><span style=\"color: #89DDFF\">(</span></span>\n<span class=\"line\"><span style=\"color: #82AAFF\">    </span><span style=\"color: #BABED8; font-style: italic\">host</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">localhost</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">,</span></span>\n<span class=\"line\"><span style=\"color: #82AAFF\">    </span><span style=\"color: #BABED8; font-style: italic\">port</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #F78C6C\">3306</span><span style=\"color: #89DDFF\">,</span></span>\n<span class=\"line\"><span style=\"color: #82AAFF\">    </span><span style=\"color: #BABED8; font-style: italic\">user</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">root</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">,</span></span>\n<span class=\"line\"><span style=\"color: #82AAFF\">    </span><span style=\"color: #BABED8; font-style: italic\">password</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">root</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">,</span></span>\n<span class=\"line\"><span style=\"color: #82AAFF\">    </span><span style=\"color: #BABED8; font-style: italic\">charset</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">utf8mb4</span><span style=\"color: #89DDFF\">&#39;</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #82AAFF\">print</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">conn</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">get_server_info</span><span style=\"color: #89DDFF\">())</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">conn</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">select_db</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">pymysql</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">cur </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> conn</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">cursor</span><span style=\"color: #89DDFF\">()</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">headers </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">User-Agent</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36 Edg/121.0.0.0</span><span style=\"color: #89DDFF\">&quot;</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">&#125;</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">for</span><span style=\"color: #BABED8\"> start_num </span><span style=\"color: #89DDFF; font-style: italic\">in</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">range</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #F78C6C\">0</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\"> </span><span style=\"color: #F78C6C\">250</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\"> </span><span style=\"color: #F78C6C\">25</span><span style=\"color: #89DDFF\">):</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    response </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> requests</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">get</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #C792EA\">f</span><span style=\"color: #C3E88D\">&quot;https://movie.douban.com/top250?start=</span><span style=\"color: #F78C6C\">&#123;</span><span style=\"color: #82AAFF\">start_num</span><span style=\"color: #F78C6C\">&#125;</span><span style=\"color: #C3E88D\">&quot;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\"> </span><span style=\"color: #BABED8; font-style: italic\">headers</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #82AAFF\">headers</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    content </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> response</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #F07178\">text</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    soup </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">BeautifulSoup</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">content</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">html.parser</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    title </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> soup</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">find_all</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">div</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\"> </span><span style=\"color: #89DDFF\">&#123;</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">class</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #82AAFF\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">info</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">&#125;)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF; font-style: italic\">for</span><span style=\"color: #BABED8\"> info </span><span style=\"color: #89DDFF; font-style: italic\">in</span><span style=\"color: #BABED8\"> title</span><span style=\"color: #89DDFF\">:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #89DDFF; font-style: italic\">for</span><span style=\"color: #BABED8\"> hd </span><span style=\"color: #89DDFF; font-style: italic\">in</span><span style=\"color: #BABED8\"> info</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">find_all</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">div</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\"> </span><span style=\"color: #89DDFF\">&#123;</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">class</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #82AAFF\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">hd</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">&#125;):</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            name </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> hd</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">find</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">span</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\"> </span><span style=\"color: #89DDFF\">&#123;</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">class</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #82AAFF\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">title</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">&#125;).</span><span style=\"color: #F07178\">string</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            cur</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">execute</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #C792EA\">f</span><span style=\"color: #C3E88D\">&quot;insert into douban (name) values (&#39;</span><span style=\"color: #F78C6C\">&#123;</span><span style=\"color: #82AAFF\">name</span><span style=\"color: #F78C6C\">&#125;</span><span style=\"color: #C3E88D\">&#39;)&quot;</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            conn</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">commit</span><span style=\"color: #89DDFF\">()</span></span></code></pre></div></li>\n</ul>\n</li>\n<li><p><strong>redis-dump</strong>: redis数据库操作<br><a href=\"https://github.com/delano/redis-dump\">delano&#x2F;redis-dump: Backup and restore your Redis data to and from JSON. (github.com)</a></p>\n</li>\n</ul>\n<h3 id=\"爬虫框架\"><a href=\"#爬虫框架\" class=\"headerlink\" title=\"爬虫框架\"></a>爬虫框架</h3><p><strong>scrapy</strong>: 可以轻松爬取亚马逊等商城的数据</p>\n<ul>\n<li>安装: <code>pip install Scrapy</code></li>\n<li>新建项目: <code>scrapy startproject &lt;project-name&gt;</code></li>\n<li>制作爬虫:<ul>\n<li><p>新建爬虫:<code>scrapy genspider &lt;name&gt; &quot;&lt;网站域名&gt;&quot;</code>, 爬取数据</p>\n</li>\n<li><p>在<code>items.py</code>定义</p>\n<div class=\"language-py\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">py</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #C792EA\">class</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">SupplytraceItem</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">scrapy</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #FFCB6B\">Item</span><span style=\"color: #89DDFF\">):</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #676E95; font-style: italic\"># define the fields for your item here like:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #676E95; font-style: italic\"># name = scrapy.Field()</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #82AAFF\">id</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> scrapy</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">Field</span><span style=\"color: #89DDFF\">()</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    company_name_english </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> scrapy</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">Field</span><span style=\"color: #89DDFF\">()</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    company_name_legal </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> scrapy</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">Field</span><span style=\"color: #89DDFF\">()</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    brand </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> scrapy</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">Field</span><span style=\"color: #89DDFF\">()</span></span></code></pre></div></li>\n<li><p>在爬虫文件中处理数据</p>\n</li>\n</ul>\n</li>\n<li>保存数据:<ul>\n<li>-<code>o</code>输出到指定文件: <code>scrapy crawl &lt;name&gt; -o &lt;filename&gt;</code><br>会根据文件类型进行保存, 包括json, jsonl, csv, xml文件</li>\n</ul>\n</li>\n</ul>\n","text":"Python爬虫基础爬虫概念定义 网络爬虫是伪装成客户端与服务端进行数据交互的程序。 应用 数据采集, 搜索引擎, 模拟操作, 软件测试, 网络安全(信息轰炸,...","permalink":"/post/Python爬虫基础","photos":[],"count_time":{"symbolsCount":"6.6k","symbolsTime":"6 mins."},"categories":[],"tags":[{"name":"网络安全","slug":"网络安全","count":21,"path":"api/tags/网络安全.json"},{"name":"学习日志","slug":"学习日志","count":21,"path":"api/tags/学习日志.json"},{"name":"Python基础","slug":"Python基础","count":1,"path":"api/tags/Python基础.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Python%E7%88%AC%E8%99%AB%E5%9F%BA%E7%A1%80\"><span class=\"toc-text\">Python爬虫基础</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%88%AC%E8%99%AB%E6%A6%82%E5%BF%B5\"><span class=\"toc-text\">爬虫概念</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%AE%9A%E4%B9%89\"><span class=\"toc-text\">定义</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%BA%94%E7%94%A8\"><span class=\"toc-text\">应用</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E4%B8%80%E8%88%AC%E6%B5%81%E7%A8%8B\"><span class=\"toc-text\">一般流程</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E4%BC%9A%E8%AF%9D%E6%8A%80%E6%9C%AF\"><span class=\"toc-text\">会话技术:</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#Cookie-s\"><span class=\"toc-text\">Cookie(s)</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#Session\"><span class=\"toc-text\">Session</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%88%AC%E8%99%AB%E5%9F%BA%E7%A1%80\"><span class=\"toc-text\">爬虫基础</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#urllib%E5%BA%93request%E6%A8%A1%E5%9D%97\"><span class=\"toc-text\">urllib库request模块</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E7%AE%80%E5%8D%95%E7%A4%BA%E4%BE%8B\"><span class=\"toc-text\">简单示例</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#urlopen%E6%96%B9%E6%B3%95\"><span class=\"toc-text\">urlopen方法</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#Request%E6%96%B9%E6%B3%95\"><span class=\"toc-text\">Request方法</span></a></li></ol></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#requests%E5%BA%93%E5%8F%91%E9%80%81%E8%AF%B7%E6%B1%82\"><span class=\"toc-text\">requests库发送请求</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%8C%B9%E9%85%8D\"><span class=\"toc-text\">正则表达式匹配</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E5%AF%BC%E5%85%A5%E6%A8%A1%E5%9D%97-re\"><span class=\"toc-text\">导入模块-re</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E6%8D%95%E8%8E%B7%E7%BB%84\"><span class=\"toc-text\">捕获组</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E5%8C%B9%E9%85%8D-re-match%E5%87%BD%E6%95%B0\"><span class=\"toc-text\">匹配:re.match函数</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E6%9F%A5%E6%89%BE\"><span class=\"toc-text\">查找</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E5%B0%81%E8%A3%85%E5%8C%B9%E9%85%8D%E6%96%B9%E5%BC%8F\"><span class=\"toc-text\">封装匹配方式</span></a></li></ol></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#BeautifulSoup%E8%A7%A3%E6%9E%90%E8%8E%B7%E5%8F%96%E7%9A%84html%E6%96%87%E4%BB%B6\"><span class=\"toc-text\">BeautifulSoup解析获取的html文件</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Selenium%E8%87%AA%E5%8A%A8%E5%8C%96%E5%B7%A5%E5%85%B7\"><span class=\"toc-text\">Selenium自动化工具</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%AE%89%E8%A3%85%E4%B8%8E%E5%AF%BC%E5%85%A5\"><span class=\"toc-text\">安装与导入</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E7%A4%BA%E4%BE%8B\"><span class=\"toc-text\">示例</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95\"><span class=\"toc-text\">常用方法</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E8%8E%B7%E5%8F%96%E5%85%83%E7%B4%A0\"><span class=\"toc-text\">获取元素</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E8%BE%93%E5%85%A5%E5%86%85%E5%AE%B9\"><span class=\"toc-text\">输入内容</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E8%8E%B7%E5%8F%96%E4%BF%A1%E6%81%AF\"><span class=\"toc-text\">获取信息</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8\"><span class=\"toc-text\">数据存储</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%88%AC%E8%99%AB%E6%A1%86%E6%9E%B6\"><span class=\"toc-text\">爬虫框架</span></a></li></ol></li></ol>","author":{"name":"Myprefer","slug":"blog-author","avatar":"https://gravatar.com/avatar/d195051819ce742212020a79d768fb6c?size=256&cache=1710768150791","link":"https://github.com/Myprefer","description":"web security learner, ML learner","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"小迪安全 P3","uid":"d471c3c5657b4c4f477f2defc20d21ed","slug":"小迪安全-P3","date":"2024-01-28T13:29:15.000Z","updated":"2024-02-03T11:28:55.998Z","comments":true,"path":"api/articles/小迪安全-P3.json","keywords":null,"cover":null,"text":" 学会不同对象采用不同抓包封包抓取技术分析 抓包 当需要知道应用程序等的IP, 域名时需要抓包后分析 对不同的协议用不同的工具 web协议: Charles, ...","permalink":"/post/小迪安全-P3","photos":[],"count_time":{"symbolsCount":140,"symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"网络安全","slug":"网络安全","count":21,"path":"api/tags/网络安全.json"},{"name":"学习日志","slug":"学习日志","count":21,"path":"api/tags/学习日志.json"},{"name":"小迪安全","slug":"小迪安全","count":8,"path":"api/tags/小迪安全.json"},{"name":"基础入门","slug":"基础入门","count":5,"path":"api/tags/基础入门.json"}],"author":{"name":"Myprefer","slug":"blog-author","avatar":"https://gravatar.com/avatar/d195051819ce742212020a79d768fb6c?size=256&cache=1710768150791","link":"https://github.com/Myprefer","description":"web security learner, ML learner","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"HTTP协议请求结构","uid":"fc05fbb308fc2fe612857f2de1b31069","slug":"HTTP协议请求结构","date":"2024-01-27T12:53:28.000Z","updated":"2024-01-28T05:51:41.866Z","comments":true,"path":"api/articles/HTTP协议请求结构.json","keywords":null,"cover":[],"text":"HTTP协议 HTTP: Hypertext Transfer Protocol 作用: 是一种用于传输超文本的协议。 是客户端和服务器之间进行通信的基础，常用...","permalink":"/post/HTTP协议请求结构","photos":[],"count_time":{"symbolsCount":"1.6k","symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"网络安全","slug":"网络安全","count":21,"path":"api/tags/网络安全.json"},{"name":"学习日志","slug":"学习日志","count":21,"path":"api/tags/学习日志.json"}],"author":{"name":"Myprefer","slug":"blog-author","avatar":"https://gravatar.com/avatar/d195051819ce742212020a79d768fb6c?size=256&cache=1710768150791","link":"https://github.com/Myprefer","description":"web security learner, ML learner","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}