{"title":"使用监督机器学习算法检测NetFlow网络流量中的异常","uid":"b429302f99829f88df9f7f39d9b7a9fe","slug":"使用监督机器学习算法检测NetFlow网络流量中的异常","date":"2025-03-07T11:19:15.000Z","updated":"2025-03-10T04:43:39.621Z","comments":true,"path":"api/articles/使用监督机器学习算法检测NetFlow网络流量中的异常.json","keywords":null,"cover":[],"content":"<h1 id=\"机器学习算法在异常网络流量监测中的应用\"><a href=\"#机器学习算法在异常网络流量监测中的应用\" class=\"headerlink\" title=\"机器学习算法在异常网络流量监测中的应用\"></a>机器学习算法在异常网络流量监测中的应用</h1><p><strong>Detecting Network Anomalies in NetFlow Traffic with Machine Learning Algorithms</strong></p>\n<p>比较三种广泛使用的传统 ML 算法：<strong>逻辑回归 (LR)<strong>、</strong>朴素贝叶斯分类器 (NB)</strong> 和<strong>随机森林 (RF)<strong>，以及</strong>深度学习 (DL) 算法</strong>、<strong>递归神经网络 (RNN)<strong>。评估这些不同的 ML 模型在检测各种类型的网络异常(包括</strong>入侵尝试</strong>、<strong>拒绝服务 (DoS) 攻击</strong>和内部威胁)方面的性能</p>\n<h4 id=\"相关工作\"><a href=\"#相关工作\" class=\"headerlink\" title=\"相关工作\"></a>相关工作</h4><ul>\n<li><p><strong>Anomaly detection in netflow network traffic using supervised machine learning algorithms</strong></p>\n<ul>\n<li>在 <strong>UNSW-NB15 数据集</strong>上评估随机梯度下降 (SGD)、支持向量机(SVM)、K最近邻(KNN)、高斯朴素贝叶斯 (GNB)、决策树 (DT)、RF 和 AdaBoost (AB) </li>\n<li>RF 分类器是最有效的，通过利用数据集的代表性子集，实现了 97.68% 的 F1 分数和 98.47% 的 AUC 分数。</li>\n</ul>\n</li>\n<li><p><strong>Performance of machine learning techniques in anomaly detection with basic feature selection strategy-a network intrusion detection system</strong></p>\n<ul>\n<li>出了一种使用机器学习将来自网络入侵检测系统 (NIDS)的传入网络流量分类为正常或异常的方法</li>\n</ul>\n</li>\n<li><p><strong>Design and development of rnn anomaly detection model for iot networks</strong></p>\n<ul>\n<li>介绍了一种用于物联网网络异常检测的新型 DL 方法，该方法利用 LSTM、BiLSTM 和 GRU 变体以及混合 CNN-RNN 模型</li>\n</ul>\n</li>\n<li><p><strong>Network anomaly detection using deep learning techniques</strong></p>\n<ul>\n<li>提出了一种使用卷积神经网络 (CNN) 解决网络异常的新方法</li>\n<li>作者提出了一个为这项任务量身定制的一维 CNN 模型。最初，网络流量数据分为 TCP、UDP 和其他协议。随后，每个类别都经过独立处理。在模型训练之前使用卡方技术进行特征选择，然后进行过采样以解决类不平衡问题</li>\n</ul>\n</li>\n<li><p><strong>Real-time detection of network traffic anomalies in big data environments using deep learning models</strong></p>\n</li>\n</ul>\n<h4 id=\"数据集\"><a href=\"#数据集\" class=\"headerlink\" title=\"数据集\"></a>数据集</h4><ul>\n<li>BoT IoT、IoT-NI、IoT-23、MQTT、MQTTset、loT-DS2</li>\n<li><img src=\"https://raw.githubusercontent.com/Myprefer/ImageHost/main/%E8%A1%A8%201%C2%A0%20%E7%BD%91%E7%BB%9C%E5%BC%82%E5%B8%B8%E6%B5%81%E9%87%8F%E6%95%B0%E6%8D%AE%E9%9B%86%E6%80%BB%E7%BB%93.png\" alt=\"表 1  网络异常流量数据集总结\"></li>\n</ul>\n<h4 id=\"方法和实验设计\"><a href=\"#方法和实验设计\" class=\"headerlink\" title=\"方法和实验设计\"></a><strong>方法和实验设计</strong></h4><p>整体思路就是先数据预处理，包括数据清洗、标签编码、归一化、特征选取、类平衡，然后交给不同算法训练，评估比较不同算法的结果。</p>\n<p><img src=\"https://raw.githubusercontent.com/Myprefer/ImageHost/main/338b1fe60c489c739a7bd8ad45e49018.png\" alt=\"img\"></p>\n<h5 id=\"A-Data-Preprocessing\"><a href=\"#A-Data-Preprocessing\" class=\"headerlink\" title=\"A. Data Preprocessing\"></a><strong>A. Data Preprocessing</strong></h5><ul>\n<li>使用标签编码将分类变量(如协议)编码为数字表示。(这种方法涉及为变量中的每个类别分配一个唯一的数值，将分类数据转换为适合 ML 算法的格式。选择标签编码是因为它在保持分类特征中的序数关系方面简单而有效)。</li>\n<li>归一化：此外，这些数值特征将被归一化，以标准化它们在数据集中的比例。这种归一化是使用 Min-Max 缩放技术实现的，其中每个特征 X 都转换为 0 到 1 范围内的值。<img src=\"https://raw.githubusercontent.com/Myprefer/ImageHost/main/4eeda744a1973dcd5a30fa46d46bfd58.png\" alt=\"img\"></li>\n</ul>\n<h5 id=\"B-Feature-Engineering\"><a href=\"#B-Feature-Engineering\" class=\"headerlink\" title=\"B. Feature Engineering\"></a><strong>B. Feature Engineering</strong></h5><p><img src=\"https://raw.githubusercontent.com/Myprefer/ImageHost/main/8d46c0c8ae4dac0cc9e75b4c55de4453.png\" alt=\"img\"></p>\n<ul>\n<li>根据从 RF 模型获得的重要性分数来选择前 10 个最相关的特征。</li>\n<li>最相关的特征主要与<strong>字节数</strong>、<strong>流持续时间</strong>以及<strong>与 TCP 窗口相关的一些特征</strong>相关。</li>\n<li>结合了<strong>数据重采样技术</strong>来解决<strong>数据集中的类不平衡问题</strong>，确保异常检测模型在平衡的数据集上进行训练。类不平衡是异常检测任务中的一个常见问题，其中少数类明显小于多数类，这可能导致模型性能有偏差。</li>\n</ul>\n<h5 id=\"C-SMOTE-合成少数类过采样技术\"><a href=\"#C-SMOTE-合成少数类过采样技术\" class=\"headerlink\" title=\"C. SMOTE(合成少数类过采样技术)\"></a><strong>C. SMOTE(合成少数类过采样技术)</strong></h5><p>Synthetic Minority Over-sampling Technique (SMOTE)意为****合成少数类过采样技术****。SMOTE具体功能是为少数类生成合成样本，以实现更均衡的类分布。SMOTE 的工作原理是根据现有少数类样本的特征空间相似性合成新的少数类实例。</p>\n<h5 id=\"D-模型\"><a href=\"#D-模型\" class=\"headerlink\" title=\"D.模型\"></a>D.模型</h5><ul>\n<li>LR：这是一种用于二元分类任务的基本统计方法。LR 模型使用 logistic 函数估计给定实例属于特定类的概率</li>\n<li>NB ：是一个基于贝叶斯定理的概率分类器，特征之间具有很强的独立性假设。<img src=\"https://raw.githubusercontent.com/Myprefer/ImageHost/main/image-20250310124247258.png\" alt=\"image-20250310124247258\"></li>\n<li>RF: 是一种集成学习技术，它构建多个 DT 并结合这些树的预测，以改进分类并减少过拟合。</li>\n<li>RNN: 循环神经网络</li>\n</ul>\n<h4 id=\"实验结果\"><a href=\"#实验结果\" class=\"headerlink\" title=\"实验结果\"></a>实验结果</h4><ul>\n<li><p>端口分布</p>\n<ul>\n<li><p>源端口：主要集中在超过 30,000 的值</p>\n<p><img src=\"https://raw.githubusercontent.com/Myprefer/ImageHost/main/image-20250310122500989.png\" alt=\"image-20250310122500989\"></p>\n</li>\n<li><p>目标端口：集中在较低的值附近</p>\n</li>\n</ul>\n</li>\n</ul>\n<p><img src=\"https://raw.githubusercontent.com/Myprefer/ImageHost/main/image-20250310122730019.png\" alt=\"image-20250310122730019\"></p>\n<ul>\n<li><p>协议分布：TCP 是异常样本中使用最常用的协议</p>\n<p><img src=\"https://raw.githubusercontent.com/Myprefer/ImageHost/main/image-20250310122813802.png\" alt=\"image-20250310122813802\"></p>\n</li>\n<li><p>模型评估：</p>\n<ul>\n<li><p>评估指标：</p>\n<ul>\n<li>其中，(TP)代表真正例，(TN)代表真负例，(FP)代表假正例，(FN)代表假负例</li>\n<li>准确率（Acc）：衡量的是所有实例中正确分类的实例所占的比例。其计算公式为： $$Acc &#x3D; \\frac{TP + TN}{TP + TN + FP + FN}$$</li>\n<li>精确率（Pre）侧重于正预测的正确性，其计算公式为： $$Pre &#x3D; \\frac{TP}{TP + FP}$$</li>\n<li>召回率（Rec）强调模型检测特定类所有相关实例的能力，其计算公式为：  $$Rec &#x3D; \\frac{TP}{TP + FN} $</li>\n<li>F1值（F1）是精确率和召回率的平衡度量，定义为：  $$F1 &#x3D; 2\\times\\frac{Pre\\times Rec}{Pre + Rec} $$</li>\n<li>AUC表示受试者工作特征曲线（ROC）下的面积，该曲线绘制了不同阈值设置下的真正例率（TPR）与假正例率（FPR）。其计算公式为： $$AUC &#x3D; \\int_{0}^{1} TPR(FPR^{-1}(u))du $$ 其中，$$TPR &#x3D; \\frac{TP}{TP + FN} $$，$$FPR &#x3D; \\frac{FP}{FP + TN} $$ 。</li>\n</ul>\n</li>\n<li><p>各个模型的指标:<br><img src=\"https://raw.githubusercontent.com/Myprefer/ImageHost/main/c8f66dc71bc626c8f6e08f05f8c95996.png\" alt=\"img\"></p>\n</li>\n<li><p><img src=\"https://raw.githubusercontent.com/Myprefer/ImageHost/main/image-20250310124008960.png\" alt=\"image-20250310124008960\"></p>\n</li>\n<li><p>RF 模型在所有指标中表现最佳, 在区分正常实例和异常实例方面表现出稳健性</p>\n</li>\n</ul>\n</li>\n</ul>\n","feature":true,"text":"机器学习算法在异常网络流量监测中的应用Detecting Network Anomalies in NetFlow Traffic with Machine L...","permalink":"/post/使用监督机器学习算法检测NetFlow网络流量中的异常","photos":[],"count_time":{"symbolsCount":"2.7k","symbolsTime":"2 mins."},"categories":[],"tags":[],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95%E5%9C%A8%E5%BC%82%E5%B8%B8%E7%BD%91%E7%BB%9C%E6%B5%81%E9%87%8F%E7%9B%91%E6%B5%8B%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8\"><span class=\"toc-text\">机器学习算法在异常网络流量监测中的应用</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E7%9B%B8%E5%85%B3%E5%B7%A5%E4%BD%9C\"><span class=\"toc-text\">相关工作</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E6%95%B0%E6%8D%AE%E9%9B%86\"><span class=\"toc-text\">数据集</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E6%96%B9%E6%B3%95%E5%92%8C%E5%AE%9E%E9%AA%8C%E8%AE%BE%E8%AE%A1\"><span class=\"toc-text\">方法和实验设计</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#A-Data-Preprocessing\"><span class=\"toc-text\">A. Data Preprocessing</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#B-Feature-Engineering\"><span class=\"toc-text\">B. Feature Engineering</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#C-SMOTE-%E5%90%88%E6%88%90%E5%B0%91%E6%95%B0%E7%B1%BB%E8%BF%87%E9%87%87%E6%A0%B7%E6%8A%80%E6%9C%AF\"><span class=\"toc-text\">C. SMOTE(合成少数类过采样技术)</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#D-%E6%A8%A1%E5%9E%8B\"><span class=\"toc-text\">D.模型</span></a></li></ol></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%AE%9E%E9%AA%8C%E7%BB%93%E6%9E%9C\"><span class=\"toc-text\">实验结果</span></a></li></ol></li></ol></li></ol></li></ol>","author":{"name":"Myprefer","slug":"blog-author","avatar":"https://gravatar.com/avatar/d195051819ce742212020a79d768fb6c?size=256&cache=1710768150791","link":"https://github.com/Myprefer","description":"web security learner, ML learner","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{},"next_post":{"title":"ML LLM导论","uid":"85f934e2e8fb50a8bd6f24432b88250f","slug":"ML-LLM导论","date":"2025-02-10T08:17:47.000Z","updated":"2025-02-10T08:53:39.179Z","comments":true,"path":"api/articles/ML-LLM导论.json","keywords":null,"cover":[],"text":"概述 强调了预训练、监督学习和增强学习在模型训练中的重要性； 以及如何通过提供明确指示和示例来提高模型的表现。 原理ChatGPT的运作原理基于文字接龙 输入问...","permalink":"/post/ML-LLM导论","photos":[],"count_time":{"symbolsCount":597,"symbolsTime":"1 mins."},"categories":[],"tags":[],"author":{"name":"Myprefer","slug":"blog-author","avatar":"https://gravatar.com/avatar/d195051819ce742212020a79d768fb6c?size=256&cache=1710768150791","link":"https://github.com/Myprefer","description":"web security learner, ML learner","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true}}