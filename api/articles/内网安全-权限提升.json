{"title":"权限提升","uid":"584f79b33380f1b716ad57e583c2d3d1","slug":"内网安全-权限提升","date":"2024-04-18T03:44:47.000Z","updated":"2024-05-20T03:24:32.839Z","comments":true,"path":"api/articles/内网安全-权限提升.json","keywords":null,"cover":null,"content":"<h2 id=\"权限提升\"><a href=\"#权限提升\" class=\"headerlink\" title=\"权限提升\"></a>权限提升</h2><p>Web权限获取: 插件应用, 数据库, 中间件, 网站源码后台获取… </p>\n<p>网站前台: REC漏洞, 代码执行, 命令执行, 写文件, 写shell</p>\n<h4 id=\"权限划分\"><a href=\"#权限划分\" class=\"headerlink\" title=\"权限划分\"></a>权限划分</h4><ul>\n<li>Linux:<ul>\n<li>管理员UID为0: 系统的管理员用户</li>\n<li>系统用户UID为1~999</li>\n<li>普通用户UID从1000开始</li>\n</ul>\n</li>\n<li>Windows<ul>\n<li>用户及组: system(相当于root) administrator user guest等</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"具体的几种权限\"><a href=\"#具体的几种权限\" class=\"headerlink\" title=\"具体的几种权限\"></a>具体的几种权限</h4><ul>\n<li>后台权限:<ul>\n<li>获取方式: 爆破、注入猜解，弱口令等</li>\n<li>⼀般网站或应用后台智能操作应用的界面内容, 数据图片等信息，无法操作程序的源代码或服务器上的资源文件</li>\n<li>权限提取:<ul>\n<li>通过账户密码等信息获取数据库等权限</li>\n<li>通过文件编辑操作获取网站权限Webshell等</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>网站权限<ul>\n<li>获取方式: 写文件等</li>\n<li>查看或修改（还要看有没有锁权）程序源代码，可以进行网站或应用的配置文件读取（接口配置信息、数据库配置信息等），还能收集服务器操作系统等相关的信息，为后续系统提权做准备</li>\n</ul>\n</li>\n<li>数据库权限<ul>\n<li>获取方式: 源码或配置文件泄露, webshell进行配置文件读取等</li>\n<li>操作数据库的权限，数据库的增删改查等</li>\n<li>权限提取:<ul>\n<li>获取敏感数据, 获取后台权限</li>\n<li>写入文件, 获取webshell</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>接口权限<ul>\n<li>获取方式: 后台（修改配置信息功能点），网站权限（查看配置文件获取）</li>\n<li>邮件、短信、支付等功能接口</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"Windows权限提升\"><a href=\"#Windows权限提升\" class=\"headerlink\" title=\"Windows权限提升\"></a>Windows权限提升</h3><h4 id=\"溢出漏洞\"><a href=\"#溢出漏洞\" class=\"headerlink\" title=\"溢出漏洞\"></a>溢出漏洞</h4><h5 id=\"操作前提\"><a href=\"#操作前提\" class=\"headerlink\" title=\"操作前提\"></a>操作前提</h5><ul>\n<li>本地用户 当前计算机的某个用户</li>\n<li>Web权限 当前计算机的web权限 建立在web权限已经取得的情况下进行权限提升</li>\n</ul>\n<h5 id=\"成功条件\"><a href=\"#成功条件\" class=\"headerlink\" title=\"成功条件\"></a>成功条件</h5><ul>\n<li>符合的操作系统</li>\n<li>符合的溢出漏洞</li>\n</ul>\n<h5 id=\"常见步骤\"><a href=\"#常见步骤\" class=\"headerlink\" title=\"常见步骤\"></a>常见步骤</h5><ol>\n<li><p><strong>信息收集</strong></p>\n<ul>\n<li><p>收集: 操作系统版本, 漏洞补丁, 位数(32&#x2F;64) 杀软防护, 网络, 当前用户权限 等信息</p>\n</li>\n<li><p>常用命令:</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">ver</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">systeminfo</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">whoami</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">netstat -ano</span></span>\n<span class=\"line\"><span style=\"color: #babed8\">tasklist /svc</span></span></code></pre></div></li>\n</ul>\n</li>\n<li><p>基于补丁和系统版本 位数籁进行可用溢出漏洞EXP, 上传EXP调用执行去提权</p>\n<ul>\n<li><p>操作方式-<strong>推荐使用自动提权</strong>:</p>\n<ul>\n<li><p>基于手工操作</p>\n</li>\n<li><p>基于CS半自动提权</p>\n</li>\n<li><p>基于MSF全自动提权</p>\n</li>\n</ul>\n</li>\n<li><p>手工提取工具:</p>\n<ul>\n<li><a href=\"https://github.com/chroblert/WindowsVulnScan\">WindowsVulnScan: 基于主机的漏洞扫描工具 (github.com)</a></li>\n<li><a href=\"https://github.com/vulmon/Vulmap\">Vulmap: 在线本地漏洞扫描器(github.com)</a></li>\n<li><a href=\"https://github.com/bitsadmin/wesng\">wesng：Windows 漏洞利用建议器 - 下一代 (github.com)</a></li>\n<li><strong>网页</strong>:<a href=\"https://i.hacking8.com/tiquan\">提权辅助网页 Windows提权辅助 (hacking8.com)</a></li>\n</ul>\n</li>\n<li><p>寻找EXP利用 - 通过漏洞编号查找:</p>\n<ul>\n<li><strong>推</strong>:<a href=\"https://github.com/Ascotbe/Kernelhub\">Ascotbe&#x2F;Kernelhub: Linux、macOS、Windows 提权漏洞合集(github.com)</a></li>\n<li><a href=\"https://gitlab.com/exploit-database/exploitdb\">Exploit-DB &#x2F; Exploits + Shellcode + GHDB · GitLab</a></li>\n<li><a href=\"https://github.com/nomi-sec/PoC-in-GitHub\">nomi-sec&#x2F;PoC-in-GitHub：📡从 GitHub 自动收集 PoC。</a></li>\n<li><a href=\"https://github.com/k8gege/Ladon\">k8gege&#x2F;Ladon: Ladon大型内网渗透工具</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ol>\n<h4 id=\"数据库\"><a href=\"#数据库\" class=\"headerlink\" title=\"数据库\"></a>数据库</h4><h4 id=\"第三方软件\"><a href=\"#第三方软件\" class=\"headerlink\" title=\"第三方软件\"></a>第三方软件</h4><h3 id=\"Linux提权\"><a href=\"#Linux提权\" class=\"headerlink\" title=\"Linux提权\"></a>Linux提权</h3><p>通常, 在拥有一个webshell的时候, 一般权限都是web权限, 权限较低, 只能执行一些命令, 如查看当前用户, 网络, ip信息等, 如果想进行内网渗透就需要将权限提到最高, 如系统权限, 超级管理员权限</p>\n<h5 id=\"创建交互shell\"><a href=\"#创建交互shell\" class=\"headerlink\" title=\"创建交互shell\"></a>创建交互shell</h5><ul>\n<li><p>linux提权需要交互shell</p>\n</li>\n<li><p>使用工具perl-reverse-shell.pl建立sockets, 本地可以使用nc监听端口<code>nc -vvip 1234</code></p>\n</li>\n</ul>\n<h5 id=\"查看发行版\"><a href=\"#查看发行版\" class=\"headerlink\" title=\"查看发行版\"></a>查看发行版</h5><ul>\n<li><p><code>cat /etc/issue</code></p>\n</li>\n<li><p><code>cat /etc/*release</code></p>\n</li>\n<li><p>查看内核版本<code>uname -a</code></p>\n</li>\n</ul>\n<h5 id=\"查看可用的提权exp\"><a href=\"#查看可用的提权exp\" class=\"headerlink\" title=\"查看可用的提权exp\"></a>查看可用的提权exp</h5><ul>\n<li><a href=\"https://www.exploit-db.com/\">Exploit Database - Exploits for Penetration Testers, Researchers, and Ethical Hackers (exploit-db.com)</a></li>\n</ul>\n<h5 id=\"进行提取\"><a href=\"#进行提取\" class=\"headerlink\" title=\"进行提取\"></a>进行提取</h5><ul>\n<li><p>在目标机编译exp, 如果编译不成功在本地编译后上传到目标上<br><code>gcc exp.c -o exp</code></p>\n</li>\n<li><p>增加运行权限<br><code>chmod +x exp</code></p>\n</li>\n<li><p>运行exp</p>\n</li>\n<li><p>切换shell-&gt;<code>/bin/bash</code><br><code>python -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39;</code></p>\n</li>\n<li><p>查询当前用户id</p>\n</li>\n<li><p>查询机密文件如<code>/etc/shadow</code></p>\n</li>\n</ul>\n","text":"权限提升Web权限获取: 插件应用, 数据库, 中间件, 网站源码后台获取… 网站前台: REC漏洞, 代码执行, 命令执行, 写文件, 写shell 权限划分...","permalink":"/post/内网安全-权限提升","photos":[],"count_time":{"symbolsCount":"1.9k","symbolsTime":"2 mins."},"categories":[],"tags":[],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87\"><span class=\"toc-text\">权限提升</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E6%9D%83%E9%99%90%E5%88%92%E5%88%86\"><span class=\"toc-text\">权限划分</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%85%B7%E4%BD%93%E7%9A%84%E5%87%A0%E7%A7%8D%E6%9D%83%E9%99%90\"><span class=\"toc-text\">具体的几种权限</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Windows%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87\"><span class=\"toc-text\">Windows权限提升</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E\"><span class=\"toc-text\">溢出漏洞</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E6%93%8D%E4%BD%9C%E5%89%8D%E6%8F%90\"><span class=\"toc-text\">操作前提</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E6%88%90%E5%8A%9F%E6%9D%A1%E4%BB%B6\"><span class=\"toc-text\">成功条件</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E5%B8%B8%E8%A7%81%E6%AD%A5%E9%AA%A4\"><span class=\"toc-text\">常见步骤</span></a></li></ol></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E6%95%B0%E6%8D%AE%E5%BA%93\"><span class=\"toc-text\">数据库</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E7%AC%AC%E4%B8%89%E6%96%B9%E8%BD%AF%E4%BB%B6\"><span class=\"toc-text\">第三方软件</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Linux%E6%8F%90%E6%9D%83\"><span class=\"toc-text\">Linux提权</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E5%88%9B%E5%BB%BA%E4%BA%A4%E4%BA%92shell\"><span class=\"toc-text\">创建交互shell</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E6%9F%A5%E7%9C%8B%E5%8F%91%E8%A1%8C%E7%89%88\"><span class=\"toc-text\">查看发行版</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E6%9F%A5%E7%9C%8B%E5%8F%AF%E7%94%A8%E7%9A%84%E6%8F%90%E6%9D%83exp\"><span class=\"toc-text\">查看可用的提权exp</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E8%BF%9B%E8%A1%8C%E6%8F%90%E5%8F%96\"><span class=\"toc-text\">进行提取</span></a></li></ol></li></ol></li></ol></li></ol>","author":{"name":"Myprefer","slug":"blog-author","avatar":"https://gravatar.com/avatar/d195051819ce742212020a79d768fb6c?size=256&cache=1710768150791","link":"https://github.com/Myprefer","description":"web security learner, ML learner","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"WEB攻防-验证码安全","uid":"8fbdf9b50722304c5111df8cc62c19b8","slug":"WEB攻防-验证码安全","date":"2024-05-07T09:32:21.000Z","updated":"2024-05-07T14:24:11.405Z","comments":true,"path":"api/articles/WEB攻防-验证码安全.json","keywords":null,"cover":null,"text":"验证码安全找回密码客户端回显&Response状态值&修改重定向 用回显状态判断-res前端判断不安全 不安全方式: txt错误验证->服务器返回状态<3>->...","permalink":"/post/WEB攻防-验证码安全","photos":[],"count_time":{"symbolsCount":816,"symbolsTime":"1 mins."},"categories":[],"tags":[],"author":{"name":"Myprefer","slug":"blog-author","avatar":"https://gravatar.com/avatar/d195051819ce742212020a79d768fb6c?size=256&cache=1710768150791","link":"https://github.com/Myprefer","description":"web security learner, ML learner","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"内网安全-信息收集","uid":"1ebe60b010761b3b7defb8d55e9daafb","slug":"内网安全-信息收集","date":"2024-04-11T11:50:10.000Z","updated":"2024-06-01T01:49:20.145Z","comments":true,"path":"api/articles/内网安全-信息收集.json","keywords":null,"cover":[],"text":"内网信息收集一.收集本机信息判断是否有域 ipconfig /all 在Windows IP 配置项下 Systeminfo 在”域”词条下, 图中显示为WOR...","permalink":"/post/内网安全-信息收集","photos":[],"count_time":{"symbolsCount":"5.7k","symbolsTime":"5 mins."},"categories":[],"tags":[],"author":{"name":"Myprefer","slug":"blog-author","avatar":"https://gravatar.com/avatar/d195051819ce742212020a79d768fb6c?size=256&cache=1710768150791","link":"https://github.com/Myprefer","description":"web security learner, ML learner","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}